<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/images/icons/favicon-16x16.png?v=2.6.2" type="image/png" sizes="16x16"><link rel="icon" href="/images/icons/favicon-32x32.png?v=2.6.2" type="image/png" sizes="32x32"><meta property="og:type" content="website">
<meta property="og:title" content="MIRACLE">
<meta property="og:url" content="https://planeswalker1205.github.io/page/3/index.html">
<meta property="og:site_name" content="MIRACLE">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="ashen">
<meta name="twitter:card" content="summary"><title>MIRACLE</title><link ref="canonical" href="https://planeswalker1205.github.io/page/3/index.html"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=2.6.2"><script>var Stun = window.Stun || {};
var CONFIG = {
  root: '/',
  algolia: undefined,
  assistSearch: undefined,
  fontIcon: {"prompt":{"success":"fas fa-check-circle","info":"fas fa-arrow-circle-right","warning":"fas fa-exclamation-circle","error":"fas fa-times-circle"},"copyBtn":"fas fa-copy"},
  sidebar: {"offsetTop":"20px","tocMaxDepth":6},
  header: {"enable":true,"showOnPost":true,"scrollDownIcon":false},
  postWidget: {"endText":true},
  nightMode: {"enable":true},
  back2top: {"enable":true},
  codeblock: {"style":"default","highlight":"light","wordWrap":false},
  reward: false,
  fancybox: false,
  zoomImage: {"gapAside":"20px"},
  galleryWaterfall: undefined,
  lazyload: false,
  pjax: undefined,
  externalLink: {"icon":{"enable":true,"name":"fas fa-external-link-alt"}},
  shortcuts: undefined,
  prompt: {"copyButton":"Copy","copySuccess":"Copy Success","copyError":"Copy Error"},
  sourcePath: {"js":"js","css":"css","images":"images"},
};

window.CONFIG = CONFIG;</script><meta name="generator" content="Hexo 6.1.0"></head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner"><nav class="header-nav header-nav--fixed"><div class="header-nav-inner"><div class="header-nav-menubtn"><i class="fas fa-bars"></i></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__icon"><i class="fas fa-home"></i></span><span class="header-nav-menu-item__text">Home</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/archives/"><span class="header-nav-menu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-menu-item__text">Archives</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/categories/"><span class="header-nav-menu-item__icon"><i class="fas fa-layer-group"></i></span><span class="header-nav-menu-item__text">Categories</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/tags/"><span class="header-nav-menu-item__icon"><i class="fas fa-tags"></i></span><span class="header-nav-menu-item__text">Tags</span></a></div></div><div class="header-nav-mode"><div class="mode"><div class="mode-track"><span class="mode-track-moon"></span><span class="mode-track-sun"></span></div><div class="mode-thumb"></div></div></div></div></nav><div class="header-banner"><div class="header-banner-info"><div class="header-banner-info__title">MIRACLE</div><div class="header-banner-info__subtitle"></div></div></div></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content content-home" id="content"><section class="postlist"><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2021/03/19/02-css/">02-css</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2021-03-19</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">2022-05-21</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h2 id="1-继承">
          <a href="#1-继承" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-继承" class="headerlink" title="1. 继承"></a>1. 继承</h2>
      <p><strong>如果我们为一个元素设置了它的样式，此样式也会应用到它的后代元素–发生在祖先和后代元素之间</strong></p>
<p><strong><font color="green">优点：利用继承，我们可以把一些通用的样式统一设置到共同的祖先元素。这样只需设置一次即可让所有元素具有该样式</font></strong></p>
<p><strong><font color="red">注：并不是所有的样式都能被继承。比如：<font color="#0000FF">背景、布局</font>相关的等等都不会被继承,可在api文档查看。</font></strong></p>

        <h2 id="2-选择器的权重">
          <a href="#2-选择器的权重" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-选择器的权重" class="headerlink" title="2. 选择器的权重"></a>2. 选择器的权重</h2>
      <ol>
<li><p>样式的冲突：当我们通过不同的选择器，选中相同的元素，并且为相同的样式设置不同的值时，此时就发生了样式的冲突。</p>
</li>
<li><p>发生样式冲突时，应用哪个样式由选择器的**权重(优先级)**决定。</p>
</li>
</ol>
<p><strong>选择器的权重</strong></p>
<p><strong><font color="#A52A2A">内联&#x2F;行内样式&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; (1,0,0,0)</font></strong></p>
<p><strong><font color="#A52A2A">&gt;id选择器&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;  (0,1,0,0)</font></strong></p>
<p><strong><font color="#A52A2A">&gt;类和伪类选择器 (0,0,1,0)</font></strong></p>
<p><strong><font color="#A52A2A">&gt;元素选择器&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; (0,0,0,1)</font></strong></p>
<p><strong><font color="#A52A2A">&gt;通配选择器&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; (0,0,0,0)</font></strong></p>
<p><strong><font color="#A52A2A">&gt;继承的样式&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 无优先级</font></strong></p>
<p>比较优先级时，需要将所有的选择器的优先级进行相加计算，最后优先级越高，则越优先显示（分组选择器是单独计算的）。</p>
<p>比如：</p>
<figure class="highlight css"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;style&gt;</span><br><span class="line"><span class="selector-id">#box1</span>&#123;</span><br><span class="line">	//<span class="number">100</span></span><br><span class="line">	<span class="attribute">background-color</span>:orange;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">div</span><span class="selector-id">#box1</span>&#123;</span><br><span class="line">	//<span class="number">100</span>+<span class="number">1</span></span><br><span class="line">	<span class="attribute">background-color</span>:yellow;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.red</span>&#123;</span><br><span class="line">	//<span class="number">10</span></span><br><span class="line">	<span class="attribute">background-color</span>:red;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br><span class="line">&lt;<span class="selector-tag">div</span> id = &quot;box1&quot; class = &quot;red&quot;&gt;</span><br><span class="line">我是一个<span class="selector-tag">div</span></span><br><span class="line">&lt;<span class="selector-tag">div</span>&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p>则上述样式最优先的是<code>div#box1&#123;&#125;</code></p>
<p><em>分组选择器是单独计算的</em></p>
<figure class="highlight css"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="selector-tag">div</span>,<span class="selector-id">#box1</span>,<span class="selector-class">.red</span>&#123;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 *  div:1</span></span><br><span class="line"><span class="comment">	 *  #box1:100</span></span><br><span class="line"><span class="comment">	 *  .red:10</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="attribute">color</span>:brown;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p><strong><font color="red">选择器的累加不会超过它的最大数量级</font></strong></p>
<p><em>id及以下级别的选择器优先级再叠加也大不过内联样式</em></p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;style&gt;</span><br><span class="line">#box1&#123;</span><br><span class="line">	//100</span><br><span class="line">	background-color:orange;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">.d1.d2.d3.d4.d5.d6.d7.d8.d9.d10.d11&#123;</span><br><span class="line">	</span><br><span class="line">	background-color:red;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br><span class="line">&lt;div id = &quot;box1&quot; class = &quot;d1 d2 d3 d4 d5 d6 d7 d8 d9 d10 d11&quot;&gt;</span><br><span class="line">我是一个div</span><br><span class="line">&lt;div&gt;</span><br></pre></td></tr></table></div></figure>
<p><em>类似这种写法，样式的优先级最高的还是id选择器</em></p>
<p><strong>如果优先级计算后相同，那么优先使用靠下的样式</strong></p>
<blockquote>
<p>注：可以在某一个样式后面添加<strong>important</strong>，则此时样式会获得最高的优先级。甚至超过内联样式。**<font color="red">在开发中一定要慎用</font>**。</p>
</blockquote>
<figure class="highlight css"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.d1</span>&#123;</span><br><span class="line">	<span class="attribute">color</span>:red <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p><strong>a标签伪类优先级</strong></p>
<p>(1):link                   选择所有未访问链接   </p>
<p>(2):visited                选择所有访问过的链接</p>
<p>(3):hover                  选择鼠标在链接上面的链接  ( :hover 选择器器可用于所有元素，不仅是链接。)</p>
<p>(4):active                 选择活动链接 (鼠标点击与释放之间)</p>
<p>(注意: link 和 visited 的位置可颠倒,建议不这样做)</p>
<p><em>此优先级遵照“爱恨原则”  即“LoVeHAye”</em>。为什么要遵照这个优先级呢，如果顺序错乱，比如<code>:link</code>放在了最后一个，那么由CSS的就近原则，同一个标签(link里包含了hover和active的标签)后面的样式会覆盖掉前面的样式，则前面的<code>active``：hover</code>都会被覆盖从而不生效。</p>

        <h2 id="3-长度单位">
          <a href="#3-长度单位" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-长度单位" class="headerlink" title="3. 长度单位"></a>3. 长度单位</h2>
      <p><strong>01.像素：显示器实际上是有一个一个的小像素点构成。不同的屏幕像素大小是不同的，像素越小的屏幕显示的就越清晰。</strong></p>
<p><strong>02.百分比：可以将属性值设置为相对于其父元素的百分比</strong></p>
<p><strong>03.em：是相对于自身元素的字体大小来计算的。<font color="blue">1em &#x3D; 1font-size</font></strong></p>
<p><strong>04.rem：是相对于根元素(html)的字体大小来计算的</strong></p>
<p><em>em会根据字体的大小的改变而改变</em></p>

        <h2 id="4-RGB值">
          <a href="#4-RGB值" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-RGB值" class="headerlink" title="4.RGB值"></a>4.RGB值</h2>
      <p><strong>01.通过三种颜色的不同浓度来调配颜色。R:RED G:GREEN B:BLUE</strong></p>
<p>每一种颜色的范围在0<del>255(0</del>100%)之间</p>
<p>语法</p>
<p><code>rgb&#123;红色,绿色,蓝色&#125;</code></p>
<figure class="highlight css"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;style&gt;</span><br><span class="line"><span class="selector-tag">p</span>&#123;</span><br><span class="line">	<span class="attribute">background-color</span>:<span class="built_in">rgb</span>(<span class="number">255</span>,<span class="number">0</span>,<span class="number">0</span>);	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></div></figure>

<p><strong>02.REGA</strong></p>
<p>在rgb的基础上增加了a表示不透明度</p>
<p>A:Apacity  透明度</p>
<p>1表示完全不透明，.5表示半透明，0表示完全透明</p>
<p><code>rgb&#123;红色,绿色,蓝色,.5&#125;</code></p>
<p><strong>03.十六进制的rgb值</strong></p>
<p>-语法：#红色绿色蓝色</p>
<p>颜色浓度通过：00-ff表示</p>
<p><em>如果颜色一类的两位重复，可以简写</em></p>
<p>#aabbcc→#abc</p>
<p><strong>04.HSL值</strong></p>
<p>H:色相(0-360)</p>
<p>S:饱和度(0%-100%)</p>
<p>L:亮度(0%-100%)</p>

        <h2 id="5-文档流">
          <a href="#5-文档流" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-文档流" class="headerlink" title="5.文档流"></a>5.文档流</h2>
      <p>文档流(normal flow)</p>
<p>- &amp;nbsp; 网页是一个多层的结构</p>
<p>- &amp;nbsp; 通过css可以为每一层设置样式</p>
<p>- &amp;nbsp;这些层中，最底下的一层成为文档流，文档里是网页的基础。我们所创建的元素默认都是在文档流中进行排列。</p>
<p><strong>对于我们来说，元素主要有两个状态：在文档流中&amp;不在文档流中（脱离文档流）</strong></p>
<p><strong>1. 元素在文档流中的特点</strong></p>
<ul>
<li><p>块元素(block)</p>
<ul>
<li>在页面中独占一行</li>
<li>默认宽度是父元素的全部宽度。</li>
<li>默认高度是子元素所占的高度</li>
</ul>
</li>
<li><p>行内元素(inline)</p>
<ul>
<li>不会独占页面中的一行，只占自身的大小</li>
<li>行内元素在页面中自左向右水平排列。如果一行之中容纳不小所有的行内元素，则元素会换到第二行继续自左向右排列</li>
<li>行内元素的默认宽度和高度都是被内容撑开</li>
</ul>
</li>
</ul>

        <h2 id="6-盒子模型">
          <a href="#6-盒子模型" class="heading-link"><i class="fas fa-link"></i></a><a href="#6-盒子模型" class="headerlink" title="6.盒子模型"></a>6.盒子模型</h2>
      <p><strong>内容区(content)：</strong>元素中所有的子元素和文本内容都在内容去排列。内容区的大小由width和height两个属性来设置</p>
<p><strong>内边距(padding)</strong></p>
<p><strong>边框(border)：</strong>边框属于盒子的边缘</p>
<p><strong>外边距(margin)</strong></p>
<p><strong><font color="skyblue">类似于boder-width的属性：</font></strong></p>
<p><code>border-width:13px 10px 11px 15px;</code></p>
<ul>
<li>按照**上 <font color="red">右</font> 下 <font color="red">左</font>**的顺序为边框设置宽度</li>
</ul>
<p><code>border-width:13px 10px 15px</code></p>
<ul>
<li>按照<strong>上 <font color="red">左右</font> 下</strong>的顺序为边框设置宽度</li>
</ul>
<p><code>border-width:13px 15px</code></p>
<ul>
<li>按照**上下 <font color="red">左右</font>**的顺序为边框设置宽度</li>
</ul>

        <h3 id="01-内边距">
          <a href="#01-内边距" class="heading-link"><i class="fas fa-link"></i></a><a href="#01-内边距" class="headerlink" title="01. 内边距"></a>01. 内边距</h3>
      <p><strong>padding</strong></p>
<p>内容区和边框之间的距离是内边距。</p>
<p>- 一共有四个方向的内边距</p>
<ul>
<li><p>padding-top</p>
</li>
<li><p>padding-right</p>
</li>
<li><p>padding-bottom</p>
</li>
<li><p>padding-left</p>
</li>
</ul>
<p><strong>内边距的设置会影响到盒子的大小</strong></p>
<blockquote>
<p>一个盒子的可见框大小，由<strong>内容区 内边距 边框</strong>共同决定</p>
</blockquote>
<p>**<font size="5" color="red">So</font>**在计算盒子大小时，需要将这三个区域加到一起计算。</p>

        <h3 id="02-外边距">
          <a href="#02-外边距" class="heading-link"><i class="fas fa-link"></i></a><a href="#02-外边距" class="headerlink" title="02.外边距"></a>02.外边距</h3>
      <p><strong>margin</strong></p>
<p>- 一共有四个方向的外边距</p>
<ul>
<li>margin-top</li>
</ul>
<p>上外边距，设置一个正值，元素会向下移动</p>
<ul>
<li>margin-right</li>
</ul>
<p>默认情况下设置此属性不会有任何效果。因为没有做浮动的话，块状元素独占一行。两个元素做完左浮动，设置一个正值，其右边的元素会向右移动。</p>
<ul>
<li>margin-bottom</li>
</ul>
<p>下外边距，设置一个正值，其下边的元素会向下移动。</p>
<ul>
<li>margin-left</li>
</ul>
<p>左外边距，设置一个正值，元素会向右移动</p>
<p><strong>外边距不会影响盒子可见框的大小.但是外边距会影响盒子的位置！</strong></p>
<p>**<font size="5" color="red">由于</font>**元素在页面中是按照自左向右。自上向下排列。所以默认情况下如果我们设置的左和上外边距则会移动元素自身。而设置下和右外边距会移动其他元素</p>
<p><strong><font color="blue">一个元素在其父元素中，水平布局必须满足以下等式:</font></strong></p>
<p>margin-left+border-left+padding-left+width+padding-right+border-right+margin-right &#x3D; 其父元素内容区的宽度。</p>
<p>如果相加等式不成立，则成为过度约束，等式会自动调整。</p>
<p><strong><font size="6">调整的情况∨：</font></strong></p>
<blockquote>
<p>如果这七个值中没有为auto的情况，则浏览器会自动调整margin-right的值以使等式满足.如果宽度比父元素还要大，那么margin-right就会变成一个负值。</p>
</blockquote>
<blockquote>
<p>这七个值中有三个值可以设置为auto：width  margin-left  margin-right。如果某个值为auto，则会自动调整为auto的那个值以使等式成立。</p>
</blockquote>
<p><strong><font size="5" color="red">注</font>：width的值默认是auto;margin-left、margin-right默认值是0，</strong></p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line">.box1&#123;</span><br><span class="line">	border:2px solid black;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.box2&#123;</span><br><span class="line">	width:auto;</span><br><span class="line">	height:200px;</span><br><span class="line">	background-color:#bfa;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;div class = &quot;box1&quot;&gt;</span><br><span class="line">	&lt;div class = &quot;box2&quot;&gt;</span><br><span class="line">	&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></div></figure>
<p><em>那么此时浏览器会自动调整<font color="red">auto</font>的值为父元素内容区的宽度。</em></p>
<p><strong>I:如果将一个宽度和一个外边距设置为auto，则宽度会调整到最大</strong></p>
<p><strong>II:如果将三个值都设置到auto，则外边距都是0，宽度最大。</strong></p>
<p><strong>III:如果给两个外边距设置auto，宽度设置固定值，则会将auto设置为相同的值。</strong></p>
<p><strong><font size="6" color="skyblue">故我们经常利用第三个特点来使一个元素水平居中。</font></strong></p>

        <h3 id="03-垂直方向的布局">
          <a href="#03-垂直方向的布局" class="heading-link"><i class="fas fa-link"></i></a><a href="#03-垂直方向的布局" class="headerlink" title="03.垂直方向的布局"></a>03.垂直方向的布局</h3>
      <p><strong>1. 父元素的高度如果不写，就会被子元素撑开。写了的话就该是多少就是多少。</strong></p>
<p><strong>2. 如果子元素的大小超过了父元素，则子元素会从父元素中溢出。溢出的部分没有占据空间</strong></p>
<blockquote>
<p>可以使用overflow属性来设置父元素中溢出的子元素。**<font color="green">父元素中设置</font>**</p>
</blockquote>
<p><strong><font color="rgb(165, 42, 42)"> overflow可选值:</font></strong></p>
<p><code>visible</code>:默认值(子元素会从父元素溢出，从父元素的外部显示)</p>
<p><code>hidden</code>:隐藏。溢出的内容会被裁剪  不会显示</p>
<p><code>scroll</code>:生成两个滚动条。通过滚动条来查看完整的内容。</p>
<p><code>auto</code>：根据需要生成滚动条。需要哪个方向的才会有滚动条。</p>
<p><strong><font color="rgb(165, 42, 42)"> overflow-x:</font></strong></p>
<p>单独处理水平方向</p>
<p><strong><font color="rgb(165, 42, 42)"> overflow-y:</font></strong></p>
<p>单独处理垂直方向</p>

        <h3 id="04-外边距的折叠-垂直外边距的重叠">
          <a href="#04-外边距的折叠-垂直外边距的重叠" class="heading-link"><i class="fas fa-link"></i></a><a href="#04-外边距的折叠-垂直外边距的重叠" class="headerlink" title="04.外边距的折叠(垂直外边距的重叠)"></a>04.外边距的折叠(垂直外边距的重叠)</h3>
      <p><strong>相邻的垂直方向的外边距会发生重叠现象：</strong></p>
<p>两个条件</p>
<p><strong><font color="blue" size="4">1. 相邻的</font></strong></p>
<p><strong>所谓相邻指的是渲染之后的元素位置相邻，而不是dom结构上的相邻</strong></p>
<p><strong><font color="blue" size="4">2. 垂直方向的</font></strong></p>
<p>两种情况</p>
<p><strong><font color="blue" size="4">1. 兄弟元素</font></strong></p>
<blockquote>
<p>兄弟元素间的相邻垂直外边距会取两者之间的较大值(两者都是正值)</p>
</blockquote>
<blockquote>
<p>特殊情况：如果相邻的外边距一正一负，则取两者的和</p>
</blockquote>
<blockquote>
<p>如果相邻外边距都是负值，则取两者绝对值较大的。</p>
</blockquote>
<p><strong><font color="#greenb">兄弟元素之间的外边距重叠，对于开发是有利的，不需要进行处理。</font></strong></p>
<p><strong><font color="blue" size="4">2. 父子元素</font></strong></p>
<blockquote>
<p>父子元素之间的相邻外边距，子元素的会传递给父元素。(上外边距)</p>
</blockquote>
<p><strong>按照css规范，两个相邻的元素之间的margin值会共用较大的那一个，而如果没有上边框或上内间距，嵌套的元素之间和同级的元素一样满足使用这个规范的条件，父元素会拥有子元素一样的上外边距。</strong></p>
<p><strong><font color="#red">父子元素之间的外边距重叠会影响到页面的布局，需要进行处理。</font></strong></p>
<p>处理方案：</p>
<ul>
<li><p>为父元素设置边框</p>
</li>
<li><p>使父元素和子元素不相邻</p>
</li>
</ul>
<figure class="highlight css"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.father</span><span class="selector-pseudo">::before</span>&#123;</span><br><span class="line">	<span class="attribute">content</span>:<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">	<span class="attribute">display</span>:table;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<ul>
<li>使用padding属性不使用margin<font color="orange" size="4">OR</font>为父元素设置边框使它们父子两个的外边距不重合。</li>
</ul>

        <h3 id="05-行内元素的盒模型">
          <a href="#05-行内元素的盒模型" class="heading-link"><i class="fas fa-link"></i></a><a href="#05-行内元素的盒模型" class="headerlink" title="05.行内元素的盒模型"></a>05.行内元素的盒模型</h3>
      <p><strong><font color="#red">行内元素不支持设置宽度和高度</font></strong></p>
<p><strong><font color="#red">行内元素可以设置padding&#x2F;border&#x2F;margin  但是垂直方向padding&#x2F;border&#x2F;margin不会影响页面的布局</font></strong></p>
<p><em>display属性：</em></p>
<p>可选值：</p>
<p> <strong>inline：</strong>将元素设置为行内元素</p>
<p><strong>block：</strong>将元素设置为块元素</p>
<p><strong>inline-block：</strong>将元素设置为行内块元素。即既可以设置宽高，又不会独占一行</p>
<p><strong>table：</strong>将元素设置为一个表格</p>
<p><strong>none：</strong>元素不在页面中显示。也不占位置</p>
<p><em>visibility属性：</em></p>
<p>可选值：</p>
<p><strong>visible：</strong>默认值  显示</p>
<p><strong>hidden：</strong>隐藏，但是还占据页面位置</p>

        <h3 id="06-默认样式">
          <a href="#06-默认样式" class="heading-link"><i class="fas fa-link"></i></a><a href="#06-默认样式" class="headerlink" title="06.默认样式"></a>06.默认样式</h3>
      <p><strong>通常情况下，浏览器都会为元素设置一些默认样式。默认样式的存在会影响到页面的布局。</strong></p>
<p><strong>通常情况下填写网页时必须要去除浏览器的默认样式</strong></p>
<p><strong><font color="#fba">去除所有元素的默认样式</font></strong></p>
<ol>
<li>简单写法：</li>
</ol>
<figure class="highlight css"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">*&#123;</span><br><span class="line"></span><br><span class="line">	<span class="attribute">margin</span>:<span class="number">0</span>;</span><br><span class="line">	<span class="attribute">padding</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<blockquote>
<p>此方法会有一些元素的默认样式无法去除</p>
</blockquote>
<ol start="2">
<li>另一种写法是写一个共用的css表依次去除所有元素的默认样式，然后引入即可。</li>
</ol>

        <h3 id="07-box-sizing">
          <a href="#07-box-sizing" class="heading-link"><i class="fas fa-link"></i></a><a href="#07-box-sizing" class="headerlink" title="07.box-sizing"></a>07.box-sizing</h3>
      <p><strong><font color="green" size="4"><i>默认情况下，盒子的可见框大小有内容区，内边距和边框共同决定。</i></font></strong></p>
<p><strong>box-sizing属性：</strong>用来设置盒子尺寸的计算方式.(设置width和height的作用)</p>
<p>可选值：</p>
<p>content-box：默认值，宽度和高度用来设置内容区的大小</p>
<p>border-box：宽度和高度用来设置整个盒子的可见框大小。</p>
<p>简单来说：设置的height和width的属性：如果box-sizing的值为content-box，那么height和width的值只设置给content，不包括border和padding。如果box-sizing的值为border-box，那么height和weight的值包含了border和padding还有内容区</p>

        <h3 id="08-轮廓阴影和圆角">
          <a href="#08-轮廓阴影和圆角" class="heading-link"><i class="fas fa-link"></i></a><a href="#08-轮廓阴影和圆角" class="headerlink" title="08.轮廓阴影和圆角"></a>08.轮廓阴影和圆角</h3>
      <p><strong>1. outline</strong></p>
<p>用来设置元素的轮廓线。用法和border一样。</p>
<p>和边框的不同点是outline不会影响到可见框的大小和页面的布局。像是独立的一样。可用在鼠标移入后的样式。</p>
<p><strong>2. box-shadow</strong></p>
<p>设置元素的阴影效果，不会影响页面的布局</p>
<p>box-shadow:10px 20px 10px black;</p>
<ul>
<li><p>10px:阴影的水平偏移量(正右负左)</p>
</li>
<li><p>20px：阴影的垂直偏移量(正下负上)</p>
</li>
<li><p>10px：阴影的模糊半径。（值越大，模糊效果越大）</p>
</li>
<li><p>black：阴影的颜色</p>
</li>
</ul>
<div style="width:100px;height:100px;background-color:orange;box-shadow:10px 20px 10px rgba(0,0,0,.3);margin-bottom:30px;"></div>


<p><strong>2. border-radius</strong></p>
<p>设置不同方向上圆角的半径大小。</p>
<ul>
<li><p>border-top-left-radius:50px 100px;</p>
</li>
<li><p>border-top-right-radius:50px 100px;</p>
</li>
<li><p>border-bottom-left-radius:50px 100px;</p>
</li>
<li><p>border-bottom-right-radius:50px 100px;</p>
</li>
</ul>
<p>50px:水平方向半径</p>
<p>100px：垂直方向半径</p>
<p><strong>border-radius可分别指定四个值&#x2F;三个值&#x2F;二个值</strong></p>
<p>四个值：上左  上右  下右  下左</p>
<p>三个值：上左  上右&#x2F;下左  下右</p>
<p>二个值： 上左&#x2F;下右  上右&#x2F;下左</p>
<p><code>border-radius: 10px / 20px;</code> 代表四个角设置两个方向的圆的半径</p>
<p><strong>将元素设置为一个圆形。</strong></p>
<p><code>border-radius:50%;</code></p>
<div style="width:100px;height:100px;background-color:green;border-radius:50%;"></div>

<p><strong>语法格式</strong></p>
<p><code>border-radius：[ &lt;length&gt; | &lt;percentage&gt; ]&#123;1,4&#125; [ / [ &lt;length&gt; | &lt;percentage&gt; ]&#123;1,4&#125; ]?</code></p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">语法说明如下：</span><br><span class="line"></span><br><span class="line">border-radius 属性可以接收两组参数，参数之间使用斜杠/进行分隔，每组参数都允许设置 1~4 个参数值，其中第一组参数代表圆角水平方向上</span><br><span class="line">的半径或半轴，第二组参数代表圆角垂直方向上的半径或半轴，如果省略第二组参数的值，那么该组参数将直接沿用第一组参数的值。</span><br><span class="line"></span><br><span class="line">第一组参数中，如果提供全部的四个参数，那么将按照上左 top-left、上右 top-right、下右 bottom-right、下左 bottom-left 的顺序作用于</span><br><span class="line">元素的四个角；如果提供三个参数，那么第一个参数将作用于元素的左上角 top-left，第二个参数将作用于元素的右上角 top-right 和左下角 </span><br><span class="line">bottom-left，第三个参数将作用于元素的右下角 bottom-right；如果提供两个参数，那么第一个参数将作用于元素的左上角 top-left 和右下</span><br><span class="line">角 bottom-right，第二个参数将作用于元素的右上角 top-right 和左下角 bottom-left；如果只提供一个参数，那么该参数将同时作用于元素</span><br><span class="line">的四个角。</span><br><span class="line"></span><br><span class="line">第二组参数同样遵循第一组参数的规律，只是作用的方向不同。</span><br></pre></td></tr></table></div></figure>
<p><img src="/2021/03/19/02-css/1522091456-0.gif"></p>
<p><img src="/2021/03/19/02-css/15220922R-2.gif" alt="总结"></p>

        <h2 id="6-浮动">
          <a href="#6-浮动" class="heading-link"><i class="fas fa-link"></i></a><a href="#6-浮动" class="headerlink" title="6.浮动"></a>6.浮动</h2>
      <p>使用float属性来设置元素的浮动。</p>
<p><strong>三个可选值：</strong></p>
<blockquote>
<ul>
<li></li>
</ul>
</blockquote>
<p>none：默认值  没有浮动</p>
<p>left：左浮动</p>
<p>right：右浮动</p>
<p><em>元素设置浮动以后，水平布局的等式不需要强制成立</em></p>
<p><strong>浮动feature：</strong></p>
<p><strong><font color="red" size="3">* 元素设置浮动以后，会完全从文档流中脱离。不再占用文档流的位置，所以元素下方的还在文档流中的元素会自动向上移动</font></strong></p>
<p><strong><font color="red" size="3">* 设置浮动以后，元素会向父元素的左侧或右侧浮动</font></strong></p>
<p><strong><font color="red" size="3">* 浮动元素默认不会从父元素中移出</font></strong></p>
<p><strong><font color="red" size="3">* 浮动元素向左或向右浮动时，不会超过它前边的其他浮动元素</font></strong></p>
<p><strong><font color="red" size="3">* 如果浮动元素的上一个块元素没有浮动，则浮动元素无法上移</font></strong></p>
<p><strong><font color="red" size="3">* 浮动元素与它上一个兄弟浮动元素上外边距并齐</font></strong></p>
<p>对于**<font color="red" size="3">* 浮动元素向左或向右浮动时，不会超过它前边的其他浮动元素</font>**的理解示例：</p>
<p>如：有一些高度不一的浮动元素：</p>
<p><img src="/2021/03/19/02-css/capture_20220204001643809.bmp"></p>
<p>当后面的3个元素换行后，会被前面较高的元素卡住(因为是left，元素从右往左浮)，即不会超过它前边的其他浮动</p>
<p><img src="/2021/03/19/02-css/capture_20220204001936819.bmp"></p>

        <h3 id="01-浮动的特点">
          <a href="#01-浮动的特点" class="heading-link"><i class="fas fa-link"></i></a><a href="#01-浮动的特点" class="headerlink" title="01. 浮动的特点"></a>01. 浮动的特点</h3>
      <ol>
<li><p>浮动元素不会盖住文字，文字会自动环绕在浮动元素周围。所以我们可以利用浮动来设置文字环绕图片效果。（但是文字所在的元素是会盖住的。只是不会盖住文字）</p>
</li>
<li><p>元素设置浮动以后，将会从文档流中脱离，从文档流中脱离后，元素的一些特点也会发生变化</p>
<p> <strong>脱离文档流(不是浮动独有)的特点：</strong></p>
<p> <strong><font color="green">对于块元素：</font></strong></p>
<ul>
<li><p>a:块元素不再独占页面的一行</p>
</li>
<li><p>b:块元素的宽度和高度默认都被内容撑开</p>
</li>
</ul>
<p> <strong><font color="green">对于行内元素：</font></strong></p>
<ul>
<li>a:行内元素脱离文档流以后会变成块元素，特点和上面块元素一样。</li>
</ul>
<p>即 <strong>脱离文档流以后 ，不需要再区分行内元素和块元素了</strong></p>
</li>
</ol>

        <h3 id="02-高度塌陷和BFC">
          <a href="#02-高度塌陷和BFC" class="heading-link"><i class="fas fa-link"></i></a><a href="#02-高度塌陷和BFC" class="headerlink" title="02. 高度塌陷和BFC"></a>02. 高度塌陷和BFC</h3>
      <p><strong>在浮动布局中，父元素的高度默认是被子元素撑开的。当子元素浮动以后，其会完全脱离文档流，子元素从文档流中脱离将会无法撑起父元素的高度，导致父元素的高度丢失。父元素的高度丢失以后，其下的元素就会上移，导致页面布局混乱。</strong></p>
<p>所以高度塌陷是浮动布局中比较常见的一种问题，必须要处理。</p>
<p><strong>BFC(Block Formatting Context)块级格式化环境</strong>：</p>
<blockquote>
<p>BFC是css中的一个隐含的属性，可以为一个元素开启BFC，开启BFC以后，该元素会变成一个独立的布局区域</p>
</blockquote>
<p><strong><font color="blue">元素开启BFC的特点： </font></strong></p>
<ul>
<li><p><strong>开启BFC的元素不会被浮动元素所覆盖</strong></p>
</li>
<li><p><strong>开启BFC的元素子元素和父元素的外边距不会重叠</strong></p>
</li>
<li><p><strong>开启BFC的元素可以包含浮动的子元素</strong></p>
</li>
<li><p><strong>开启BFC的元素浮动的子元素也参与高度计算</strong></p>
</li>
</ul>
<p><strong><font color="blue">可以通过一些特殊的方式来开启元素的BFC： </font></strong></p>
<ul>
<li><p><strong>设置元素的浮动(不推荐)</strong></p>
<p>  比如为父元素设置浮动，那么父元素就不会因为子元素浮动而塌陷</p>
</li>
<li><p><strong>将元素的display设置为inline-block, table-cell, table-caption, flex, inline-flex(不推荐)</strong></p>
<p>  display：inline-block</p>
</li>
<li><p><strong>将元素的overflow设置为一个非visible的值</strong></p>
<p>  常用方式， 为元素设置overflow hidden开启BFC  以使其可以包含浮动元素</p>
</li>
<li><p><strong>HTML标签</strong></p>
</li>
<li><p><strong>position为absolute或fixed</strong></p>

        <h3 id="03-clear">
          <a href="#03-clear" class="heading-link"><i class="fas fa-link"></i></a><a href="#03-clear" class="headerlink" title="03. clear"></a>03. clear</h3>
      </li>
</ul>
<p><strong>如果我们不希望某个元素因为其他元素浮动的影响而改变位置，可以通过clear属性来清除浮动元素对当前元素所产生的影响。</strong></p>
<p>clear 属性指定哪些元素可以浮动于被清除元素的旁边以及哪一侧。</p>
<p><strong><font color="green">★ 对于非浮动元素的使用：</font></strong></p>
<p><code>当应用于非浮动块时，它将非浮动块的边框边界移动到所有相关浮动元素外边界的下方。这个非浮动块设置的垂直外边距会折叠。</code></p>
<p><strong><font color="orange">clear： </font></strong></p>
<p>left：清除左侧浮动元素对当前元素的影响(左侧不允许有浮动元素)</p>
<p>right：清除右侧浮动元素对当前元素的影响(右侧不允许有浮动元素)</p>
<p>both：清除两侧中最大影响的那侧(两边不允许有浮动元素)</p>
<p><strong><font color="red">某一侧不允许有浮动元素都是相比较于HTML上该元素之前的元素，后面的元素按照对应规则排列</font></strong></p>
<blockquote>
<p>原理：设置清除浮动以后，浏览器会自动为元素添加一个上<br>外边距，以使其位置不受其他元素的影响</p>
</blockquote>
<p><strong><font color="green">★ 对于浮动元素的使用：</font></strong></p>
<p><code>当应用于浮动元素时，它将元素的外边界移动到所有相关的浮动元素外边框边界的下方。这会影响后面浮动元素的布局，后面的浮动元素的位置无法高于它之前的元素。即与当前清除浮动的浮动元素并齐</code></p>
<figure class="highlight html"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">section</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border</span>: <span class="number">1px</span> solid black;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        </span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.a</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">float</span>: left;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">background-color</span>: red;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        </span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.c</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">float</span>: right;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">background-color</span>: green;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">clear</span>: right;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        </span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.b</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">float</span>: right;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">background-color</span>: yellow;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">       </span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.d</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">float</span>: left;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">background-color</span>: orange;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">clear</span>: right;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">section</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;a&quot;</span>&gt;</span>1<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;b&quot;</span>&gt;</span>2<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;c&quot;</span>&gt;</span>3<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;d&quot;</span>&gt;</span>4<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">section</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></div></figure>

<p><img src="/2021/03/19/02-css/capture_20220103211119029.bmp"></p>

        <h3 id="04-使用after伪类解决高度塌陷">
          <a href="#04-使用after伪类解决高度塌陷" class="heading-link"><i class="fas fa-link"></i></a><a href="#04-使用after伪类解决高度塌陷" class="headerlink" title="04. 使用after伪类解决高度塌陷"></a>04. 使用after伪类解决高度塌陷</h3>
      <p>根据clear清除浮动的特性(设置清除浮动以后，浏览器会自动为元素添加一个上外边距，以使其位置不受其他元素的影响),我们可以为浮动元素的after伪类设置clear属性清除浮动，从而达到不使父元素因子元素的浮动而导致塌陷。</p>
<p><strong>即：浮动元素box1：</strong></p>
<figure class="highlight css"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box1</span><span class="selector-pseudo">::after</span>&#123;</span><br><span class="line">	<span class="attribute">content</span>:<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">	<span class="attribute">display</span>:block;</span><br><span class="line">	<span class="attribute">clear</span>:both;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<blockquote>
<p>原理是在父元素中的最后一个子元素做出clear清除浮动的操作。底层执行最后一个元素的<code>margin-top：父元素的高度</code>。外边距相关问题折叠应该已经处理了。</p>
</blockquote>
<p><strong><font color="#8B0000" size="5">综上：解决外边距重叠+高度塌陷</font></strong></p>
<figure class="highlight css"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.clearfix</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-class">.clearfix</span><span class="selector-pseudo">::after</span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="attribute">content</span>:<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">	<span class="attribute">display</span>:table;//解决垂直方向外边距重叠。即在父元素和第一个子元素之间加了一个元素，使之不符合外边距重叠的条件。使用此属性不会有多余的高度</span><br><span class="line">	<span class="attribute">clear</span>:both;//解决高度塌陷。即清除最后一个子元素的浮动。</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h2 id="7-导航条练习">
          <a href="#7-导航条练习" class="heading-link"><i class="fas fa-link"></i></a><a href="#7-导航条练习" class="headerlink" title="7.导航条练习"></a>7.导航条练习</h2>
      <p><strong>1. line-height：将文字在父元素垂直居中，同时将该块元素的高度撑开与行高一致</strong></p>
<blockquote>
<p>设置行高属性，即设置该元素内文本行的高度，文本会上下居中于总行高。如果行高与该元素高度相同，那么文字会垂直居中于该元素内（前提是该元素的高度比文本字号高度要高。</p>
</blockquote>
<p>如下案例：</p>
<figure class="highlight html"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">       <span class="selector-class">.a</span>&#123;</span></span><br><span class="line"><span class="language-css">          <span class="attribute">height</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">          <span class="attribute">width</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">          <span class="attribute">line-height</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">       &#125;</span></span><br><span class="line"><span class="language-css">       <span class="selector-class">.c</span>&#123;</span></span><br><span class="line"><span class="language-css">         <span class="attribute">line-height</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">       &#125;</span></span><br><span class="line"><span class="language-css">     </span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"> <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;a&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;b&quot;</span>&gt;</span></span><br><span class="line">              </span><br><span class="line">               <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span> = <span class="string">&quot;javascript:;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;c&quot;</span>&gt;</span>ddddddddddddddddd<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">               </span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></div></figure>

<p>那么此时文本ddd…的行高将会为100px，但是a标签作为一个行内标签，其高度只会随着文本的大小而改变，故此时可以把a标签设置为块元素，那么行高将会撑开a标签的高度，能点击到超链接的范围也就加大了。</p>
<p><strong>2. padding：此标签会撑开自身的可视大小，如果父元素设置了固定的宽高，padding的大小大于父元素的宽高，那么子块就可能会跑出父元素</strong></p>
<p><strong><font color="red" size="4">由于文本会环绕在浮动元素，所以如果某元素在浮动元素周围，那么这个元素的文本的位置可能会有些奇怪。</font></strong></p>
<p><img src="/2021/03/19/02-css/QQ%E6%88%AA%E5%9B%BE20210419003559.png"></p>
<p><img src="/2021/03/19/02-css/QQ%E6%88%AA%E5%9B%BE20210419003516.png"></p>

        <h2 id="img标签添加object-fit属性来改变图片如何覆盖">
          <a href="#img标签添加object-fit属性来改变图片如何覆盖" class="heading-link"><i class="fas fa-link"></i></a><a href="#img标签添加object-fit属性来改变图片如何覆盖" class="headerlink" title="img标签添加object-fit属性来改变图片如何覆盖"></a>img标签添加object-fit属性来改变图片如何覆盖</h2>
      </div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2021/03/01/01-css/">01_css</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2021-03-01</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">2022-05-21</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h1 id="1-简介">
          <a href="#1-简介" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-简介" class="headerlink" title="1. 简介"></a>1. 简介</h1>
      <p>css：层叠样式表：网页上其实是一个多层的结构。通过css可以为网页的每一层设置样式。而最终，我们只能看到的网页的最上边一层。</p>
<p>使用css来修改元素的样式：</p>

        <h2 id="01-内联样式-x2F-行内样式">
          <a href="#01-内联样式-x2F-行内样式" class="heading-link"><i class="fas fa-link"></i></a><a href="#01-内联样式-x2F-行内样式" class="headerlink" title="01_内联样式&#x2F;行内样式"></a>01_内联样式&#x2F;行内样式</h2>
      <p><code>&lt;a style = &quot;color:red; font-size:13px;&quot;&gt;红色&lt;/a&gt;</code></p>
<p>缺点:不好维护<br>注意:开发时绝对不要使用样式</p>

        <h2 id="02-style标签-内部样式表">
          <a href="#02-style标签-内部样式表" class="heading-link"><i class="fas fa-link"></i></a><a href="#02-style标签-内部样式表" class="headerlink" title="02_style标签-内部样式表"></a>02_style标签-内部样式表</h2>
      <figure class="highlight css"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;head&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">p</span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="attribute">color</span>:green;</span><br><span class="line"><span class="attribute">font-size</span>:<span class="number">50px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p><strong>简介:将样式编写到head的style标签里，然后通过css的选择器来选中元素并为其设置各种格式，可以同时为多个标签设置样式。</strong></p>
<p>内部样式表更加方便对样式进行复用。</p>
<p>缺点:只能对一个网页起作用。不能跨页面复用。</p>

        <h2 id="03-外部样式表">
          <a href="#03-外部样式表" class="heading-link"><i class="fas fa-link"></i></a><a href="#03-外部样式表" class="headerlink" title="03_外部样式表"></a>03_外部样式表</h2>
      <p>编写到外部的css文件中。然后通过link标签引入外部样式表。</p>
<p><strong>开发时使用</strong></p>
<p>将样式编写到外部css样式表，可以使用到浏览器的缓存机制。从而加快网页的加载速度，提高用户体验。</p>

        <h1 id="2-选择器">
          <a href="#2-选择器" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-选择器" class="headerlink" title="2. 选择器"></a>2. 选择器</h1>
      
        <h2 id="01-常用选择器">
          <a href="#01-常用选择器" class="heading-link"><i class="fas fa-link"></i></a><a href="#01-常用选择器" class="headerlink" title="01_常用选择器"></a>01_常用选择器</h2>
      <p><strong>1. 元素选择器</strong></p>
<figure class="highlight css"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;style&gt;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">p</span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="attribute">color</span>:red;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></div></figure>


<p><strong>2. ID选择器</strong></p>
<p>作用:根据元素的ID属性选择一个元素。</p>
<p><strong>ID不能重复</strong></p>
<figure class="highlight css"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;style&gt;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#idx1</span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="attribute">color</span>:red;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p><strong>3. 类选择器</strong></p>
<p>class：是一个标签的属性，和id类似，不过可以重复使用。</p>
<p>可以通过class对元素分组。</p>
<figure class="highlight css"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.cls1</span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="attribute">color</span>:blue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


<p><strong>可以同时为一个元素指定多个class值。</strong></p>
<figure class="highlight html"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;blue abc&quot;</span>&gt;</span>测试<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></div></figure>

<p>即既可以通过blue选中a标签，也可以通过abc选中标签。多个class值使用空格隔开。</p>
<p><strong>4. 通配选择器</strong></p>
<p>选中页面的所有元素。</p>
<figure class="highlight css"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">*&#123;</span><br><span class="line"></span><br><span class="line"><span class="attribute">color</span>:red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h2 id="02-复合选择器">
          <a href="#02-复合选择器" class="heading-link"><i class="fas fa-link"></i></a><a href="#02-复合选择器" class="headerlink" title="02_复合选择器"></a>02_复合选择器</h2>
      <p><strong>1.交集选择器（同时满足）</strong></p>
<p>如:</p>
<figure class="highlight html"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span> = <span class="string">&quot;red&quot;</span>&gt;</span>我是div<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span> = <span class="string">&quot;red&quot;</span>&gt;</span>我是p<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></div></figure>

<p>需求:将class值为red的div元素字体设置为30px。</p>
<p>作用:选择同时符合多个条件的元素。</p>
<p>语法：</p>
<figure class="highlight css"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">选择器<span class="number">1</span>选择器<span class="number">2</span>选择器<span class="number">3</span>选择器n&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<figure class="highlight css"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.red</span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="attribute">font-size</span>:<span class="number">30px</span>;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></div></figure>

<p><strong>注意:如果交集选择器中有元素选择器，必须元素选择器开头。因为元素选择器没有前缀，放后面不好区分。</strong></p>
<p>也可以：</p>
<figure class="highlight css"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line"><span class="selector-class">.a</span><span class="selector-class">.b</span><span class="selector-class">.c</span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="attribute">font-size</span>:<span class="number">30px</span>;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></div></figure>

<p><strong>2.并集选择器&#x2F;选择器分组</strong></p>
<figure class="highlight html"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>标题<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span>行内测试<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></div></figure>

<p>作用：同时选择多个选择器对应的元素。<br>语法:</p>
<figure class="highlight css"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span>,<span class="selector-tag">h1</span>,<span class="selector-class">.cls1</span>,<span class="selector-id">#n</span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<figure class="highlight css"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">h1</span>,<span class="selector-tag">span</span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="attribute">color</span>:red;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></div></figure>


        <h2 id="03-关系选择器">
          <a href="#03-关系选择器" class="heading-link"><i class="fas fa-link"></i></a><a href="#03-关系选择器" class="headerlink" title="03_关系选择器"></a>03_关系选择器</h2>
      <p><strong>父元素：直接包含子元素的元素叫做父元素</strong></p>
<p><strong>子元素:直接被父元素包含的元素是子元素</strong></p>
<p><strong>祖先元素：直接或间接包含后代元素的元素叫做祖先元素。（一个元素的父元素也叫它的祖先元素）</strong></p>
<p><strong>后代元素：直接或间接被祖先元素包含的元素叫做后代元素。（子元素也是后代元素）</strong></p>
<p><strong>兄弟元素：拥有相同父元素的是兄弟元素。</strong></p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line">我是div</span><br><span class="line">&lt;p&gt;我是div中的p</span><br><span class="line">&lt;span&gt;我是p中的span&lt;/span&gt;</span><br><span class="line">&lt;/P&gt;</span><br><span class="line">&lt;span&gt;我是div中的span&lt;/span&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></div></figure>

<p><strong>1. 子元素选择器</strong></p>
<figure class="highlight css"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span> &gt; <span class="selector-tag">p</span> &gt; <span class="selector-tag">span</span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="attribute">color</span>:orange;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


<figure class="highlight css"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span> &gt; <span class="selector-tag">span</span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="attribute">color</span>:orange;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p><strong>2. 后代元素选择器</strong></p>
<p>作用:选择指定元素内的所有指定后代元素。</p>
<figure class="highlight css"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">祖先 后代&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">div</span> <span class="selector-tag">span</span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="attribute">color</span>:skyblue;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p>div内所有的span都会被选中</p>
<p><strong>3. 兄弟元素选择器</strong></p>
<p><strong><font color="skyblue">选择下一个兄弟</font></strong></p>
<p>语法:</p>
<figure class="highlight css"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">前一个 + 后一个</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">p</span> + <span class="selector-tag">span</span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>选择p标签<strong>紧挨着的</strong>span元素</p>
<p><strong>如果没有紧挨着也不会选中</strong></p>
<p><strong><font color="skyblue">选择下面所有兄弟</font></strong></p>
<p>语法:</p>
<figure class="highlight css"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">兄 ~ 弟&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">p</span> ~ <span class="selector-tag">span</span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p>即p标签后所有的span元素。</p>

        <h2 id="04-属性选择器">
          <a href="#04-属性选择器" class="heading-link"><i class="fas fa-link"></i></a><a href="#04-属性选择器" class="headerlink" title="04_属性选择器"></a>04_属性选择器</h2>
      <p><strong>1. 选择含有指定属性的元素</strong></p>
<p>语法：</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">div[属性]&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


<figure class="highlight html"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">title</span> = <span class="string">&quot;a&quot;</span>&gt;</span>aaa<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">title</span> = <span class="string">&quot;b&quot;</span>&gt;</span>bbb<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">title</span> = <span class="string">&quot;c&quot;</span>&gt;</span>ccc<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>ddd<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<figure class="highlight css"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span><span class="selector-attr">[title]</span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="attribute">color</span>:red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p><strong>2. 选择含有指定属性和指定属性值的元素</strong></p>
<p>语法：</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[属性名=属性值]</span><br></pre></td></tr></table></div></figure>
<p><strong><font color="skyblue">选择属性值以指定值开头的元素</font></strong></p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[属性名^=属性值]</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p><strong><font color="skyblue">选择属性值以指定值结尾的元素</font></strong></p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[属性名$=属性值]</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p><strong><font color="skyblue">选择属性值含有某值的元素</font></strong></p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[属性名*=属性值]</span><br></pre></td></tr></table></div></figure>

<figure class="highlight css"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span><span class="selector-attr">[title=a]</span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="attribute">color</span>:orange;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>



        <h2 id="05-伪类选择器">
          <a href="#05-伪类选择器" class="heading-link"><i class="fas fa-link"></i></a><a href="#05-伪类选择器" class="headerlink" title="05_伪类选择器"></a>05_伪类选择器</h2>
      
        <h3 id="1-不存在的类-x2F-特殊的类">
          <a href="#1-不存在的类-x2F-特殊的类" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-不存在的类-x2F-特殊的类" class="headerlink" title="1. 不存在的类&#x2F;特殊的类"></a>1. 不存在的类&#x2F;特殊的类</h3>
      <p>用来描述一个元素的特殊状态。如：第一个子元素、被点击的元素、鼠标移入的元素、</p>
<p><strong>伪类一般情况下都是使用  <font color="orange">:</font>  开头</strong></p>
<figure class="highlight html"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">li</span>&gt;</span>a<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">li</span>&gt;</span>b<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">li</span>&gt;</span>c<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">li</span>&gt;</span>d<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">li</span>&gt;</span>e<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></div></figure>

<p><strong><font color="red">父元素下的第一个子元素且标签为li</font></strong></p>
<figure class="highlight css"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">ul</span> &gt; <span class="selector-tag">li</span><span class="selector-pseudo">:first</span>-child&#123;</span><br><span class="line"></span><br><span class="line">	<span class="attribute">color</span>:red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p><strong><font color="red">父元素下的最后一个子元素且标签为li</font></strong></p>
<figure class="highlight css"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">ul</span> &gt; <span class="selector-tag">li</span><span class="selector-pseudo">:last-child</span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="attribute">color</span>:red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p><strong><font color="red">父元素下的第n子元素且标签为li</font></strong></p>
<figure class="highlight css"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//选择第二个</span><br><span class="line"><span class="selector-tag">ul</span> &gt; <span class="selector-tag">li</span><span class="selector-pseudo">:nth-child</span>(<span class="number">2</span>)&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="attribute">color</span>:red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>如果第一个子元素为span则不满足，不会发生变化。即既要满足li标签，又要满足为第n个子元素。</p>
<p><strong><font color="Chocolate">以上这些伪类都是根据所有的子元素进行排序。</font></strong></p>
<p><strong><font color="blue">父元素下标签为li的第一个子元素</font></strong></p>
<figure class="highlight css"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">ul</span> &gt; <span class="selector-tag">li</span><span class="selector-pseudo">:first</span>-of-type&#123;</span><br><span class="line"></span><br><span class="line">	<span class="attribute">color</span>:red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p><strong><font color="blue">父元素下标签为li的最后一个子元素</font></strong></p>
<figure class="highlight css"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">ul</span> &gt; <span class="selector-tag">li</span><span class="selector-pseudo">:last-of-type</span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="attribute">color</span>:red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p><strong><font color="blue">父元素下标签为li的第n个子元素</font></strong></p>
<figure class="highlight css"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//第二个</span><br><span class="line"><span class="selector-tag">ul</span> &gt; <span class="selector-tag">li</span><span class="selector-pseudo">:nth-of-type</span>(<span class="number">2</span>)&#123;</span><br><span class="line"></span><br><span class="line">	<span class="attribute">color</span>:red;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p><strong><font color="DarkCyan">以上这些伪类都是根据子元素的类型进行排序。</font></strong></p>

        <h3 id="2-否定伪类">
          <a href="#2-否定伪类" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-否定伪类" class="headerlink" title="2. 否定伪类"></a>2. 否定伪类</h3>
      <figure class="highlight css"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-pseudo">:not</span>()</span><br></pre></td></tr></table></div></figure>

<p>将符合条件的元素从选择器中去除。</p>
<p>选择ul下的所有li除了第三个</p>
<figure class="highlight css"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">ul</span> &gt; <span class="selector-tag">li</span><span class="selector-pseudo">:not</span>(<span class="selector-pseudo">:nth-of-type</span>(<span class="number">3</span>))&#123;</span><br><span class="line"><span class="attribute">color</span>:red;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>



        <h3 id="2-超链接的伪类">
          <a href="#2-超链接的伪类" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-超链接的伪类" class="headerlink" title="2. 超链接的伪类"></a>2. 超链接的伪类</h3>
      <p><strong>:link  表示正常的链接(访问每访问的链接都叫正常链接)</strong></p>
<p><strong>:visited  表示访问过的链接。隐私问题此伪类只能改变颜色。用的较少</strong></p>
<p><strong>:hover  表示鼠标移入的样式</strong></p>
<p><strong>:active  表示鼠标点击的样式</strong></p>
<figure class="highlight css"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">a</span><span class="selector-pseudo">:link</span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="attribute">color</span>:red;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">a</span><span class="selector-pseudo">:visited</span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="attribute">color</span>:blue;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>



        <h2 id="06-伪元素选择器">
          <a href="#06-伪元素选择器" class="heading-link"><i class="fas fa-link"></i></a><a href="#06-伪元素选择器" class="headerlink" title="06_伪元素选择器"></a>06_伪元素选择器</h2>
      <p>表示页面中一些特殊的并不真实存在的元素。（特殊的位置）</p>
<p>语法：</p>
<p><strong>::first-letter</strong>:表示第一个字母</p>
<p><strong>::first-line</strong>:表示第一行</p>
<p><strong>::selection</strong>:表示选中的元素</p>
<p><strong>::before</strong>:元素的开始位置（必须结合content属性使用）</p>
<p><strong>::after</strong>:元素的最后位置（必须结合content属性使用）</p>
<figure class="highlight css"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span><span class="selector-pseudo">::first-letter</span>&#123;</span><br><span class="line">	//表示<span class="selector-tag">P</span>标签的第一个字母设置大小为<span class="number">20px</span></span><br><span class="line">	<span class="attribute">font-size</span>:<span class="number">20px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2021/01/03/01-html/">01_html</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2021-01-03</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">2022-05-21</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h1 id="1-标签">
          <a href="#1-标签" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-标签" class="headerlink" title="1_标签"></a>1_标签</h1>
      
        <h2 id="01-meta标签">
          <a href="#01-meta标签" class="heading-link"><i class="fas fa-link"></i></a><a href="#01-meta标签" class="headerlink" title="01_meta标签"></a>01_meta标签</h2>
      <ol>
<li><p>charset:指定网页的字符集</p>
</li>
<li><p>name:指定的数据名称</p>
</li>
<li><p>content:指定的数据的内容</p>
</li>
</ol>
<blockquote>
<p>meta主要用于设置网页中的一些元数据，元数据不是给用户看</p>
</blockquote>
<p><code>&lt;meta name = &quot;keywords&quot; content=&quot;HTML5,前端,CSS3&quot;&gt;</code></p>
<p><strong>keywords:表示网站的关键字，可以同时指定多个关键字，关键字之间使用,隔开。</strong></p>
<p><code>&lt;meta name = &quot;description&quot; content = &quot;这是一个非常不错的网站&quot;&gt;</code></p>
<p><strong>description:用于指定网站的描述</strong></p>
<p><strong>显示在搜索引擎的搜索结果中</strong></p>
<p><code>&lt;title&gt;标题内容&lt;/title&gt;</code></p>
<p><strong>title标签的内容会作为搜索结果的超链接上的名字显示</strong></p>
<p><code>&lt;meta http-equiv=&quot;refresh&quot; content = &quot;3;url=https://www.baidu.com&quot;&gt;</code></p>
<p><strong>将页面重定向到另一个网站。比如3秒后跳转到百度页面。</strong></p>

        <h2 id="02-h1标签">
          <a href="#02-h1标签" class="heading-link"><i class="fas fa-link"></i></a><a href="#02-h1标签" class="headerlink" title="02_h1标签"></a>02_h1标签</h2>
      <p><strong>网页中通常只存在一个。重要等级仅次于title标签</strong></p>
<p>重要等径：h1&gt;h2?h3&gt;h4&gt;h5&gt;h6</p>
<blockquote>
<p>一般情况下标题标签只使用h1<del>h3。h4</del>h6很少用。</p>
</blockquote>

        <h2 id="03-p标签">
          <a href="#03-p标签" class="heading-link"><i class="fas fa-link"></i></a><a href="#03-p标签" class="headerlink" title="03_p标签"></a>03_p标签</h2>
      <p><strong>表示页面中的一个段落、块元素</strong></p>
<p><i><font color="red">注：p标签里不能放置块元素</font></i></p>

        <h2 id="04-em标签">
          <a href="#04-em标签" class="heading-link"><i class="fas fa-link"></i></a><a href="#04-em标签" class="headerlink" title="04_em标签"></a>04_em标签</h2>
      <p>行内标签</p>
<p><strong>用于表示语音语调的加重(斜体)</strong></p>

        <h2 id="05-blockquote-x2F-q标签">
          <a href="#05-blockquote-x2F-q标签" class="heading-link"><i class="fas fa-link"></i></a><a href="#05-blockquote-x2F-q标签" class="headerlink" title="05_blockquote&#x2F;q标签"></a>05_blockquote&#x2F;q标签</h2>
      <p>blockquote</p>
<p><strong>表示一个长引用。块元素</strong></p>
<p>q</p>
<p><strong>表示一个短引用。行内元素</strong></p>

        <h1 id="2-元素">
          <a href="#2-元素" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-元素" class="headerlink" title="2_元素"></a>2_元素</h1>
      
        <h2 id="01-块元素-x2F-行内元素">
          <a href="#01-块元素-x2F-行内元素" class="heading-link"><i class="fas fa-link"></i></a><a href="#01-块元素-x2F-行内元素" class="headerlink" title="01_块元素&#x2F;行内元素"></a>01_块元素&#x2F;行内元素</h2>
      <p><strong>块元素:在网页中一般通过块元素来对页面进行布局。</strong></p>
<p><strong>行内元素：行内元素主要用来包裹文字</strong></p>
<blockquote>
<p>一般情况下会在块元素中放行内元素。不会在行内元素中放置块元素</p>
</blockquote>
<p><em>p元素中不能放置任何块元素</em></p>
<p><strong>浏览器在解析网页时，会自动对网页中不符合规范的内容进行修正。</strong></p>
<p>比如： </p>
<ol>
<li><p>标签写在了根元素的外部。</p>
</li>
<li><p>p元素中嵌套了块元素</p>
</li>
<li><p>根元素中出现了出head和body以外的子元素</p>
</li>
</ol>
<p>查看内存中的代码就是<em>F12→elements</em></p>

        <h2 id="02-a标签">
          <a href="#02-a标签" class="heading-link"><i class="fas fa-link"></i></a><a href="#02-a标签" class="headerlink" title="02_a标签"></a>02_a标签</h2>
      
        <h3 id="相对路径：">
          <a href="#相对路径：" class="heading-link"><i class="fas fa-link"></i></a><a href="#相对路径：" class="headerlink" title="相对路径："></a>相对路径：</h3>
      <p>当我们要跳转到服务器内的地址时，就需要用到相对路劲。一般相对路径都会使用<code>./</code>或者<code>../</code>开头。当所跳转的页面在当前文件所在目录时可省略…</p>
<p><code>./</code>：表示当前文件所在目录。即当前你所在写代码的文件的目录<br><code>../</code>：表示当前文件所在目录的上一级目录</p>
<p>绝对路径：从根目录开始</p>

        <h3 id="target">
          <a href="#target" class="heading-link"><i class="fas fa-link"></i></a><a href="#target" class="headerlink" title="target"></a>target</h3>
      <p>_self:在当前页面打开地址页</p>
<p>_blank:在新的 页面打开地址页</p>
<p>#:回到当前页面的顶部。开发中也可以使用#作为href属性的占位符使用。</p>
<blockquote>
<p>href的占位符有时候我们可能需要它没有功能实现，此时可以使用<code>&lt;a href = &quot;javascript:;&quot;&gt;</code>.这样点击超链接什么都不会发生</p>
</blockquote>

        <h3 id="id">
          <a href="#id" class="heading-link"><i class="fas fa-link"></i></a><a href="#id" class="headerlink" title="id"></a>id</h3>
      <p>每一个标签都可以添加一个id属性，且id是唯一的</p>
<p>可以在a标签的href中写入标签的id值即可跳转到页面对应位置</p>

        <h2 id="03-img标签">
          <a href="#03-img标签" class="heading-link"><i class="fas fa-link"></i></a><a href="#03-img标签" class="headerlink" title="03_img标签"></a>03_img标签</h2>
      <p>替换元素。即在页面上显示的是图片。具有块元素和行内元素的两种元素的特点</p>
<p><strong>属性</strong></p>
<p>src:路径</p>
<p>alt:描述。默认不会显示，有些浏览器在图片加载不出时会显示。搜搜引擎也会根据alt中的内容识别图片。如果不写alt属性则不会被搜索引擎收录</p>
<p>width&#x2F;height:如果只改变其中一个属性，则另外一个会等比例缩放。(一般在PC端要多大图片就对图片裁剪多大。移动端则经常要缩放。)</p>
<p><strong>图片格式</strong></p>
<p>jpeg(jpg):支持的颜色比较丰富，不支持透明效果，不支持动图。————一般用来显示照片</p>
<p>gif:支持的颜色比较少，支持简单透明，支持动图。</p>
<p>png:支持的颜色丰富，支持复杂透明，不支持动图。————颜色丰富，复杂透明的图片（专为网页而生。）</p>
<p>webp:谷歌新推出的专为表示网页中的图片的一种格式.————具备其他格式的所有优点，文件还特别小。但是兼容性不好</p>
<p>base64：将图片使用base64进行编码。这样可以将图片转换成字符，通过字符的方式引入图片。<strong>一般是一些需要和网页一起加载的图片才会使用base64</strong>(百度base64转换即可)</p>

        <h1 id="3-内联框架">
          <a href="#3-内联框架" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-内联框架" class="headerlink" title="3_内联框架"></a>3_内联框架</h1>
      <p><strong>内联框架</strong></p>
<p>用于向当前页面中引入一个其他页面</p>

        <h2 id="01-iframe">
          <a href="#01-iframe" class="heading-link"><i class="fas fa-link"></i></a><a href="#01-iframe" class="headerlink" title="01_iframe"></a>01_iframe</h2>
      <p>src:指定要引入的网页的路径</p>
<p>frameborder：内联框架的边框——0&#x2F;1</p>
<p>用的不多做了解</p>

        <h1 id="4-音视频播放">
          <a href="#4-音视频播放" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-音视频播放" class="headerlink" title="4_音视频播放"></a>4_音视频播放</h1>
      
        <h2 id="01-audio">
          <a href="#01-audio" class="heading-link"><i class="fas fa-link"></i></a><a href="#01-audio" class="headerlink" title="01_audio"></a>01_audio</h2>
      <p>用来向页面引入一个外部的音频文件。默认不允许用户控制播放停止。（IE8及以下不支持）</p>
<p>controls：是否允许用户控制音频</p>
<p>autoplay：音频文件是否自动播放。不过即使加上这个属性，大部分浏览器也不会自动播放</p>
<p>loop：是否循环播放</p>
<p>除了src可以指定外，还可以通过source来指定文件</p>
<p><code>&lt;audio src = &#39;&#39;&gt;&lt;/audio&gt;</code> &#x3D;&#x3D; <code>&lt;audio&gt;&lt;source src = &#39;&#39;&gt;&lt;/source&gt;&lt;/audio&gt;</code></p>
<p>而source指定文件的写法可以友好的提示当前浏览器是否支持audio标签</p>
<p><code>&lt;audio&gt;对不起，浏览器不支持！&lt;source src = &#39;&#39;&gt;&lt;/source&gt;&lt;/audio&gt;</code></p>
<p>同时也可以指定多个source标签。浏览器会从前往后找到可以使用的第一个音频格式。</p>

        <h2 id="02-embed">
          <a href="#02-embed" class="heading-link"><i class="fas fa-link"></i></a><a href="#02-embed" class="headerlink" title="02_embed"></a>02_embed</h2>
      <p>音频标签。基本上浏览器都可以支持。不建议单独使用。可以用以上方式</p>
<figure class="highlight html"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">audio</span>&gt;</span>对不起，浏览器不支持！</span><br><span class="line"><span class="tag">&lt;<span class="name">source</span> <span class="attr">src</span> = <span class="string">&#x27;/audio.mp3&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">source</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">source</span> <span class="attr">src</span> = <span class="string">&#x27;/audio.ogg&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">source</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">embed</span> <span class="attr">src</span> = <span class="string">&#x27;/audio.mp3&#x27;</span> <span class="attr">type</span> = <span class="string">&#x27;audio/mp3&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">embed</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">audio</span>&gt;</span></span><br></pre></td></tr></table></div></figure>

<p>这样如果浏览器不支持source的话就会找到embed标签</p>

        <h2 id="03-video">
          <a href="#03-video" class="heading-link"><i class="fas fa-link"></i></a><a href="#03-video" class="headerlink" title="03_video"></a>03_video</h2>
      <p>向页面引入一个视频文件</p>
<p>使用方式基本上和audio一样。</p>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2020/11/12/%E5%9B%BE%E7%BB%93%E6%9E%84/">图结构</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2020-11-12</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">2022-05-21</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h1 id="图结构">
          <a href="#图结构" class="heading-link"><i class="fas fa-link"></i></a><a href="#图结构" class="headerlink" title="图结构"></a>图结构</h1>
      
        <h2 id="概述">
          <a href="#概述" class="heading-link"><i class="fas fa-link"></i></a><a href="#概述" class="headerlink" title="概述"></a>概述</h2>
      <p><img src="/2020/11/12/%E5%9B%BE%E7%BB%93%E6%9E%84/pic-one.png"></p>

        <h2 id="代码实现">
          <a href="#代码实现" class="heading-link"><i class="fas fa-link"></i></a><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h2>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> picStruct;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 定点类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">verTex</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String value;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">verTex</span><span class="params">(String value)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.value = value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getValue</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setValue</span><span class="params">(String value)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.value = value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;verTex&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;value=&#x27;&quot;</span> + value + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> picStruct;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 图</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">graph</span> &#123;</span><br><span class="line">    <span class="comment">//顶点的数组</span></span><br><span class="line">    <span class="keyword">private</span> verTex[] vertex;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> currentSize;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span>[][] adjMat;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">graph</span><span class="params">(<span class="type">int</span> size)</span> &#123;</span><br><span class="line">        vertex = <span class="keyword">new</span> <span class="title class_">verTex</span>[size];</span><br><span class="line">        adjMat = <span class="keyword">new</span> <span class="title class_">int</span>[size][size];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 向图中加一个顶点</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> v</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addVerTex</span><span class="params">(verTex v)</span>&#123;</span><br><span class="line">        vertex[currentSize++] = v;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addEdge</span><span class="params">(String v1,String v2)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//找出两个顶点的下标</span></span><br><span class="line">        <span class="type">int</span> index1=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;i&lt;vertex.length;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(vertex[i].getValue().equals(v1))&#123;</span><br><span class="line"></span><br><span class="line">                index1 = i;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> index2=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;i&lt;vertex.length;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(vertex[i].getValue().equals(v2))&#123;</span><br><span class="line"></span><br><span class="line">                index2 = i;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        adjMat[index1][index2] = <span class="number">1</span>;</span><br><span class="line">        adjMat[index2][index1] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> picStruct;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">testGraph</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">verTex</span> <span class="variable">v1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">verTex</span>(<span class="string">&quot;A&quot;</span>);</span><br><span class="line">        <span class="type">verTex</span> <span class="variable">v2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">verTex</span>(<span class="string">&quot;B&quot;</span>);</span><br><span class="line">        <span class="type">verTex</span> <span class="variable">v3</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">verTex</span>(<span class="string">&quot;C&quot;</span>);</span><br><span class="line">        <span class="type">verTex</span> <span class="variable">v4</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">verTex</span>(<span class="string">&quot;D&quot;</span>);</span><br><span class="line">        <span class="type">verTex</span> <span class="variable">v5</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">verTex</span>(<span class="string">&quot;E&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">graph</span> <span class="variable">g</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">graph</span>(<span class="number">5</span>);</span><br><span class="line">        g.addVerTex(v1);</span><br><span class="line">        g.addVerTex(v2);</span><br><span class="line">        g.addVerTex(v3);</span><br><span class="line">        g.addVerTex(v4);</span><br><span class="line">        g.addVerTex(v5);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//增加边</span></span><br><span class="line"></span><br><span class="line">        g.addEdge(<span class="string">&quot;A&quot;</span>,<span class="string">&quot;C&quot;</span>);</span><br><span class="line">        g.addEdge(<span class="string">&quot;B&quot;</span>,<span class="string">&quot;C&quot;</span>);</span><br><span class="line">        g.addEdge(<span class="string">&quot;A&quot;</span>,<span class="string">&quot;B&quot;</span>);</span><br><span class="line">        g.addEdge(<span class="string">&quot;B&quot;</span>,<span class="string">&quot;D&quot;</span>);</span><br><span class="line">        g.addEdge(<span class="string">&quot;B&quot;</span>,<span class="string">&quot;E&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span>[] a:g.adjMat)&#123;</span><br><span class="line">            System.out.println(Arrays.toString(a));</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p><img src="/2020/11/12/%E5%9B%BE%E7%BB%93%E6%9E%84/graph=one.png"></p>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2020/11/12/%E5%93%88%E5%B8%8C%E8%A1%A8/">哈希表</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2020-11-12</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">2022-05-21</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h1 id="哈希表">
          <a href="#哈希表" class="heading-link"><i class="fas fa-link"></i></a><a href="#哈希表" class="headerlink" title="哈希表"></a>哈希表</h1>
      
        <h2 id="散列函数">
          <a href="#散列函数" class="heading-link"><i class="fas fa-link"></i></a><a href="#散列函数" class="headerlink" title="散列函数"></a>散列函数</h2>
      <p>（计算简单；分布均匀）</p>
<p><strong>直接定址法</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> hash;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">studentInfo</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> count;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">studentInfo</span><span class="params">(<span class="type">int</span> age, <span class="type">int</span> count)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">        <span class="built_in">this</span>.count = count;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAge</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getCount</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAge</span><span class="params">(<span class="type">int</span> age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setCount</span><span class="params">(<span class="type">int</span> count)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.count = count;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 散列函数</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">hashcode</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> hash;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">hasnTable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> studentInfo[] data = <span class="keyword">new</span> <span class="title class_">studentInfo</span>[<span class="number">100</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 向散列表中添加一个元素</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> stuInfo</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">put</span><span class="params">(studentInfo stuInfo)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//调用散列函数获取存储位置</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> stuInfo.hashcode();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//添加元素</span></span><br><span class="line">        data[index] = stuInfo;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> studentInfo <span class="title function_">get</span><span class="params">(studentInfo sInfo)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> data[sInfo.hashcode()];</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> hash;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">hashTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">studentInfo</span> <span class="variable">s1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">studentInfo</span>(<span class="number">16</span>,<span class="number">3</span>);</span><br><span class="line">        <span class="type">studentInfo</span> <span class="variable">s2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">studentInfo</span>(<span class="number">17</span>,<span class="number">11</span>);</span><br><span class="line">        <span class="type">studentInfo</span> <span class="variable">s3</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">studentInfo</span>(<span class="number">18</span>,<span class="number">23</span>);</span><br><span class="line">        <span class="type">studentInfo</span> <span class="variable">s4</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">studentInfo</span>(<span class="number">19</span>,<span class="number">24</span>);</span><br><span class="line">        <span class="type">studentInfo</span> <span class="variable">s5</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">studentInfo</span>(<span class="number">20</span>,<span class="number">9</span>);</span><br><span class="line">        <span class="type">hasnTable</span> <span class="variable">h1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">hasnTable</span>();</span><br><span class="line">        h1.put(s1);</span><br><span class="line">        h1.put(s2);</span><br><span class="line">        h1.put(s3);</span><br><span class="line">        h1.put(s4);</span><br><span class="line">        h1.put(s5);</span><br><span class="line"></span><br><span class="line">        <span class="type">studentInfo</span> <span class="variable">newInfo</span> <span class="operator">=</span> h1.get(s1);</span><br><span class="line"></span><br><span class="line">        System.out.println(newInfo.getAge());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p><strong>数字分析法</strong></p>
<p><strong>平方取中法</strong></p>
<p><strong>取余法</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 散列函数</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">hashcode</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> age%<span class="number">10</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p><strong>随机数法</strong></p>

        <h2 id="散列冲突的解决方案">
          <a href="#散列冲突的解决方案" class="heading-link"><i class="fas fa-link"></i></a><a href="#散列冲突的解决方案" class="headerlink" title="散列冲突的解决方案"></a>散列冲突的解决方案</h2>
      <p><strong>开放地址法</strong></p>
<p>线性探测法</p>
<p>二次探测法</p>
<p>再哈希法</p>
<p><strong>链地址法</strong></p>
<p>相当于每一个节点存储的是一个链表，可以无限增加</p>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2020/10/31/%E6%A0%91%E7%BB%93%E6%9E%84/">树结构</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2020-10-31</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">2022-05-21</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h1 id="树结构">
          <a href="#树结构" class="heading-link"><i class="fas fa-link"></i></a><a href="#树结构" class="headerlink" title="树结构"></a>树结构</h1>
      
        <h2 id="二叉树">
          <a href="#二叉树" class="heading-link"><i class="fas fa-link"></i></a><a href="#二叉树" class="headerlink" title="二叉树"></a>二叉树</h2>
      <ol>
<li>任何一个节点的子节点的数量不超过2</li>
</ol>
<p><img src="/2020/10/31/%E6%A0%91%E7%BB%93%E6%9E%84/ttree-one.png"></p>
<ol start="2">
<li><p>二叉树的子节点分为左节点和右节点(左右节点不同，二叉树不同)</p>
</li>
<li><p><strong>满二叉树</strong>:所有叶子节点都在最后一层（叶子节点：即没有子节点的节点）。而且节点的总数为2^n-1(n代表树的高度，即最大层。如2层则节点总数为3个)</p>
</li>
</ol>
<p><img src="/2020/10/31/%E6%A0%91%E7%BB%93%E6%9E%84/fullBinaryTree.png"></p>
<ol start="4">
<li><strong>完全二叉树</strong>:所有叶子节点都在最后一层或倒数第二层且<font color="red" style="font-weight:bold;">最后一层的叶子节点在左边连续。倒数第二层的叶子节点在右边连续</font></li>
</ol>
<p><img src="/2020/10/31/%E6%A0%91%E7%BB%93%E6%9E%84/completeBinaryTree.png"></p>

        <h3 id="创建二叉树">
          <a href="#创建二叉树" class="heading-link"><i class="fas fa-link"></i></a><a href="#创建二叉树" class="headerlink" title="创建二叉树"></a>创建二叉树</h3>
      <p><strong>树的类</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> dataStructure;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">binaryTree</span> &#123;</span><br><span class="line"></span><br><span class="line">    treeNode tNode;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">settNode</span><span class="params">(treeNode tNode)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.tNode = tNode;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> treeNode <span class="title function_">gettNode</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> tNode;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p><strong>节点的类</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> dataStructure;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">treeNode</span> &#123;</span><br><span class="line">    <span class="comment">//节点的权</span></span><br><span class="line">    <span class="type">int</span> value;</span><br><span class="line">    <span class="comment">//节点的左子节点</span></span><br><span class="line">    treeNode leftNode;</span><br><span class="line">    <span class="comment">//节点的右子节点</span></span><br><span class="line">    treeNode rightNode;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">treeNode</span><span class="params">(<span class="type">int</span> value)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.value = value;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setValue</span><span class="params">(<span class="type">int</span> value)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.value = value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setLeftNode</span><span class="params">(treeNode leftNode)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.leftNode = leftNode;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setRightNode</span><span class="params">(treeNode rightNode)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.rightNode = rightNode;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p><strong>创建树</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> dataStructure;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">testTree</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//创建一棵树</span></span><br><span class="line">        <span class="type">binaryTree</span> <span class="variable">binTree</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">binaryTree</span>();</span><br><span class="line">        <span class="comment">//创建根节点</span></span><br><span class="line">        <span class="type">treeNode</span> <span class="variable">tNode</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">treeNode</span>(<span class="number">1</span>);</span><br><span class="line">        <span class="comment">//根节点连接数</span></span><br><span class="line">        binTree.settNode(tNode);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//根节点的左子节点</span></span><br><span class="line">        <span class="type">treeNode</span> <span class="variable">leftNode</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">treeNode</span>(<span class="number">2</span>);</span><br><span class="line">        tNode.setLeftNode(leftNode);</span><br><span class="line">        <span class="comment">//根节点的右子节点</span></span><br><span class="line">        <span class="type">treeNode</span> <span class="variable">rightNode</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">treeNode</span>(<span class="number">3</span>);</span><br><span class="line">        tNode.setRightNode(rightNode);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h3 id="遍历二叉树">
          <a href="#遍历二叉树" class="heading-link"><i class="fas fa-link"></i></a><a href="#遍历二叉树" class="headerlink" title="遍历二叉树"></a>遍历二叉树</h3>
      <p><strong>前序遍历</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> dataStructure;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">testTree</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//创建一棵树</span></span><br><span class="line">        <span class="type">binaryTree</span> <span class="variable">binTree</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">binaryTree</span>();</span><br><span class="line">        <span class="comment">//创建根节点</span></span><br><span class="line">        <span class="type">treeNode</span> <span class="variable">tNode</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">treeNode</span>(<span class="number">1</span>);</span><br><span class="line">        <span class="comment">//根节点连接数</span></span><br><span class="line">        binTree.settNode(tNode);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//根节点的左子节点</span></span><br><span class="line">        <span class="type">treeNode</span> <span class="variable">leftNode</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">treeNode</span>(<span class="number">2</span>);</span><br><span class="line">        tNode.setLeftNode(leftNode);</span><br><span class="line">        <span class="comment">//根节点的右子节点</span></span><br><span class="line">        <span class="type">treeNode</span> <span class="variable">rightNode</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">treeNode</span>(<span class="number">3</span>);</span><br><span class="line">        tNode.setRightNode(rightNode);</span><br><span class="line"></span><br><span class="line">        leftNode.setLeftNode(<span class="keyword">new</span> <span class="title class_">treeNode</span>(<span class="number">4</span>));</span><br><span class="line">        leftNode.setRightNode(<span class="keyword">new</span> <span class="title class_">treeNode</span>(<span class="number">5</span>));</span><br><span class="line"></span><br><span class="line">        rightNode.setLeftNode(<span class="keyword">new</span> <span class="title class_">treeNode</span>(<span class="number">6</span>));</span><br><span class="line">        rightNode.setRightNode(<span class="keyword">new</span> <span class="title class_">treeNode</span>(<span class="number">7</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 前序遍历</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        binTree.frontShow();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p><img src="/2020/10/31/%E6%A0%91%E7%BB%93%E6%9E%84/frontShow.png"></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> dataStructure;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">binaryTree</span> &#123;</span><br><span class="line"></span><br><span class="line">    treeNode tNode;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">settNode</span><span class="params">(treeNode tNode)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.tNode = tNode;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> treeNode <span class="title function_">gettNode</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> tNode;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">frontShow</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="keyword">if</span>(tNode!=<span class="literal">null</span>)&#123;</span><br><span class="line">		 	tNode.frontShow();</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> dataStructure;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">treeNode</span> &#123;</span><br><span class="line">    <span class="comment">//节点的权</span></span><br><span class="line">    <span class="type">int</span> value;</span><br><span class="line">    <span class="comment">//节点的左子节点</span></span><br><span class="line">    treeNode leftNode;</span><br><span class="line">    <span class="comment">//节点的右子节点</span></span><br><span class="line">    treeNode rightNode;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">treeNode</span><span class="params">(<span class="type">int</span> value)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.value = value;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setValue</span><span class="params">(<span class="type">int</span> value)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.value = value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setLeftNode</span><span class="params">(treeNode leftNode)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.leftNode = leftNode;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setRightNode</span><span class="params">(treeNode rightNode)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.rightNode = rightNode;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//前序遍历方法</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">frontShow</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(value);</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">this</span>.leftNode!=<span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="built_in">this</span>.leftNode.frontShow();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">this</span>.rightNode!=<span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="built_in">this</span>.rightNode.frontShow();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>
<p><strong><font color="red">结果：</font></strong></p>
<p>·1 2 4 5 3 6 7·</p>
<p><strong>中序遍历</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//中序遍历</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">midShow</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">this</span>.leftNode!=<span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="built_in">this</span>.leftNode.midShow();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(value);</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">this</span>.rightNode!=<span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="built_in">this</span>.rightNode.midShow();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></div></figure>
<p><strong><font color="red">结果：</font></strong></p>
<p>·4 2 5 1 6 3 7·</p>
<p><strong>后序遍历</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//后序遍历</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterShow</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">this</span>.leftNode!=<span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="built_in">this</span>.leftNode.afterShow();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(value);</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">this</span>.rightNode!=<span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="built_in">this</span>.rightNode.afterShow();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(value);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></div></figure>

<p><strong><font color="red">结果：</font></strong></p>
<p><code>4 5 2 6 7 3 1</code></p>

        <h3 id="二叉树节点的查找">
          <a href="#二叉树节点的查找" class="heading-link"><i class="fas fa-link"></i></a><a href="#二叉树节点的查找" class="headerlink" title="二叉树节点的查找"></a>二叉树节点的查找</h3>
      <p><strong>前序查找</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">public</span> treeNode <span class="title function_">frontSearch</span><span class="params">(<span class="type">int</span> i)</span> &#123;</span><br><span class="line">      <span class="type">treeNode</span> <span class="variable">target</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="comment">//如果当前的值位查找的节点，则直接返回当前节点</span></span><br><span class="line">      <span class="keyword">if</span>(i == <span class="built_in">this</span>.value)&#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">else</span>&#123;</span><br><span class="line">	<span class="comment">//如果当前节点有左子节点，则对比左子节点的值</span></span><br><span class="line">           <span class="keyword">if</span>(<span class="built_in">this</span>.leftNode!=<span class="literal">null</span>)&#123;</span><br><span class="line"></span><br><span class="line">               target = <span class="built_in">this</span>.leftNode.frontSearch(i);</span><br><span class="line"></span><br><span class="line">           &#125;</span><br><span class="line">	 <span class="comment">//如果子节点的值对应想要找到的节点，则直接返回这个节点</span></span><br><span class="line">           <span class="keyword">if</span>(target!= <span class="literal">null</span>)&#123;</span><br><span class="line">               <span class="keyword">return</span> target;</span><br><span class="line"></span><br><span class="line">           &#125;</span><br><span class="line">	<span class="comment">//如果当前节点有右子节点，则对比右子节点的值</span></span><br><span class="line">           <span class="keyword">if</span>(<span class="built_in">this</span>.rightNode!=<span class="literal">null</span>)&#123;</span><br><span class="line">               target = <span class="built_in">this</span>.rightNode.frontSearch(i);</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> target;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></div></figure>


        <h3 id="二叉树节点的删除">
          <a href="#二叉树节点的删除" class="heading-link"><i class="fas fa-link"></i></a><a href="#二叉树节点的删除" class="headerlink" title="二叉树节点的删除"></a>二叉树节点的删除</h3>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//删除节点</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteNode</span><span class="params">(<span class="type">int</span> i)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">treeNode</span> <span class="variable">currNode</span> <span class="operator">=</span> <span class="built_in">this</span>;</span><br><span class="line">        <span class="comment">//判断左子节点是否为空</span></span><br><span class="line">        <span class="keyword">if</span>(currNode.leftNode!=<span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="comment">//判断左子节点的值是否为要删除的值</span></span><br><span class="line">            <span class="keyword">if</span>(currNode.leftNode.value == i)&#123;</span><br><span class="line"></span><br><span class="line">                currNode.leftNode = <span class="literal">null</span>;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//如果不是继续递归查找</span></span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line">                currNode.leftNode.deleteNode(i);</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//判断右子节点是否为空</span></span><br><span class="line">        <span class="keyword">if</span>(currNode.rightNode!=<span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="comment">//判断右子节点是否为要删除的值</span></span><br><span class="line">            <span class="keyword">if</span>(currNode.rightNode.value == i)&#123;</span><br><span class="line"></span><br><span class="line">                currNode.rightNode = <span class="literal">null</span>;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line">                currNode.rightNode.deleteNode(i);</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></div></figure>



        <h3 id="顺序存储的二叉树">
          <a href="#顺序存储的二叉树" class="heading-link"><i class="fas fa-link"></i></a><a href="#顺序存储的二叉树" class="headerlink" title="顺序存储的二叉树"></a>顺序存储的二叉树</h3>
      <p><strong>顺序存储的二叉树通常情况下只考虑完全二叉树</strong></p>
<p><strong>性质：</strong></p>
<ol>
<li><p>对于第n个元素的左子节点是<code>2*n+1</code>(n为下标，从0开始)</p>
</li>
<li><p>对于第n个元素的右子节点是<code>2*n+2</code></p>
</li>
<li><p>对于第n个元素的父节点是<code>(n-1)/2</code></p>
</li>
</ol>
<p><img src="/2020/10/31/%E6%A0%91%E7%BB%93%E6%9E%84/sortBinaryTree.png"></p>

        <h3 id="顺序存储的二叉树的遍历">
          <a href="#顺序存储的二叉树的遍历" class="heading-link"><i class="fas fa-link"></i></a><a href="#顺序存储的二叉树的遍历" class="headerlink" title="顺序存储的二叉树的遍历"></a>顺序存储的二叉树的遍历</h3>
      <p><strong><font color="red">依照前序遍历二叉树的思想</font></strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> dataStructure;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">arrayBinaryTree</span> &#123;</span><br><span class="line">    <span class="type">int</span>[] data;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">arrayBinaryTree</span><span class="params">(<span class="type">int</span>[] data)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.data = data;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">frontShow</span><span class="params">()</span>&#123;</span><br><span class="line">        frontShow(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">frontShow</span><span class="params">(<span class="type">int</span> index)</span>&#123;</span><br><span class="line">        <span class="comment">//判断数组是否为空</span></span><br><span class="line">        <span class="keyword">if</span>(data==<span class="literal">null</span>&amp;&amp;data.length==<span class="number">0</span>)&#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        System.out.println(data[index]);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//index*2+1:处理左子节点</span></span><br><span class="line">        <span class="keyword">if</span>(index*<span class="number">2</span>+<span class="number">1</span>&lt;data.length)&#123;</span><br><span class="line"></span><br><span class="line">            frontShow(index*<span class="number">2</span>+<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//index*2+2：处理右子节点</span></span><br><span class="line">        <span class="keyword">if</span>(index*<span class="number">2</span>+<span class="number">2</span>&lt;data.length)&#123;</span><br><span class="line"></span><br><span class="line">            frontShow(index*<span class="number">2</span>+<span class="number">2</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h2 id="线索二叉树">
          <a href="#线索二叉树" class="heading-link"><i class="fas fa-link"></i></a><a href="#线索二叉树" class="headerlink" title="线索二叉树"></a>线索二叉树</h2>
      <p><strong>1. 线索化二叉树时，一个节点的前一个节点叫前驱节点</strong></p>
<p><strong>2. 线索化二叉树时，一个节点的后一个节点叫后继节点</strong></p>
<p>思路: 线索二叉树即运用前序遍历，中序遍历或者后序遍历的方法遍历各个节点。</p>
<blockquote>
<p>如果使用中序遍历进行线索二叉树的转化。那么各个节点的左子节点即为该节点的前驱节点，各个节点的右子节点即为该节点的后继节点。如果该节点B没有左子节点，那么遍历时的它的上一个节点A就是它的前驱节点。而上一个节点A既不为null也没有右子节点的情况下，A的后继节点即为该B节点。</p>
</blockquote>
<p><strong>使用中序遍历构建线索二叉树</strong></p>
<p><img src="/2020/10/31/%E6%A0%91%E7%BB%93%E6%9E%84/threadTree-one.png"></p>
<ol>
<li>构建线索二叉树</li>
</ol>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> threadBinaryTree;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">threadBinaryTree</span> &#123;</span><br><span class="line"></span><br><span class="line">    treeNode tNode;</span><br><span class="line">    <span class="comment">//定义当前节点的前一个节点</span></span><br><span class="line">    <span class="type">treeNode</span> <span class="variable">pre</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="comment">//重载方法</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">threadNodes</span><span class="params">()</span>&#123;</span><br><span class="line">        threadNodes(tNode);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//使用中序遍历构造线索二叉树</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">threadNodes</span><span class="params">(treeNode node)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(node == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//处理左子树</span></span><br><span class="line">        threadNodes(node.leftNode);</span><br><span class="line">        <span class="comment">//处理前驱节点</span></span><br><span class="line">        <span class="keyword">if</span>(node.leftNode == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="comment">//让当前节点的左指针指向前驱节点</span></span><br><span class="line">            node.leftNode = pre;</span><br><span class="line">            <span class="comment">//改变当前节点的左指针类型</span></span><br><span class="line">            node.leftType = <span class="number">1</span>;<span class="comment">//代表是前驱节点类型</span></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//处理前驱的右指针，如果前驱节点的右指针为null(即没有指向右子树)</span></span><br><span class="line">        <span class="comment">//此处的条件pre！=null是考虑到递进到最后一个左子节点时pre为null</span></span><br><span class="line">        <span class="keyword">if</span>(pre!=<span class="literal">null</span>&amp;&amp;pre.rightNode == <span class="literal">null</span>)&#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//让前驱节点的右指针指向当前节点</span></span><br><span class="line">            pre.rightNode = node;</span><br><span class="line">            pre.rightType = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//每处理一个节点，当前节点就是下一个节点的前驱节点</span></span><br><span class="line">        pre = node;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//处理右子树</span></span><br><span class="line">        threadNodes(node.rightNode);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">settNode</span><span class="params">(treeNode tNode)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.tNode = tNode;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> treeNode <span class="title function_">gettNode</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> tNode;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<ol start="2">
<li>节点类添加两个int类型的数据，用来表示当前节点的左子节点和右子节点的类型【leftType，rightType】：</li>
</ol>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> threadBinaryTree;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">treeNode</span> &#123;</span><br><span class="line">    <span class="comment">//节点的权</span></span><br><span class="line">    <span class="type">int</span> value;</span><br><span class="line">    <span class="comment">//节点的左子节点</span></span><br><span class="line">    treeNode leftNode;</span><br><span class="line">    <span class="comment">//节点的右子节点</span></span><br><span class="line">    treeNode rightNode;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//定义节点类型。默认为0，代表其为左子节点或由子节点</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">leftType</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">rightType</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">treeNode</span><span class="params">(<span class="type">int</span> value)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.value = value;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setValue</span><span class="params">(<span class="type">int</span> value)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.value = value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setLeftNode</span><span class="params">(treeNode leftNode)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.leftNode = leftNode;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setRightNode</span><span class="params">(treeNode rightNode)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.rightNode = rightNode;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p><strong>线索化遍历二叉树</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//线索化遍历二叉树</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">threadIterator</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">treeNode</span> <span class="variable">rNode</span> <span class="operator">=</span> tNode;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(rNode!=<span class="literal">null</span>)&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span>(rNode.leftType==<span class="number">0</span>)&#123;</span><br><span class="line">            rNode = rNode.leftNode;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        System.out.println(rNode.value);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span>(rNode.rightType == <span class="number">1</span>)&#123;</span><br><span class="line">            rNode = rNode.rightNode;</span><br><span class="line">            System.out.println(rNode.value);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        rNode = rNode.rightNode;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>



        <h2 id="赫夫曼树">
          <a href="#赫夫曼树" class="heading-link"><i class="fas fa-link"></i></a><a href="#赫夫曼树" class="headerlink" title="赫夫曼树"></a>赫夫曼树</h2>
      
        <h3 id="概述">
          <a href="#概述" class="heading-link"><i class="fas fa-link"></i></a><a href="#概述" class="headerlink" title="概述:"></a>概述:</h3>
      <p><strong>最优二叉树:</strong></p>
<p><strong><font color="red">它是n个带权叶子节点构成的所有二叉树中，带权路径长度最小的二叉树</font></strong></p>
<p><strong>叶节点的带权路径</strong></p>
<p><strong><font color="red">从根节点出发，它经过的节点的数量乘以该叶子节点的权值即为叶子节点的带权路径</font></strong></p>
<p><strong>树的带权路径长度WPL(weighted path length)</strong></p>
<p><strong><font color="red">树中所有叶子节点的带权路径长度之和</font></strong></p>
<p><strong><font color="green">权值越大的节点离根节点越近的二叉树才是最优二叉树。即赫夫曼树</font></strong></p>
<p><img src="/2020/10/31/%E6%A0%91%E7%BB%93%E6%9E%84/hoffmanTree-one.png"></p>

        <h3 id="创建赫夫曼树流程">
          <a href="#创建赫夫曼树流程" class="heading-link"><i class="fas fa-link"></i></a><a href="#创建赫夫曼树流程" class="headerlink" title="创建赫夫曼树流程"></a>创建赫夫曼树流程</h3>
      <p><img src="/2020/10/31/%E6%A0%91%E7%BB%93%E6%9E%84/hoffmanTree-two.png"></p>
<p><strong>求出最终wpl值</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> hoffmanTree;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Collections;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">testHoffmanTree</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">int</span>[] arrs = <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">29</span>,<span class="number">11</span>,<span class="number">23</span>,<span class="number">14</span>&#125;;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">root</span> <span class="operator">=</span> creatHoffmanTree(arrs);</span><br><span class="line">        System.out.println(root.value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 1. 先取出数组中所有的元素创建若干个二叉树(只有一个节点)</span></span><br><span class="line"><span class="comment">     * 2. 首先对数组排序</span></span><br><span class="line"><span class="comment">     * 3. 取出权值最小的两个二叉树</span></span><br><span class="line"><span class="comment">     * 4. 创建一个新的二叉树</span></span><br><span class="line"><span class="comment">     * 5. 把取出来的两个二叉树移除</span></span><br><span class="line"><span class="comment">     * 6. 放入原来的二叉树中</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> arrs</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Node <span class="title function_">creatHoffmanTree</span><span class="params">(<span class="type">int</span>[] arrs)</span>&#123;</span><br><span class="line">        <span class="comment">// 1.先取出数组中所有的元素创建若干个二叉树(只有一个节点)</span></span><br><span class="line">        List&lt;Node&gt; nodes = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> value:arrs)&#123;</span><br><span class="line">            nodes.add(<span class="keyword">new</span> <span class="title class_">Node</span>(value));</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 2. 循环处理</span></span><br><span class="line">        <span class="keyword">while</span>(nodes.size()&gt;<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="comment">// 3. 首先对数组排序（升序）</span></span><br><span class="line">            Collections.sort(nodes);</span><br><span class="line">            <span class="comment">// 4. 取出权值最小的二叉树</span></span><br><span class="line">            <span class="type">Node</span> <span class="variable">left</span> <span class="operator">=</span> nodes.get(<span class="number">0</span>);</span><br><span class="line">            <span class="comment">// 取出权值次小的二叉树</span></span><br><span class="line">            <span class="type">Node</span> <span class="variable">right</span> <span class="operator">=</span> nodes.get(<span class="number">1</span>);</span><br><span class="line">            <span class="type">Node</span> <span class="variable">parent</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Node</span>(left.value+right.value);</span><br><span class="line">			<span class="comment">//两个子节点连接父节点</span></span><br><span class="line">            parent.leftNode=left;</span><br><span class="line">            parent.rightNode = right;</span><br><span class="line">            <span class="comment">// 5. 把取出来的两个二叉树移除</span></span><br><span class="line">            nodes.remove(left);</span><br><span class="line">            nodes.remove(right);</span><br><span class="line">            nodes.add(parent);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">         &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> nodes.get(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> hoffmanTree;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Node</span>  <span class="keyword">implements</span> <span class="title class_">Comparable</span>&lt;Node&gt;&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//节点的权</span></span><br><span class="line">    <span class="type">int</span> value;</span><br><span class="line">    <span class="comment">//左子节点</span></span><br><span class="line">    Node leftNode;</span><br><span class="line">    <span class="comment">//右子节点</span></span><br><span class="line">    Node rightNode;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Node</span><span class="params">(<span class="type">int</span> value)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">this</span>.value = value;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compareTo</span><span class="params">(Node o)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.value-o.value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Node&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;value=&quot;</span> + value +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h2 id="赫夫曼编码原理">
          <a href="#赫夫曼编码原理" class="heading-link"><i class="fas fa-link"></i></a><a href="#赫夫曼编码原理" class="headerlink" title="赫夫曼编码原理"></a>赫夫曼编码原理</h2>
      <p><img src="/2020/10/31/%E6%A0%91%E7%BB%93%E6%9E%84/dcCode.png"></p>
<p><img src="/2020/10/31/%E6%A0%91%E7%BB%93%E6%9E%84/bdcCode.png"></p>
<p><img src="/2020/10/31/%E6%A0%91%E7%BB%93%E6%9E%84/hoffmanCode.png"></p>
<p><strong>赫夫曼编码可直接从左到右进行对比，没有第二种那样一个字符的编码可能是其他字符编码的前缀,导致无法分清的情况</strong></p>

        <h2 id="赫夫曼编码进行数据压缩">
          <a href="#赫夫曼编码进行数据压缩" class="heading-link"><i class="fas fa-link"></i></a><a href="#赫夫曼编码进行数据压缩" class="headerlink" title="赫夫曼编码进行数据压缩"></a>赫夫曼编码进行数据压缩</h2>
      <p><strong>过程</strong></p>
<p><img src="/2020/10/31/%E6%A0%91%E7%BB%93%E6%9E%84/huffmanZip-Process.png"></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> hoffmanZip;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Node</span> <span class="keyword">implements</span> <span class="title class_">Comparable</span>&lt;Node&gt;&#123;</span><br><span class="line">    Byte data;<span class="comment">//数据</span></span><br><span class="line">    <span class="type">int</span> weight;<span class="comment">//节点的权</span></span><br><span class="line">    Node left;</span><br><span class="line">    Node right;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Node</span><span class="params">(Byte data,<span class="type">int</span> weight)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.data = data;</span><br><span class="line">        <span class="built_in">this</span>.weight = weight;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Node&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;data=&quot;</span> + data +</span><br><span class="line">                <span class="string">&quot;, weight=&quot;</span> + weight +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compareTo</span><span class="params">(Node o)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.weight-o.weight;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> hoffmanZip;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">hoffmanTestZip</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">msg</span> <span class="operator">=</span> <span class="string">&quot;can you can a can as a can canner can a can.&quot;</span>;</span><br><span class="line">        <span class="type">byte</span>[] bytes = msg.getBytes();</span><br><span class="line"></span><br><span class="line">        <span class="type">byte</span>[] bytes1Zip = hoffmanZip(bytes);</span><br><span class="line">        System.out.println(bytes.length);</span><br><span class="line">        System.out.println(bytes1Zip.length);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 进行赫夫曼编码压缩的方法</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> bytes</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">byte</span>[] hoffmanZip(<span class="type">byte</span>[] bytes) &#123;</span><br><span class="line">        <span class="comment">// 1 .先统计每一个byte出现的次数并放入集合中</span></span><br><span class="line">        List&lt;Node&gt; nodeList = getNodes(bytes);</span><br><span class="line">        <span class="comment">// 2. 创建一课赫夫曼树</span></span><br><span class="line">        <span class="type">Node</span> <span class="variable">rootNode</span> <span class="operator">=</span> createHoffman(nodeList);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3. 创建一个赫夫曼编码表</span></span><br><span class="line">        Map&lt;Byte,String&gt; huffCode = getHuffmanCode(rootNode);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 4. 编码</span></span><br><span class="line">        <span class="type">byte</span>[] b =  zip(bytes,huffCode);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> b;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 统计每一个byte出现的次数并放入集合中</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> bytes</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> List&lt;Node&gt; <span class="title function_">getNodes</span><span class="params">(<span class="type">byte</span>[] bytes)</span>&#123;</span><br><span class="line"></span><br><span class="line">        List&lt;Node&gt; nodeList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">//存储每一个byte出现了多少次</span></span><br><span class="line">        Map&lt;Byte,Integer&gt; nodeMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; bytes.length; i++)&#123;</span><br><span class="line">            <span class="comment">//根据当前循环的数组的值获取Map集合中的次数</span></span><br><span class="line">            <span class="type">Integer</span> <span class="variable">counts</span> <span class="operator">=</span> nodeMap.get(bytes[i]);</span><br><span class="line">            <span class="comment">//如果次数为null，则说明Map集合中还没有存放该值</span></span><br><span class="line">            <span class="keyword">if</span>(counts == <span class="literal">null</span>)&#123;</span><br><span class="line"></span><br><span class="line">                nodeMap.put(bytes[i],<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="comment">//否则次数加1</span></span><br><span class="line">                nodeMap.put(bytes[i],counts+<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//循环Map数组，将其加入到list集合中</span></span><br><span class="line">        <span class="keyword">for</span>(Map.Entry&lt;Byte,Integer&gt; entry:nodeMap.entrySet())&#123;</span><br><span class="line"></span><br><span class="line">            nodeList.add(<span class="keyword">new</span> <span class="title class_">Node</span>(entry.getKey(),entry.getValue()));</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> nodeList;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 创建一棵赫夫曼树</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Node <span class="title function_">createHoffman</span><span class="params">(List&lt;Node&gt; nlist)</span>&#123;</span><br><span class="line">        <span class="keyword">while</span>(nlist.size()&gt;<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="comment">//排序</span></span><br><span class="line">            Collections.sort(nlist);</span><br><span class="line">            <span class="comment">//找到最小的两个节点</span></span><br><span class="line">            <span class="type">Node</span> <span class="variable">left</span> <span class="operator">=</span> nlist.get(<span class="number">0</span>);</span><br><span class="line">            <span class="type">Node</span> <span class="variable">right</span> <span class="operator">=</span> nlist.get(<span class="number">1</span>);</span><br><span class="line">            <span class="comment">//将这两个节点连接至父节点</span></span><br><span class="line">            <span class="type">Node</span> <span class="variable">parent</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Node</span>(<span class="literal">null</span>,left.weight+right.weight);</span><br><span class="line">            parent.left = left;</span><br><span class="line">            parent.right = right;</span><br><span class="line">            <span class="comment">//在集合中删除两个子节点并添加父节点</span></span><br><span class="line">            nlist.remove(left);</span><br><span class="line">            nlist.remove(right);</span><br><span class="line">            nlist.add(parent);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> nlist.get(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//用于临时存储路径</span></span><br><span class="line">    <span class="keyword">static</span> <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">    <span class="comment">//用于存储赫夫曼编码</span></span><br><span class="line">    <span class="keyword">static</span> HashMap&lt;Byte, String&gt; cMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    <span class="comment">//根据赫夫曼树获取赫夫曼编码</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Map&lt;Byte,String&gt; <span class="title function_">getHuffmanCode</span><span class="params">(Node tree)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(tree == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        getHuffmanCode(tree.left,<span class="string">&quot;0&quot;</span>,sb);</span><br><span class="line">        getHuffmanCode(tree.right,<span class="string">&quot;1&quot;</span>,sb);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> cMap;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">getHuffmanCode</span><span class="params">(Node node, String s, StringBuilder sb)</span> &#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 此处定义的 StringBuilder sb2 = new StringBuilder(sb);是每次进入该方法时都会将传入的StringBuilder类型</span></span><br><span class="line"><span class="comment">         * 的参数sb重新装入sb2中。这样可以避免因为引用类型的调用而改变原本定义的值</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>(sb);</span><br><span class="line">        sb2.append(s);</span><br><span class="line">        <span class="keyword">if</span>(node.data==<span class="literal">null</span>) &#123;</span><br><span class="line">            getHuffmanCode(node.left, <span class="string">&quot;0&quot;</span>, sb2);</span><br><span class="line">            <span class="type">String</span> <span class="variable">a</span> <span class="operator">=</span> sb2.toString();</span><br><span class="line">            getHuffmanCode(node.right, <span class="string">&quot;1&quot;</span>, sb2);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line">            cMap.put(node.data,sb2.toString());</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 进行赫夫曼编码</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> bytes</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> huffCodes</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">byte</span>[] zip(<span class="type">byte</span>[] bytes,Map&lt;Byte,String&gt; huffCodes)&#123;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="comment">//把需要压缩的byte数组处理成一个二进制的字符串</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">byte</span> b:bytes)&#123;</span><br><span class="line">            sb.append(huffCodes.get(b));</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//定义长度</span></span><br><span class="line">        <span class="type">int</span> len;</span><br><span class="line">        <span class="keyword">if</span>(sb.length()%<span class="number">8</span>==<span class="number">0</span>)&#123;</span><br><span class="line"></span><br><span class="line">            len = sb.length()/<span class="number">8</span>;</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            len = sb.length()/<span class="number">8</span>+<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//用于存储压缩后的byte</span></span><br><span class="line">        <span class="type">byte</span>[] by = <span class="keyword">new</span> <span class="title class_">byte</span>[len];</span><br><span class="line">        <span class="comment">//记录新byte位置</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;i&lt;sb.length();i+=<span class="number">8</span>)&#123;</span><br><span class="line">            String strByte;</span><br><span class="line">            <span class="keyword">if</span>(i+<span class="number">8</span>&gt;sb.length())&#123;</span><br><span class="line">                strByte = sb.substring(i);</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                strByte = sb.substring(i, i + <span class="number">8</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">byte</span> <span class="variable">byt</span> <span class="operator">=</span> (<span class="type">byte</span>) Integer.parseInt(strByte,<span class="number">2</span>);</span><br><span class="line">            by[index] = byt;</span><br><span class="line">            index++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span>  by;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></div></figure>



        <h2 id="使用赫夫曼编码进行解码">
          <a href="#使用赫夫曼编码进行解码" class="heading-link"><i class="fas fa-link"></i></a><a href="#使用赫夫曼编码进行解码" class="headerlink" title="使用赫夫曼编码进行解码"></a>使用赫夫曼编码进行解码</h2>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">msg</span> <span class="operator">=</span> <span class="string">&quot;can you can a can as a can canner can a can.&quot;</span>;</span><br><span class="line">    <span class="type">byte</span>[] bytes = msg.getBytes();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">byte</span> a:bytes</span><br><span class="line">         ) &#123;</span><br><span class="line">        System.out.print(a+<span class="string">&quot; &quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">   <span class="type">byte</span>[] bytes1Zip = hoffmanZip(bytes);</span><br><span class="line">    <span class="comment">//解码</span></span><br><span class="line">    <span class="type">byte</span>[] decodeA = decode(cMap,bytes1Zip);</span><br><span class="line">    System.out.println(<span class="keyword">new</span> <span class="title class_">String</span>(decodeA));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">static</span>  <span class="type">byte</span>[] decode(Map&lt;Byte,String&gt; huffcode,<span class="type">byte</span>[] bytes)&#123;</span><br><span class="line"></span><br><span class="line">       <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">       <span class="comment">//把byte数组转换为一个二进制的字符串</span></span><br><span class="line">       <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;i&lt;bytes.length;i++)&#123;</span><br><span class="line">           <span class="type">byte</span> <span class="variable">b</span> <span class="operator">=</span> bytes[i];</span><br><span class="line">           <span class="comment">//判断是否是最后一个</span></span><br><span class="line">           <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> (i==bytes.length-<span class="number">1</span>);</span><br><span class="line">           sb.append(byteToBitStr(!flag,b));</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="comment">//把字符串按照指定的赫夫曼编码进行解码</span></span><br><span class="line">       <span class="comment">//把赫夫曼编码的键值对</span></span><br><span class="line">       Map&lt;String,Byte&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">       <span class="keyword">for</span>(Map.Entry&lt;Byte,String&gt; entry:huffcode.entrySet())&#123;</span><br><span class="line">           map.put(entry.getValue(), entry.getKey());</span><br><span class="line"></span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="comment">//创建一个集合。用于存byte</span></span><br><span class="line">       List&lt;Byte&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">       <span class="comment">//处理字符串</span></span><br><span class="line">       <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;i&lt;sb.length();)&#123;</span><br><span class="line"></span><br><span class="line">           <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">           <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line">           <span class="type">Byte</span> <span class="variable">b</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">           <span class="comment">//截取出一个byte</span></span><br><span class="line">           <span class="keyword">while</span>(flag)&#123;</span><br><span class="line"></span><br><span class="line">               <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> sb.substring(i,i+count);</span><br><span class="line">               b = map.get(key);</span><br><span class="line">               <span class="keyword">if</span>(b == <span class="literal">null</span>)&#123;</span><br><span class="line">                   count++;</span><br><span class="line"></span><br><span class="line">               &#125;<span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">                   flag = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">               &#125;</span><br><span class="line"></span><br><span class="line">           &#125;</span><br><span class="line">           System.out.println(b);</span><br><span class="line">           list.add(b);</span><br><span class="line">           i+=count;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="comment">//把集合转换为数组</span></span><br><span class="line">       <span class="type">byte</span>[] bArr = <span class="keyword">new</span> <span class="title class_">byte</span>[list.size()];</span><br><span class="line">       <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>;j&lt;bArr.length;j++)&#123;</span><br><span class="line">           bArr[j] = list.get(j);</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> bArr;</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line"><span class="comment">//补齐位数的方法</span></span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">static</span> String <span class="title function_">byteToBitStr</span><span class="params">(<span class="type">boolean</span> flag,<span class="type">byte</span> b)</span>&#123;</span><br><span class="line">       <span class="type">int</span> <span class="variable">temp</span> <span class="operator">=</span> b;</span><br><span class="line">	<span class="comment">//如果是最后一个二进制数据的话不用补齐位数</span></span><br><span class="line">       <span class="keyword">if</span>(flag) &#123;</span><br><span class="line">           temp |= <span class="number">256</span>;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> Integer.toBinaryString(temp);</span><br><span class="line">       <span class="keyword">if</span>(flag)&#123;</span><br><span class="line">           <span class="keyword">return</span>  str.substring(str.length()-<span class="number">8</span>);</span><br><span class="line"></span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">else</span>&#123;</span><br><span class="line">           <span class="keyword">return</span>  str;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></div></figure>



        <h2 id="二叉排序树">
          <a href="#二叉排序树" class="heading-link"><i class="fas fa-link"></i></a><a href="#二叉排序树" class="headerlink" title="二叉排序树"></a>二叉排序树</h2>
      
        <h3 id="概述-1">
          <a href="#概述-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#概述-1" class="headerlink" title="概述:"></a>概述:</h3>
      <p>也叫二叉查找树，二叉搜索树:BST<br>对于二叉树中的任何一个非叶子节点，要求左子节点比当前节点值小。右子节点比当前节点值大。</p>
<p><strong>线性结构存储的缺点</strong></p>
<ol>
<li><p>顺序存储(不排序):查找困难</p>
</li>
<li><p>顺序存储(排序):删除插入困难</p>
</li>
<li><p>链式存储(无论是否排序):查找困难</p>
</li>
</ol>
<p><img src="/2020/10/31/%E6%A0%91%E7%BB%93%E6%9E%84/binarySortTree-one.png"></p>

        <h3 id="创建二叉排序树-amp-添加节点">
          <a href="#创建二叉排序树-amp-添加节点" class="heading-link"><i class="fas fa-link"></i></a><a href="#创建二叉排序树-amp-添加节点" class="headerlink" title="创建二叉排序树&amp;添加节点"></a>创建二叉排序树&amp;添加节点</h3>
      <ol>
<li><p>从根节点开始判断，如果添加的节点的值小于当前节点的值，那么递进到二叉排序树的左子节点</p>
</li>
<li><p>反之，如果添加的节点的值大于当前节点的值，那么递进到二叉排序树的右子节点</p>
</li>
</ol>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> binarySortTree;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">binarySTree</span> &#123;</span><br><span class="line">    Node root;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">binarySTree</span><span class="params">(Node node)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.root = node;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">binarySTree</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 二叉排序树添加节点</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> node</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(Node node)</span>&#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(root == <span class="literal">null</span>)&#123;</span><br><span class="line"></span><br><span class="line">                <span class="built_in">this</span>.root = node;</span><br><span class="line"></span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="built_in">this</span>.root.add(node);</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 中序遍历</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">midShow</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">this</span>.root.midShow(root);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> binarySortTree;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Node</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> value;</span><br><span class="line"></span><br><span class="line">    Node left;</span><br><span class="line">    Node right;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Node</span><span class="params">(<span class="type">int</span> value)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">this</span>.value = value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 二叉排序树添加节点</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> node</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(Node node)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//判断如果传入的节点为空直接返回</span></span><br><span class="line">        <span class="keyword">if</span>(node == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//判断传入的节点的值是否小于当前节点的值</span></span><br><span class="line">        <span class="keyword">if</span>(node.value&lt;<span class="built_in">this</span>.value)&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">this</span>.left == <span class="literal">null</span>)&#123;</span><br><span class="line"></span><br><span class="line">                <span class="built_in">this</span>.left = node;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="built_in">this</span>.left.add(node);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="comment">//判断传入的节点的值是否大于当前节点的值</span></span><br><span class="line">            <span class="keyword">if</span>(node.value&gt;<span class="built_in">this</span>.value)&#123;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span>(<span class="built_in">this</span>.right == <span class="literal">null</span>)&#123;</span><br><span class="line">                    <span class="built_in">this</span>.right = node;</span><br><span class="line">                &#125;<span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">                    <span class="built_in">this</span>.right.add(node);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 中序遍历二叉排序树</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">midShow</span><span class="params">(Node node)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(node == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        midShow(node.left);</span><br><span class="line"></span><br><span class="line">        System.out.println(node.value);</span><br><span class="line"></span><br><span class="line">        midShow((node.right));</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>



        <h3 id="查找节点">
          <a href="#查找节点" class="heading-link"><i class="fas fa-link"></i></a><a href="#查找节点" class="headerlink" title="查找节点"></a>查找节点</h3>
      <ol>
<li><p>从根节点开始，如果查找的节点的值小于当前节点，那么递进向左子树查找</p>
</li>
<li><p>反之，如果查找的节点的值大于当前节点，那么递进向右子树查找</p>
</li>
</ol>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> binarySortTree;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">binarySTree</span> &#123;</span><br><span class="line">    Node root;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">binarySTree</span><span class="params">(Node node)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.root = node;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">binarySTree</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 中序遍历</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">midShow</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">this</span>.root.midShow(root);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查找节点</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Node <span class="title function_">searchNode</span><span class="params">(<span class="type">int</span> value)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">this</span>.root == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">           <span class="keyword">return</span> <span class="built_in">this</span>.root.searchNode(value);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   </span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> binarySortTree;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Node</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> value;</span><br><span class="line"></span><br><span class="line">    Node left;</span><br><span class="line">    Node right;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Node</span><span class="params">(<span class="type">int</span> value)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">this</span>.value = value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 中序遍历二叉排序树</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">midShow</span><span class="params">(Node node)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(node == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        midShow(node.left);</span><br><span class="line"></span><br><span class="line">        System.out.println(node.value);</span><br><span class="line"></span><br><span class="line">        midShow((node.right));</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查找 搜索节点</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Node <span class="title function_">searchNode</span><span class="params">(<span class="type">int</span> value)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">this</span>.value == value)&#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">this</span>.value&gt;value)&#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">this</span>.left == <span class="literal">null</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span>(<span class="built_in">this</span>.left.value == value)&#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="built_in">this</span>.left;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">return</span> <span class="built_in">this</span>.left.searchNode(value);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">this</span>.right == <span class="literal">null</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span>(<span class="built_in">this</span>.right.value == value)&#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="built_in">this</span>.right;</span><br><span class="line">                &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="built_in">this</span>.right.searchNode(value);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h3 id="删除节点">
          <a href="#删除节点" class="heading-link"><i class="fas fa-link"></i></a><a href="#删除节点" class="headerlink" title="删除节点"></a>删除节点</h3>
      <p><img src="/2020/10/31/%E6%A0%91%E7%BB%93%E6%9E%84/binarySortTree-two.png"></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> binarySortTree;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">binarySTree</span> &#123;</span><br><span class="line">    Node root;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">binarySTree</span><span class="params">(Node node)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.root = node;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">binarySTree</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 中序遍历</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">midShow</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">this</span>.root.midShow(root);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 二叉排序树删除节点</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delNode</span><span class="params">(<span class="type">int</span> value)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">this</span>.root == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="comment">// 找到这个节点</span></span><br><span class="line">            <span class="type">Node</span> <span class="variable">target</span> <span class="operator">=</span> searchNode(value);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(target == <span class="literal">null</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//找到它的父节点</span></span><br><span class="line"></span><br><span class="line">            <span class="type">Node</span> <span class="variable">parentNode</span> <span class="operator">=</span> searchParentNode(value);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//要删除的节点是叶子节点</span></span><br><span class="line">            <span class="keyword">if</span>(target.left==<span class="literal">null</span>&amp;&amp;target.right==<span class="literal">null</span>)&#123;</span><br><span class="line"></span><br><span class="line">                <span class="comment">//要删除的节点是父节点的左子节点</span></span><br><span class="line">                <span class="keyword">if</span>(parentNode.left.value == value)&#123;</span><br><span class="line"></span><br><span class="line">                    parentNode.left = <span class="literal">null</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">//要删除的节点是父节点的右子节点</span></span><br><span class="line">                <span class="keyword">else</span>&#123;</span><br><span class="line">                    parentNode.right = <span class="literal">null</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(target.right!=<span class="literal">null</span>&amp;&amp;target.left!=<span class="literal">null</span>)&#123;</span><br><span class="line"></span><br><span class="line">                <span class="comment">//要删除的节点有两个子节点</span></span><br><span class="line">                <span class="comment">//删除右子树中值最小的节点，并获取到该节点的值</span></span><br><span class="line">                <span class="type">int</span> <span class="variable">min</span> <span class="operator">=</span> deleteMin(target.right);</span><br><span class="line">                <span class="comment">//替换目标节点中的内容(值)</span></span><br><span class="line">                target.value = min;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="comment">//要删除的节点有一个左子节点或者右子节点</span></span><br><span class="line">                <span class="keyword">if</span>(target.left!=<span class="literal">null</span>)&#123;</span><br><span class="line"></span><br><span class="line">                    <span class="comment">//有左子节点</span></span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span>(parentNode.left.value == value)&#123;</span><br><span class="line">                       parentNode.left = target.left;</span><br><span class="line"></span><br><span class="line">                    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                        parentNode.right = target.left;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line">                    <span class="comment">//有右子节点</span></span><br><span class="line">                    <span class="keyword">if</span>(parentNode.left.value == value)&#123;</span><br><span class="line">                        parentNode.left = target.right;</span><br><span class="line">                    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                        parentNode.right = target.right;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 删除一棵树中最小的节点</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> node</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="title function_">deleteMin</span><span class="params">(Node node)</span> &#123;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">target</span> <span class="operator">=</span> node;</span><br><span class="line">        <span class="comment">//循环向左找到最小的节点</span></span><br><span class="line">        <span class="keyword">while</span> (target.left!=<span class="literal">null</span>)&#123;</span><br><span class="line">            target = target.left;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//如果这个节点有右子节点，那么应该按照之前写的删除方法中的节点只有右子节点的方法删除</span></span><br><span class="line">        delNode(target.value);</span><br><span class="line">        <span class="keyword">return</span> target.value;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 搜索父节点</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Node <span class="title function_">searchParentNode</span><span class="params">(<span class="type">int</span> value)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">this</span>.root == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line">           <span class="keyword">return</span> <span class="built_in">this</span>.root.searchParentNode(value);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> binarySortTree;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Node</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> value;</span><br><span class="line"></span><br><span class="line">    Node left;</span><br><span class="line">    Node right;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Node</span><span class="params">(<span class="type">int</span> value)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">this</span>.value = value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 中序遍历二叉排序树</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">midShow</span><span class="params">(Node node)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(node == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        midShow(node.left);</span><br><span class="line"></span><br><span class="line">        System.out.println(node.value);</span><br><span class="line"></span><br><span class="line">        midShow((node.right));</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查找 搜索节点</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Node <span class="title function_">searchNode</span><span class="params">(<span class="type">int</span> value)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">this</span>.value == value)&#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">this</span>.value&gt;value)&#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">this</span>.left == <span class="literal">null</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span>(<span class="built_in">this</span>.left.value == value)&#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="built_in">this</span>.left;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">return</span> <span class="built_in">this</span>.left.searchNode(value);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">this</span>.right == <span class="literal">null</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span>(<span class="built_in">this</span>.right.value == value)&#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="built_in">this</span>.right;</span><br><span class="line">                &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="built_in">this</span>.right.searchNode(value);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 搜索父节点</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Node <span class="title function_">searchParentNode</span><span class="params">(<span class="type">int</span> value)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">this</span>.left!=<span class="literal">null</span>&amp;&amp;<span class="built_in">this</span>.left.value == value||<span class="built_in">this</span>.right!=<span class="literal">null</span>&amp;&amp;<span class="built_in">this</span>.right.value == value)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//没有判断子节点与传入的值相等的情况。故会返回null</span></span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">this</span>.value&gt;value&amp;&amp;<span class="built_in">this</span>.left!=<span class="literal">null</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">this</span>.left.searchParentNode(value);</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">this</span>.value&lt;value&amp;&amp;<span class="built_in">this</span>.right!=<span class="literal">null</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">this</span>.right.searchParentNode(value);</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>



        <h2 id="平衡二叉树（AVL树）">
          <a href="#平衡二叉树（AVL树）" class="heading-link"><i class="fas fa-link"></i></a><a href="#平衡二叉树（AVL树）" class="headerlink" title="平衡二叉树（AVL树）"></a>平衡二叉树（AVL树）</h2>
      <p>当数组【1,2,3,4,5,6,7,8】转换为二叉排序树的话会造成查找资源过大。那么这个时候可以引进平衡二叉树</p>
<p><strong>概述：左子树和右子树的高度差的绝对值不超过1</strong></p>
<p><strong><font color="red">左子树和右子树也需要是平衡二叉树</font></strong></p>
<p><img src="/2020/10/31/%E6%A0%91%E7%BB%93%E6%9E%84/balancedBinaryTree-one.png"></p>

        <h3 id="单旋转">
          <a href="#单旋转" class="heading-link"><i class="fas fa-link"></i></a><a href="#单旋转" class="headerlink" title="单旋转"></a>单旋转</h3>
      <p><strong>右旋转：</strong></p>
<p><img src="/2020/10/31/%E6%A0%91%E7%BB%93%E6%9E%84/turnright-one.png"></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> balancedBinaryTree;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Node</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> value;</span><br><span class="line"></span><br><span class="line">    Node left;</span><br><span class="line">    Node right;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Node</span><span class="params">(<span class="type">int</span> value)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">this</span>.value = value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取左子树的高度</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">leftHeight</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(left == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> left.height();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取右子树的高度</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">rightHeight</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(right == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> right.height();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 返回当前节点的高度</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">height</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Math.max(left==<span class="literal">null</span>?<span class="number">0</span>:left.height(),right == <span class="literal">null</span>?<span class="number">0</span>:right.height())+<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 二叉排序树添加节点</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> node</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(Node node)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//判断如果传入的节点为空直接返回</span></span><br><span class="line">        <span class="keyword">if</span>(node == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//判断传入的节点的值是否小于当前节点的值</span></span><br><span class="line">        <span class="keyword">if</span>(node.value&lt;<span class="built_in">this</span>.value)&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">this</span>.left == <span class="literal">null</span>)&#123;</span><br><span class="line"></span><br><span class="line">                <span class="built_in">this</span>.left = node;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="built_in">this</span>.left.add(node);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="comment">//判断传入的节点的值是否大于当前节点的值</span></span><br><span class="line">            <span class="keyword">if</span>(node.value&gt;<span class="built_in">this</span>.value)&#123;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span>(<span class="built_in">this</span>.right == <span class="literal">null</span>)&#123;</span><br><span class="line">                    <span class="built_in">this</span>.right = node;</span><br><span class="line">                &#125;<span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">                    <span class="built_in">this</span>.right.add(node);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//检查是否是平衡二叉树</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(leftHeight()-rightHeight()&gt;=<span class="number">2</span>)&#123;</span><br><span class="line">            <span class="comment">//进行右旋转</span></span><br><span class="line">            rightRotate();</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(leftHeight()-rightHeight()&lt;=-<span class="number">2</span>)&#123;</span><br><span class="line">            <span class="comment">//进行左旋转</span></span><br><span class="line">            leftRotate();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 左旋转</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">leftRotate</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">newLeft</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Node</span>(value);</span><br><span class="line">        newLeft.left = left;</span><br><span class="line">        newLeft.right = right.left;</span><br><span class="line">        value = right.value;</span><br><span class="line">        right = right.right;</span><br><span class="line">        left = newLeft;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 右旋转</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">rightRotate</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//创建一个新的节点，值等于当前节点的值</span></span><br><span class="line">        <span class="type">Node</span> <span class="variable">newRight</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Node</span>(value);</span><br><span class="line">        <span class="comment">//把新节点的右子树设置了当前节点的右子树</span></span><br><span class="line">        newRight.right = right;</span><br><span class="line">        <span class="comment">//把新节点的左子树设置为当前节点的左子树的右子树</span></span><br><span class="line">        newRight.left = left.right;</span><br><span class="line">        <span class="comment">//把当前节点的值换位左子节点的值</span></span><br><span class="line">        value = left.value;</span><br><span class="line">        <span class="comment">//把当前节点的左子树设置了左子树的左子树</span></span><br><span class="line">        left = left.left;</span><br><span class="line">        <span class="comment">//把当前节点的右子树设置为新节点</span></span><br><span class="line">        right = newRight;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> balancedBinaryTree;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">treeTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//右旋转测试</span></span><br><span class="line">       <span class="comment">/* int[] arrs = new int[]&#123;8,9,6,7,5,4&#125;;</span></span><br><span class="line"><span class="comment">        binarySTree bst = new binarySTree();</span></span><br><span class="line"><span class="comment">        //循环添加</span></span><br><span class="line"><span class="comment">        for(int i = 0;i&lt;arrs.length;i++)&#123;</span></span><br><span class="line"><span class="comment">            Node node = new Node(arrs[i]);</span></span><br><span class="line"><span class="comment">            bst.add(node);</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">        //查看高度</span></span><br><span class="line"><span class="comment">        System.out.println(bst.root.height());</span></span><br><span class="line"><span class="comment">        //查看根节点的值</span></span><br><span class="line"><span class="comment">        System.out.println(bst.root.value);</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">        <span class="comment">//左旋转测试</span></span><br><span class="line">        <span class="type">int</span>[] arrl = <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">2</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">6</span>&#125;;</span><br><span class="line">        <span class="type">binarySTree</span> <span class="variable">bstl</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">binarySTree</span>();</span><br><span class="line">        <span class="comment">//循环添加</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;i&lt;arrl.length;i++)&#123;</span><br><span class="line">            <span class="type">Node</span> <span class="variable">node</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Node</span>(arrl[i]);</span><br><span class="line">            bstl.add(node);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//查看高度</span></span><br><span class="line">        System.out.println(bstl.root.height());</span><br><span class="line">        <span class="comment">//查看根节点的值</span></span><br><span class="line">        System.out.println(bstl.root.value);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h3 id="双旋转">
          <a href="#双旋转" class="heading-link"><i class="fas fa-link"></i></a><a href="#双旋转" class="headerlink" title="双旋转"></a>双旋转</h3>
      <p><img src="/2020/10/31/%E6%A0%91%E7%BB%93%E6%9E%84/twiceRotate-one.png"></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> balancedBinaryTree;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Node</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> value;</span><br><span class="line"></span><br><span class="line">    Node left;</span><br><span class="line">    Node right;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Node</span><span class="params">(<span class="type">int</span> value)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">this</span>.value = value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取左子树的高度</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">leftHeight</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(left == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> left.height();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取右子树的高度</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">rightHeight</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(right == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> right.height();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 返回当前节点的高度</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">height</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Math.max(left==<span class="literal">null</span>?<span class="number">0</span>:left.height(),right == <span class="literal">null</span>?<span class="number">0</span>:right.height())+<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 二叉排序树添加节点</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> node</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(Node node)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//判断如果传入的节点为空直接返回</span></span><br><span class="line">        <span class="keyword">if</span>(node == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//判断传入的节点的值是否小于当前节点的值</span></span><br><span class="line">        <span class="keyword">if</span>(node.value&lt;<span class="built_in">this</span>.value)&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">this</span>.left == <span class="literal">null</span>)&#123;</span><br><span class="line"></span><br><span class="line">                <span class="built_in">this</span>.left = node;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="built_in">this</span>.left.add(node);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="comment">//判断传入的节点的值是否大于当前节点的值</span></span><br><span class="line">            <span class="keyword">if</span>(node.value&gt;<span class="built_in">this</span>.value)&#123;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span>(<span class="built_in">this</span>.right == <span class="literal">null</span>)&#123;</span><br><span class="line">                    <span class="built_in">this</span>.right = node;</span><br><span class="line">                &#125;<span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">                    <span class="built_in">this</span>.right.add(node);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//检查是否是平衡二叉树</span></span><br><span class="line">        <span class="comment">//进行右旋转</span></span><br><span class="line">        <span class="keyword">if</span>(leftHeight()-rightHeight()&gt;=<span class="number">2</span>)&#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//双旋转</span></span><br><span class="line">            <span class="keyword">if</span>(left!=<span class="literal">null</span>&amp;&amp;left.leftHeight()&lt;left.rightHeight())&#123;</span><br><span class="line">                <span class="comment">//先左旋转</span></span><br><span class="line">                left.leftRotate();</span><br><span class="line">                <span class="comment">//再右旋转</span></span><br><span class="line">                rightRotate();</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//单旋转</span></span><br><span class="line"></span><br><span class="line">                rightRotate();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(leftHeight()-rightHeight()&lt;=-<span class="number">2</span>)&#123;</span><br><span class="line">            <span class="comment">//进行左旋转</span></span><br><span class="line">            <span class="comment">//双旋转</span></span><br><span class="line">            <span class="keyword">if</span>(right!=<span class="literal">null</span>&amp;&amp;right.rightHeight()&lt;right.leftHeight())&#123;</span><br><span class="line">                right.rightRotate();</span><br><span class="line">                leftRotate();</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="comment">//单旋转</span></span><br><span class="line">                leftRotate();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 左旋转</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">leftRotate</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">newLeft</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Node</span>(value);</span><br><span class="line">        newLeft.left = left;</span><br><span class="line">        newLeft.right = right.left;</span><br><span class="line">        value = right.value;</span><br><span class="line">        right = right.right;</span><br><span class="line">        left = newLeft;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 右旋转</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">rightRotate</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//创建一个新的节点，值等于当前节点的值</span></span><br><span class="line">        <span class="type">Node</span> <span class="variable">newRight</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Node</span>(value);</span><br><span class="line">        <span class="comment">//把新节点的右子树设置了当前节点的右子树</span></span><br><span class="line">        newRight.right = right;</span><br><span class="line">        <span class="comment">//把新节点的左子树设置为当前节点的左子树的右子树</span></span><br><span class="line">        newRight.left = left.right;</span><br><span class="line">        <span class="comment">//把当前节点的值换位左子节点的值</span></span><br><span class="line">        value = left.value;</span><br><span class="line">        <span class="comment">//把当前节点的左子树设置了左子树的左子树</span></span><br><span class="line">        left = left.left;</span><br><span class="line">        <span class="comment">//把当前节点的右子树设置为新节点</span></span><br><span class="line">        right = newRight;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">   </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span>[] arrl = <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">8</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">7</span>&#125;;</span><br><span class="line"><span class="type">binarySTree</span> <span class="variable">bstl</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">binarySTree</span>();</span><br><span class="line"><span class="comment">//循环添加</span></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;i&lt;arrl.length;i++)&#123;</span><br><span class="line">	<span class="type">Node</span> <span class="variable">node</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Node</span>(arrl[i]);</span><br><span class="line">	bstl.add(node);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//查看高度</span></span><br><span class="line">System.out.println(bstl.root.height());</span><br><span class="line"><span class="comment">//查看根节点的值</span></span><br><span class="line">System.out.println(bstl.root.value);</span><br></pre></td></tr></table></div></figure>



        <h2 id="2-3树">
          <a href="#2-3树" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-3树" class="headerlink" title="2-3树"></a>2-3树</h2>
      <p><strong>B树中所有的叶节点都在同一层</strong></p>
<p><strong>有两个子节点的节点叫二节点（二节点要么有两个子节点，要么没有子节点）</strong></p>
<p><strong>有三个子节点的节点叫三节点（三节点要么有三个子节点，要么没有子节点）</strong></p>
<p><img src="/2020/10/31/%E6%A0%91%E7%BB%93%E6%9E%84/twothreeNode.png"></p>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2020/08/02/Spring-%E5%BC%82%E6%AD%A5%E7%BA%BF%E7%A8%8B%E6%B1%A0/">Spring 异步线程池</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2020-08-02</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">2022-05-21</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h2 id="异步实例">
          <a href="#异步实例" class="heading-link"><i class="fas fa-link"></i></a><a href="#异步实例" class="headerlink" title="异步实例"></a>异步实例</h2>
      <p><strong><font color="DarkBlue">为了满足运维人员的需求，往往需要生成报表交由后台线程操作，生成报表是另外一个线程的任务</font></strong></p>
<p><strong><font color="DarkKhaki">1. 使用Java配置定义线程池和启用异步</font></strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.rediscachetest.tools;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.scheduling.annotation.AsyncConfigurer;</span><br><span class="line"><span class="keyword">import</span> org.springframework.scheduling.annotation.EnableAsync;</span><br><span class="line"><span class="keyword">import</span> org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.Executor;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableAsync</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AsymcConfig</span> <span class="keyword">implements</span> <span class="title class_">AsyncConfigurer</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Executor <span class="title function_">getAsyncExecutor</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//定义线程池</span></span><br><span class="line">        <span class="type">ThreadPoolTaskExecutor</span> <span class="variable">taskExecutor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ThreadPoolTaskExecutor</span>();</span><br><span class="line">        <span class="comment">//核心线程数</span></span><br><span class="line">        taskExecutor.setCorePoolSize(<span class="number">10</span>);</span><br><span class="line">        <span class="comment">//线程池最大线程数</span></span><br><span class="line">        taskExecutor.setMaxPoolSize(<span class="number">30</span>);</span><br><span class="line">        <span class="comment">//线程队列最大线程数</span></span><br><span class="line">        taskExecutor.setQueueCapacity(<span class="number">2000</span>);</span><br><span class="line">        <span class="comment">//初始化</span></span><br><span class="line">        taskExecutor.initialize();</span><br><span class="line">        <span class="keyword">return</span> taskExecutor;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<blockquote>
<p>代码中，注解@EnableAsync代表开启Spring异步，这样就可以使用@Async驱动Spring使用异步。但是异步需要提供可用线程池，所以此配置类会哦实现AsyncConfigurer接口，然后重写getAsyncExecutor方法进行相关配置。</p>
</blockquote>
<p><strong><font color="DarkKhaki">2. 为了进行测试，定义一个service服务接口和其实现类</font></strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.rediscachetest.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">AsyncService</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">generateReport</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.rediscachetest.serviceImpl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.rediscachetest.service.AsyncService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.scheduling.annotation.Async;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AsyncServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">AsyncService</span> &#123;</span><br><span class="line">    <span class="meta">@Async</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">generateReport</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//打印异步线程名称</span></span><br><span class="line">        System.out.println(<span class="string">&quot;此线程名称：&quot;</span>+<span class="string">&quot;【&quot;</span>+Thread.currentThread().getName()+<span class="string">&quot;】&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p><strong><font color="DarkKhaki">3. 定义控制器</font></strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.rediscachetest.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.rediscachetest.service.AsyncService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/async&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">asyController</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">AsyncService</span> <span class="variable">asyncService</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/table&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">asyncPage</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;请求线程名称:&quot;</span>+<span class="string">&quot;【&quot;</span>+Thread.currentThread().getName()+<span class="string">&quot;】&quot;</span>);</span><br><span class="line">        <span class="comment">//调用异步服务</span></span><br><span class="line">        asyncService.generateReport();</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;async&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<blockquote>
<p>启动服务后，对asyncPage方法进行请求，会发现控制器的方法和异步方法的线程名称是不同的，说明它们是由不同的线程运行的</p>
</blockquote>
<p><img src="/2020/08/02/Spring-%E5%BC%82%E6%AD%A5%E7%BA%BF%E7%A8%8B%E6%B1%A0/QQ%E6%88%AA%E5%9B%BE20200803173132.png"></p>

        <h2 id="异步消息">
          <a href="#异步消息" class="heading-link"><i class="fas fa-link"></i></a><a href="#异步消息" class="headerlink" title="异步消息"></a>异步消息</h2>
      
        <h3 id="JMS实例-ActiveMQ">
          <a href="#JMS实例-ActiveMQ" class="heading-link"><i class="fas fa-link"></i></a><a href="#JMS实例-ActiveMQ" class="headerlink" title="JMS实例-ActiveMQ"></a><font color="Brown">JMS实例-ActiveMQ</font></h3>
      <p><strong>1. ActiveMQ的使用，首先在<span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="http://activemq.apache.org/download.html%E4%B8%8B%E8%BD%BDActiveMQ%E3%80%82%E7%84%B6%E5%90%8E%E8%BF%9B%E5%85%A5bin%E7%9B%AE%E5%BD%95%E4%B8%8B%E5%90%AF%E5%8A%A8activemq.bat(Windows%E7%B3%BB%E7%BB%9F).%E8%BF%90%E8%A1%8C%E4%B9%8B%E5%90%8E%EF%BC%8C%E6%89%93%E5%BC%80%E6%B5%8F%E8%A7%88%E5%99%A8%E8%AE%BF%E9%97%AEhttp://localhost:8161/admin/%EF%BC%8C%E4%BD%BF%E7%94%A8%E7%94%A8%E6%88%B7%E5%90%8Damdin%E5%92%8C%E5%AF%86%E7%A0%81admin%E7%99%BB%E5%BD%95%E6%88%90%E5%8A%9F%E5%90%8E%EF%BC%8C%E8%AF%B4%E6%98%8EActiveMQ%E5%B7%B2%E7%BB%8F%E5%90%AF%E5%8A%A8%E5%A5%BD%E4%BA%86">http://activemq.apache.org/download.html下载ActiveMQ。然后进入bin目录下启动activemq.bat(Windows系统).运行之后，打开浏览器访问http://localhost:8161/admin/，使用用户名amdin和密码admin登录成功后，说明ActiveMQ已经启动好了</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></strong></p>
<p><strong>2. 配置支持ActiveMQ的依赖</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">	&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">	&lt;artifactId&gt;spring-boot-starter-activemq&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">	&lt;groupId&gt;org.messaginghub&lt;/groupId&gt;</span><br><span class="line">	&lt;artifactId&gt;pooled-jms&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<blockquote>
<p>Spring Boot放弃了对自动配置的支持，activemq-pool而支持pooled-jms,所以第二项依赖配置的是pooled-jms。</p>
</blockquote>
<p><strong>3. 配置ActiveMQ和JMS信息</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># ActiveMQ地址</span><br><span class="line">spring.activemq.broker-url=tcp:<span class="comment">//localhost:61616</span></span><br><span class="line"># 用户名密码配置</span><br><span class="line">spring.activemq.user=admin</span><br><span class="line">spring.activemq.password=admin</span><br><span class="line"># 是否使用发布订阅模式默认为<span class="literal">false</span>，即点对点模式</span><br><span class="line">spring.jms.pub-sub-domain=<span class="literal">true</span></span><br><span class="line">#默认目的地址</span><br><span class="line">spring.jms.template.<span class="keyword">default</span>-destination=activemq.<span class="keyword">default</span>.destination</span><br><span class="line">#是否启用连接池</span><br><span class="line">spring.activemq.pool.enabled=<span class="literal">true</span></span><br><span class="line"># 连接池最大连接数量配置</span><br><span class="line">spring.activemq.pool.max-connections=<span class="number">50</span></span><br></pre></td></tr></table></div></figure>

<p>如果想要传递的消息是pojo对象，可配置其信任pojo包</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 配置ActiveMQ信任ServerUser类</span><br><span class="line">spring.activemq.packages.trusted=com.example.rediscachetest.pojo,java.<span class="type">long</span></span><br><span class="line">#若让ActiveMQ信任所有的包，可配置</span><br><span class="line">#spring.activemq.packages.trust-all=<span class="literal">true</span></span><br></pre></td></tr></table></div></figure>

<p><strong>4. 定义传递普通消息的服务接口和传递pojo类的服务接口</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.rediscachetest.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ActiveMQService</span> &#123;</span><br><span class="line">    <span class="comment">//发送消息</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendMsg</span><span class="params">(String msg)</span>;</span><br><span class="line">    <span class="comment">//接收消息</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">receiveMsg</span><span class="params">(String msg)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.rediscachetest.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.rediscachetest.pojo.ServerUser;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ActiveMQUserService</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//发送消息</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendMsg</span><span class="params">(ServerUser serverUser)</span>;</span><br><span class="line">        <span class="comment">//接收消息</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">receiveMsg</span><span class="params">(ServerUser serverUser)</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p><strong>5. 其实现类</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.rediscachetest.serviceImpl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.rediscachetest.service.ActiveMQService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.jms.annotation.JmsListener;</span><br><span class="line"><span class="keyword">import</span> org.springframework.jms.core.JmsTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ActivveMQServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">ActiveMQService</span> &#123;</span><br><span class="line">    <span class="comment">//注入由SpringBoot自动产生的jmsTemplate</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">JmsTemplate</span> <span class="variable">jmsTemplate</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendMsg</span><span class="params">(String msg)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;发送消息:【&quot;</span>+msg+<span class="string">&quot;】&quot;</span>);</span><br><span class="line">        jmsTemplate.convertAndSend(msg);</span><br><span class="line">        <span class="comment">//自定义发送地址，因为配置中默认了地址所以可不写</span></span><br><span class="line">        <span class="comment">//jmsTemplate.convertAndSend(&quot;your-destination&quot;,msg);</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//使用注解，监听地址发送过来的消息</span></span><br><span class="line">    <span class="meta">@JmsListener(destination = &quot;$&#123;spring.jms.template.default-destination&#125;&quot;)</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">receiveMsg</span><span class="params">(String msg)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;接受到消息:【&quot;</span>+msg+<span class="string">&quot;】&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.rediscachetest.serviceImpl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.rediscachetest.pojo.ServerUser;</span><br><span class="line"><span class="keyword">import</span> com.example.rediscachetest.service.ActiveMQUserService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.jms.annotation.JmsListener;</span><br><span class="line"><span class="keyword">import</span> org.springframework.jms.core.JmsTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ActiveMQUserServviceImpl</span> <span class="keyword">implements</span> <span class="title class_">ActiveMQUserService</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">JmsTemplate</span> <span class="variable">jmsTemplate</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="comment">//自定义地址</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">myDestination</span> <span class="operator">=</span>  <span class="string">&quot;my-destination&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendMsg</span><span class="params">(ServerUser serverUser)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;发送消息:【&quot;</span>+serverUser+<span class="string">&quot;】&quot;</span>);</span><br><span class="line">        jmsTemplate.convertAndSend(myDestination,serverUser);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="comment">//监控自定义地址</span></span><br><span class="line">    <span class="meta">@JmsListener(destination = myDestination)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">receiveMsg</span><span class="params">(ServerUser serverUser)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;接收到消息:【&quot;</span>+serverUser+<span class="string">&quot;】&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<blockquote>
<p>实现类的发送地址既可以自定义，也可以默认使用application.properties文件中配置的地址。监控自定义地址和发送消息时的地址是一致的。如果使用的是默认的地址，那么只需要写成在application.properties中配置的地址的名称就可以了</p>
</blockquote>
<blockquote>
<p>POJO类必须是可以序列化的，因此必须继承Serializable。</p>
</blockquote>
<blockquote>
<p>由于POJO类的ID属性是Long类型的。所以在配置信任的包时也需要加上Java.Long的包</p>
</blockquote>
<p><strong>6. 控制器测试</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.example.rediscachetest.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.rediscachetest.pojo.ServerUser;</span><br><span class="line"><span class="keyword">import</span> com.example.rediscachetest.service.ActiveMQService;</span><br><span class="line"><span class="keyword">import</span> com.example.rediscachetest.service.ActiveMQUserService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ResponseBody;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/activemq&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">activemqController</span> &#123;</span><br><span class="line">    <span class="comment">//注入服务对象</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">ActiveMQService</span> <span class="variable">activeMQService</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">ActiveMQUserService</span> <span class="variable">activeMQUserService</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="comment">//测试普通消息的发送</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/msg&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">msg</span><span class="params">(String message)</span>&#123;</span><br><span class="line"></span><br><span class="line">        Map&lt;String,Object&gt; msgMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        msgMap.put(<span class="string">&quot;success&quot;</span>,<span class="literal">true</span>);</span><br><span class="line">        msgMap.put(<span class="string">&quot;message&quot;</span>,message);</span><br><span class="line">        activeMQService.sendMsg(message);</span><br><span class="line">        <span class="keyword">return</span>  msgMap;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//测试ServerUser对象的发送</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/usermsg&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">userMsg</span><span class="params">(Long id,String userName,String note)</span>&#123;</span><br><span class="line"></span><br><span class="line">        Map&lt;String,Object&gt; msgMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="type">ServerUser</span> <span class="variable">serUser</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServerUser</span>();</span><br><span class="line">        serUser.setId(id);</span><br><span class="line">        serUser.setName(userName);</span><br><span class="line">        serUser.setRemark(note);</span><br><span class="line">        msgMap.put(<span class="string">&quot;success&quot;</span>,<span class="literal">true</span>);</span><br><span class="line">        msgMap.put(<span class="string">&quot;sUser&quot;</span>,serUser);</span><br><span class="line">        activeMQUserService.sendMsg(serUser);</span><br><span class="line">        <span class="keyword">return</span>  msgMap;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p>最终效果:</p>
<p><img src="/2020/08/02/Spring-%E5%BC%82%E6%AD%A5%E7%BA%BF%E7%A8%8B%E6%B1%A0/QQ%E6%88%AA%E5%9B%BE20200803203953.png"></p>
<p><img src="/2020/08/02/Spring-%E5%BC%82%E6%AD%A5%E7%BA%BF%E7%A8%8B%E6%B1%A0/QQ%E6%88%AA%E5%9B%BE20200803204028.png"></p>

        <h2 id="定时任务">
          <a href="#定时任务" class="heading-link"><i class="fas fa-link"></i></a><a href="#定时任务" class="headerlink" title="定时任务"></a>定时任务</h2>
      <p><strong><font color="Brown">Spring中使用定时器，首先要在配置文件中加入@EnableScheduling，就能够使用注解驱动定时任务的机制。然后可以通过注解@Scheduled去配置如何定时。下面首先加入Spring Boot启动类标注@EnableScheduling。再开发服务类</font></strong></p>
<p><strong>1. 简易定时任务服务类</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.rediscachetest.serviceImpl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.scheduling.annotation.Async;</span><br><span class="line"><span class="keyword">import</span> org.springframework.scheduling.annotation.Scheduled;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ScheduleServiceImpl</span> &#123;</span><br><span class="line">    <span class="comment">//计数器</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">count1</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">count2</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// 每隔一秒执行一次</span></span><br><span class="line">    <span class="meta">@Scheduled(fixedRate = 1000)</span></span><br><span class="line">    <span class="comment">//使用异步执行</span></span><br><span class="line">    <span class="meta">@Async</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">job1</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;【&quot;</span>+Thread.currentThread().getName()+<span class="string">&quot;】，【job1】每一秒钟执行一次，执行第&quot;</span>+count1+<span class="string">&quot;次&quot;</span>);</span><br><span class="line">        count1++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Scheduled(fixedRate = 1000)</span></span><br><span class="line">    <span class="meta">@Async</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">job2</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;【&quot;</span>+Thread.currentThread().getName()+<span class="string">&quot;】，【job2】每一秒钟执行一次，执行第&quot;</span>+count2+<span class="string">&quot;次&quot;</span>);</span><br><span class="line">        count2++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<blockquote>
<p>使用@Async注解代表这需要使用异步线程执行，异步配置参考上一节。</p>
</blockquote>
<p><strong>2. 启动后效果如图</strong></p>
<p><img src="/2020/08/02/Spring-%E5%BC%82%E6%AD%A5%E7%BA%BF%E7%A8%8B%E6%B1%A0/QQ%E6%88%AA%E5%9B%BE20200805181440.png"></p>
<blockquote>
<p>这说明Spring每秒钟都会运行这个标注了@Scheduled的方法，并且是在不同的线程之间运行。</p>
</blockquote>
<p>如果需要指定为更具体的某一时间，则可用表达式来完成。</p>

        <h2 id="WebSocket应用">
          <a href="#WebSocket应用" class="heading-link"><i class="fas fa-link"></i></a><a href="#WebSocket应用" class="headerlink" title="WebSocket应用"></a>WebSocket应用</h2>
      <p><strong>1. 加入依赖</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">	&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">	&lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">	&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">	&lt;artifactId&gt;spring-boot-starter-websocket&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></div></figure>

<p><strong>2. 自定义WebScoket服务端点配置</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.rediscachetest.tools;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.socket.server.standard.ServerEndpointExporter;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebSocketConfig</span> &#123;</span><br><span class="line">    <span class="comment">//创建服务器端点</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> ServerEndpointExporter <span class="title function_">serverEndpointExporter</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ServerEndpointExporter</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<blockquote>
<p>有了这个Bean，就可以使用@ServerEndpoint定义一个端点服务类，在这个服务类中，可以定义WebSocket的打开，关闭，错误和发送消息的方法。</p>
</blockquote>
<p><strong>3. 定义WebSocket服务端站点</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.rediscachetest.serviceImpl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.websocket.*;</span><br><span class="line"><span class="keyword">import</span> javax.websocket.server.ServerEndpoint;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.CopyOnWriteArraySet;</span><br><span class="line"></span><br><span class="line"><span class="meta">@ServerEndpoint(&quot;/ws&quot;)</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebSocketServiceImpl</span> &#123;</span><br><span class="line">    <span class="comment">// 静态变量 用来记录当前在线连接数，且应该是线程安全的</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">onlineCount</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// concurrent包的线程安全Set，用来存放每个客户端对应的WebSocketServiceImpl对象</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> CopyOnWriteArraySet&lt;WebSocketServiceImpl&gt; webSocketSet = <span class="keyword">new</span> <span class="title class_">CopyOnWriteArraySet</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//与某个客户端的连接回话，需要通过它来给客户端发送数据</span></span><br><span class="line">    <span class="keyword">private</span> Session session;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 连接建立成功调用的方法</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@OnOpen</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onOpen</span><span class="params">(Session session)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.session = session;</span><br><span class="line">        webSocketSet.add(<span class="built_in">this</span>);</span><br><span class="line">        addOnlineCount();</span><br><span class="line">        System.out.println(<span class="string">&quot;有新的连接加入!当前在线人数为:&quot;</span>+getOnlineCount());</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            sendMessage(<span class="string">&quot;有新的连接加入了!&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;IO异常&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 连接关闭</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@OnClose</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClose</span><span class="params">()</span>&#123;</span><br><span class="line">        webSocketSet.remove(<span class="built_in">this</span>);</span><br><span class="line">        subOnlineCount();</span><br><span class="line">        System.out.println(<span class="string">&quot;有一连接关闭！当前在线人数为:&quot;</span>+getOnlineCount());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 收到客户端消息后调用的方法</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@OnMessage</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onMessage</span><span class="params">(String message,Session session)</span>&#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;来自客户端的消息:&quot;</span>+message);</span><br><span class="line">        <span class="comment">//群发消息</span></span><br><span class="line">        <span class="keyword">for</span>(WebSocketServiceImpl item:webSocketSet)&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                item.sendMessage(message);</span><br><span class="line">            &#125;<span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 发生错误时调用</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@OnError</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onError</span><span class="params">(Session session,Throwable error)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;发生错误！&quot;</span>);</span><br><span class="line">        error.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 发送消息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> message 客户端消息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">sendMessage</span><span class="params">(String message)</span> <span class="keyword">throws</span> IOException&#123;</span><br><span class="line">        <span class="built_in">this</span>.session.getBasicRemote().sendText(message);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//返回在线数</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> <span class="type">int</span> <span class="title function_">getOnlineCount</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> onlineCount;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//当连接人数增加时</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">addOnlineCount</span><span class="params">()</span>&#123;</span><br><span class="line">        WebSocketServiceImpl.onlineCount++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//当连接人数减少时</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">subOnlineCount</span><span class="params">()</span>&#123;</span><br><span class="line">        WebSocketServiceImpl.onlineCount--;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<blockquote>
<p>因为每一个客户端打开时，都会为其创建一个WebSocketServiceImpl对象，所以这里的打开方法中都会计数并且将这个对象保存到Set集合中。这样就可以知道拥有多少条连接。对于消息发送的方法，则是通过遍历对所有客户端的连接都给予发送消息，所以所有的连接都可以接收这个消息。如果只需要发送特定用户，则需要得到用户的信息再发送。</p>
</blockquote>
<p><strong>4. 页面开发</strong></p>
<figure class="highlight jsp"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page pageEncoding=<span class="string">&quot;utf-8&quot;</span>%&gt;</span><br><span class="line">&lt;%@ taglib prefix=<span class="string">&quot;c&quot;</span> uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span>%&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;验证用户&lt;/title&gt;</span><br><span class="line">    &lt;<span class="type">script</span> <span class="variable">src</span> <span class="operator">=</span> <span class="string">&quot;https://code.jquery.com/jquery-3.0.0.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    测试WebSocket站点</span><br><span class="line">&lt;br/&gt;</span><br><span class="line">    &lt;input type=<span class="string">&quot;text&quot;</span> id = <span class="string">&quot;message&quot;</span>/&gt;</span><br><span class="line">    &lt;<span class="type">button</span> <span class="variable">onclick</span> <span class="operator">=</span> <span class="string">&quot;sendMessage()&quot;</span>&gt;发送消息&lt;/button&gt;</span><br><span class="line">    &lt;button onclick=<span class="string">&quot;closeWebSocket()&quot;</span>&gt;关闭WebScoket连接&lt;/button&gt;</span><br><span class="line">    &lt;<span class="type">div</span> <span class="variable">id</span> <span class="operator">=</span> <span class="string">&quot;context&quot;</span>&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;script type=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">    <span class="type">var</span> <span class="variable">webSocket</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="comment">// 判断当前浏览器是否支持WebSocket</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="string">&#x27;WebSocket&#x27;</span> in window)&#123;</span><br><span class="line">        <span class="comment">//创建WebSocket对象，连接服务端点</span></span><br><span class="line">        webSocket = <span class="keyword">new</span> <span class="title class_">WebSocket</span>(<span class="string">&quot;ws://localhost:8080/ws&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        alert(<span class="string">&quot;不支持WebSocket&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//连接发生错误回调</span></span><br><span class="line">    webSocket.onerror = function()&#123;</span><br><span class="line">        appendMessage(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//连接成功回调</span></span><br><span class="line">    webSocket.onopen = function(event)&#123;</span><br><span class="line">        appendMessage(<span class="string">&quot;open&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//接收到消息回调</span></span><br><span class="line">    webSocket.onmessage = function(event)&#123;</span><br><span class="line">        appendMessage(event.data);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//连接关闭回调方法</span></span><br><span class="line">    webSocket.onclose = function()&#123;</span><br><span class="line">        appendMessage(<span class="string">&quot;close&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//监听窗口关闭时间，当窗口关闭时，主动关闭websocket连接</span></span><br><span class="line">    <span class="comment">//防止连接还没断开就关闭窗口导致server端发生异常</span></span><br><span class="line"></span><br><span class="line">    window.onbeforeunload = function()&#123;</span><br><span class="line">        webSocket.close();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//将消息显示在网页上</span></span><br><span class="line">    function <span class="title function_">appendMessage</span><span class="params">(message)</span>&#123;</span><br><span class="line">        <span class="type">var</span> <span class="variable">context</span> <span class="operator">=</span> $(<span class="string">&quot;#context&quot;</span>).html()+<span class="string">&quot;&lt;br/&gt;&quot;</span>+message;</span><br><span class="line">        $(<span class="string">&quot;#context&quot;</span>).html(context);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//关闭连接</span></span><br><span class="line">    function <span class="title function_">closeWebSocket</span><span class="params">()</span>&#123;</span><br><span class="line">        webSocket.close();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//发送消息</span></span><br><span class="line">    function <span class="title function_">sendMessage</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">var</span> <span class="variable">message</span> <span class="operator">=</span> $(<span class="string">&quot;#message&quot;</span>).val();</span><br><span class="line">        webSocket.send(message);</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p><strong>5. 通过控制器访问页面</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.rediscachetest.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/webs&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">websocketController</span> &#123;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/sockets&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">messagePage</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;user/websocket&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h3 id="使用Stomp">
          <a href="#使用Stomp" class="heading-link"><i class="fas fa-link"></i></a><a href="#使用Stomp" class="headerlink" title="使用Stomp"></a>使用Stomp</h3>
      <p><font color="#A52A2A">并不是所有的浏览器都能够支持WebSocket协议，为了使得WebSocket的应用能够兼容那些不支持的浏览器，可以使用Stomp协议进行处理</font></p>
<p><strong>1. 在配置文件中加入注解@EnableWebSocketMessageBroker，此注解会启动WebSocket下的子协议STOMP、为了配置这个协议，可以实现接口WebSocketMessageBrokerConfigurer</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.rediscachetest.tools;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> ...</span><br><span class="line"><span class="meta">@EnableWebSocketMessageBroker</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebSocketConfig</span> <span class="keyword">implements</span> <span class="title class_">WebSocketMessageBrokerConfigurer</span> &#123;</span><br><span class="line">    <span class="comment">//创建服务器端点</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> ServerEndpointExporter <span class="title function_">serverEndpointExporter</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ServerEndpointExporter</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">registerStompEndpoints</span><span class="params">(StompEndpointRegistry registry)</span>&#123;</span><br><span class="line">        <span class="comment">// 增加一个聊天服务端点（任何用户都会收到消息）</span></span><br><span class="line">        registry.addEndpoint(<span class="string">&quot;/socket&quot;</span>).withSockJS();</span><br><span class="line">        <span class="comment">//增加一个用户端点服务（特定用户才会受到消息）</span></span><br><span class="line">        registry.addEndpoint(<span class="string">&quot;/wsuser&quot;</span>).withSockJS();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">configureMessageBroker</span><span class="params">(MessageBrokerRegistry registry)</span>&#123;</span><br><span class="line">        <span class="comment">//客户端订阅路径前缀</span></span><br><span class="line">        registry.enableSimpleBroker(<span class="string">&quot;/sub&quot;</span>,<span class="string">&quot;/queue&quot;</span>);</span><br><span class="line">        <span class="comment">//服务端点请求前缀</span></span><br><span class="line">        registry.setApplicationDestinationPrefixes(<span class="string">&quot;/request&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<blockquote>
<p><b><font color="#D2691E">registerStompEndpoints()方法中定义了两个服务端点，还加入了withSockJS方法，代表支持SockJS这种第三方支持WebSocket请求的JavaScript1框架。</font></b></p>
</blockquote>
<blockquote>
<p><b><font color="#D2691E">configureMessageBroker()方法注册请求的前缀和客户端订阅的前缀</font></b></p>
</blockquote>
<p><strong>2. Stomp下的控制器</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.rediscachetest.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> ...</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.security.Principal;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/websocket&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">websocketController</span> &#123;</span><br><span class="line">    <span class="comment">/*@GetMapping(&quot;/sockets&quot;)</span></span><br><span class="line"><span class="comment">    public String messagePage()&#123;</span></span><br><span class="line"><span class="comment">        return &quot;user/websocket&quot;;</span></span><br><span class="line"><span class="comment">    &#125;*/</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">SimpMessagingTemplate</span> <span class="variable">simpMessagingTemplate</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//发送页面</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/send&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">send</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;web/send&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//接收页面</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/receive&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">receive</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;web/receive&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//对特定用户的发送页面</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/sendUser&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">sendUser</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;web/send-user&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//特定用户接收页面</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/receiveUser&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">reveiveUser</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;web/receive-user&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//定义消息请求路径</span></span><br><span class="line">    <span class="meta">@MessageMapping(&quot;/send&quot;)</span></span><br><span class="line">    <span class="comment">//定义结果发送到特定路径</span></span><br><span class="line">    <span class="meta">@SendTo(&quot;/sub/chat&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">sendMsg</span><span class="params">(String value)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//将消息发送给特定用户</span></span><br><span class="line">    <span class="meta">@MessageMapping(&quot;/sendUser&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendToUser</span><span class="params">(Principal principal,String body)</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">srcUser</span> <span class="operator">=</span> principal.getName();</span><br><span class="line">        <span class="comment">//解析用户和小熊</span></span><br><span class="line">        String[] args = body.split(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">desUser</span> <span class="operator">=</span> args[<span class="number">0</span>];</span><br><span class="line">        <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> <span class="string">&quot;【&quot;</span>+srcUser+<span class="string">&quot;】给你发来消息:&quot;</span>+args[<span class="number">1</span>];</span><br><span class="line">        <span class="comment">//发送到用户和监听地址</span></span><br><span class="line">        simpMessagingTemplate.convertAndSendToUser(desUser,<span class="string">&quot;/queue/customer&quot;</span>,message);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<blockquote>
<p><b><font color="#D2691E">此处的send，receive，sendUser，reveiveUser方法都是定义了Spring MVC的视图，这样就可以指向4个jsp视图。 sendMsg和sendToUser方法都标注了@MessageMapping，和@RequestMapping类似，它是定义WebSocket请求的路径，当然需要与WebSocketConfig所定义的前缀(“&#x2F;request”)连用。</font></b></p>
</blockquote>
<blockquote>
<p><b><font color="#D2691E">sendMsg方法，它还会标注@SendTo注解，然后配置为”&#x2F;sub&#x2F;chat“，说明在执行完这个方法后，会将返回结果发送到订阅的这个目的地中，这样客户端就可以得到消息。sendToUser方法，这个方法存在Principal参数，如果你使用了SpringSecurit，这个参数就可以回去当前用户的消息，然后通过SimpMessagingTemplate的convertAndSendToUser方法，就可以设置发送给对应的目的地并且限定特定的用户消息。</font></b></p>
</blockquote>
<p><strong>3. 开启SpringSecurity认证过</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.rediscachetest.tools;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> ...</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.sql.DataSource;</span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">securityConf</span>  <span class="keyword">extends</span> <span class="title class_">WebSecurityConfigurerAdapter</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">configure</span><span class="params">(AuthenticationManagerBuilder auth)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//定义3个可以登录的内存用户</span></span><br><span class="line"></span><br><span class="line">        <span class="type">PasswordEncoder</span> <span class="variable">passwordEncoder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BCryptPasswordEncoder</span>();</span><br><span class="line">        <span class="comment">//加入三个内存用户  密码分别为加密后的p1，p2，p3</span></span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">pass1</span> <span class="operator">=</span> passwordEncoder.encode(<span class="string">&quot;p1&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">pass2</span> <span class="operator">=</span> passwordEncoder.encode(<span class="string">&quot;p2&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">pass3</span> <span class="operator">=</span> passwordEncoder.encode(<span class="string">&quot;p3&quot;</span>);</span><br><span class="line"></span><br><span class="line">        auth.inMemoryAuthentication().passwordEncoder(passwordEncoder)</span><br><span class="line">                .withUser(<span class="string">&quot;user1&quot;</span>)</span><br><span class="line">                .password(pass1)</span><br><span class="line">                .roles(<span class="string">&quot;USER&quot;</span>).and().withUser(<span class="string">&quot;user2&quot;</span>)</span><br><span class="line">                .password(pass2)</span><br><span class="line">                .roles(<span class="string">&quot;ADMIN&quot;</span>).and().withUser(<span class="string">&quot;user3&quot;</span>)</span><br><span class="line">                .password(pass3)</span><br><span class="line">                .roles(<span class="string">&quot;USER&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<blockquote>
<p>定义三个可以登录的用户</p>
</blockquote>
<p><strong>4. 发送WebSocket请求的客户端页面</strong></p>
<figure class="highlight jsp"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page pageEncoding=<span class="string">&quot;utf-8&quot;</span>%&gt;</span><br><span class="line">&lt;%@ taglib prefix=<span class="string">&quot;c&quot;</span> uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span>%&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;stomp&lt;/title&gt;</span><br><span class="line">    &lt;script type=<span class="string">&quot;text/javascript&quot;</span> src = <span class="string">&quot;https://code.jquery.com/jquery-3.0.0.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script type=<span class="string">&quot;text/javascript&quot;</span>  src = <span class="string">&quot;https://cdn.jsdelivr.net/sockjs/1/sockjs.min.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">    &lt;<span class="type">script</span> <span class="variable">type</span> <span class="operator">=</span> <span class="string">&quot;text/javascript&quot;</span> src = <span class="string">&quot;../../js/stomp.min.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;div&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;<span class="type">button</span> <span class="variable">id</span> <span class="operator">=</span> <span class="string">&quot;connect&quot;</span> onclick = <span class="string">&quot;connect()&quot;</span>&gt;连接&lt;/button&gt;</span><br><span class="line">        &lt;<span class="type">button</span> <span class="variable">id</span> <span class="operator">=</span> <span class="string">&quot;disconnect&quot;</span> disabled = <span class="string">&quot;disabled&quot;</span> onclick = <span class="string">&quot;disconnect()&quot;</span>&gt;断开连接&lt;/button&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;<span class="type">div</span> <span class="variable">id</span> <span class="operator">=</span> <span class="string">&quot;convertsationDiv&quot;</span>&gt;</span><br><span class="line">        &lt;p&gt;</span><br><span class="line">            &lt;label&gt;发送的内容&lt;/label&gt;</span><br><span class="line">        &lt;/p&gt;</span><br><span class="line">        &lt;p&gt;</span><br><span class="line">            &lt;<span class="type">textarea</span> <span class="variable">id</span> <span class="operator">=</span> <span class="string">&quot;message&quot;</span> rows = <span class="string">&quot;5&quot;</span>&gt;&lt;/textarea&gt;</span><br><span class="line">        &lt;/p&gt;</span><br><span class="line">        &lt;<span class="type">button</span> <span class="variable">id</span> <span class="operator">=</span> <span class="string">&quot;sendMsg&quot;</span> onclick=<span class="string">&quot;sendMsg()&quot;</span>&gt;Send&lt;/button&gt;</span><br><span class="line">        &lt;<span class="type">p</span> <span class="variable">id</span> <span class="operator">=</span> <span class="string">&quot;response&quot;</span>&gt;&lt;/p&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;script type=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">    <span class="type">var</span> <span class="variable">stompClient</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//设置连接</span></span><br><span class="line"></span><br><span class="line">    function <span class="title function_">setConnected</span><span class="params">(connected)</span>&#123;</span><br><span class="line"></span><br><span class="line">        $(<span class="string">&quot;#connect&quot;</span>).attr(&#123;<span class="string">&quot;disabled&quot;</span>:connected&#125;);</span><br><span class="line"></span><br><span class="line">        $(<span class="string">&quot;#disconnect&quot;</span>).attr(&#123;<span class="string">&quot;disabled&quot;</span>:!connected&#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(connected)&#123;</span><br><span class="line">            $(<span class="string">&quot;#convertsationDiv&quot;</span>).show();</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            $(<span class="string">&quot;#convertsationDiv&quot;</span>).hide();</span><br><span class="line">        &#125;</span><br><span class="line">        $(<span class="string">&quot;#response&quot;</span>).html(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//开启socket连接</span></span><br><span class="line">    function <span class="title function_">connect</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//定义请求服务器的端点</span></span><br><span class="line">        <span class="type">var</span> <span class="variable">socket</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SockJS</span>(<span class="string">&quot;/socket&quot;</span>);</span><br><span class="line">        <span class="comment">//stomp客户端</span></span><br><span class="line">        stompClient = Stomp.over(socket);</span><br><span class="line">        <span class="comment">//连接服务器端点、</span></span><br><span class="line">        stompClient.connect(&#123;&#125;,function(frame)&#123;</span><br><span class="line">            <span class="comment">//建立连接后的回调</span></span><br><span class="line">            setConnected(<span class="literal">true</span>);</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//断开socket连接</span></span><br><span class="line">    function <span class="title function_">disconnect</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(stompClient = <span class="literal">null</span>)&#123;</span><br><span class="line">            stompClient.disconnect();</span><br><span class="line">        &#125;</span><br><span class="line">        setConnected(<span class="literal">false</span>);</span><br><span class="line">        Console.log(<span class="string">&quot;Disconnected&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//向/request/send服务端发送消息</span></span><br><span class="line">    function <span class="title function_">sendMsg</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">var</span> <span class="variable">value</span> <span class="operator">=</span> $(<span class="string">&quot;#message&quot;</span>).val();</span><br><span class="line">        <span class="comment">//发送消息到/request/send，其中/request是服务器定义的前缀</span></span><br><span class="line">        <span class="comment">// 而/send则是@MessageMapping所配置的路径</span></span><br><span class="line">        stompClient.send(<span class="string">&quot;/request/send&quot;</span>,&#123;&#125;,value);</span><br><span class="line">    &#125;</span><br><span class="line">    connect();</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p>客户端订阅消息</p>
<figure class="highlight jsp"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page pageEncoding=<span class="string">&quot;utf-8&quot;</span>%&gt;</span><br><span class="line">&lt;%@ taglib prefix=<span class="string">&quot;c&quot;</span> uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span>%&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;stomp&lt;/title&gt;</span><br><span class="line">    &lt;script type=<span class="string">&quot;text/javascript&quot;</span> src = <span class="string">&quot;https://code.jquery.com/jquery-3.0.0.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script type=<span class="string">&quot;text/javascript&quot;</span>  src = <span class="string">&quot;https://cdn.jsdelivr.net/sockjs/1/sockjs.min.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">    &lt;<span class="type">script</span> <span class="variable">type</span> <span class="operator">=</span> <span class="string">&quot;text/javascript&quot;</span> src = <span class="string">&quot;../../js/stomp.min.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;h1&gt;</span><br><span class="line">    &lt;<span class="type">span</span> <span class="variable">id</span> <span class="operator">=</span> <span class="string">&quot;receive&quot;</span>&gt;等待消息接收&lt;/span&gt;</span><br><span class="line"></span><br><span class="line">&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;script type=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="type">var</span> <span class="variable">noticeSocket</span> <span class="operator">=</span> function()&#123;</span><br><span class="line">    <span class="comment">//连接服务端点</span></span><br><span class="line">    <span class="type">var</span> <span class="variable">s</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SockJS</span>(<span class="string">&quot;/socket&quot;</span>);</span><br><span class="line">    <span class="comment">//客户端</span></span><br><span class="line">    <span class="type">var</span> <span class="variable">stompClient</span> <span class="operator">=</span> Stomp.over(s);</span><br><span class="line">    stompClient.connect(&#123;&#125;,function()&#123;</span><br><span class="line">        console.log(<span class="string">&quot;notice socket connected!&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//订阅消息地址</span></span><br><span class="line">        stompClient.subscribe(<span class="string">&quot;/sub/chat&quot;</span>,function(data)&#123;</span><br><span class="line">            $(<span class="string">&#x27;#receive&#x27;</span>).html(data.body);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line">    noticeSocket();</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p><strong>5. 发送用户消息页面</strong></p>
<figure class="highlight jsp"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page pageEncoding=<span class="string">&quot;utf-8&quot;</span>%&gt;</span><br><span class="line">&lt;%@ taglib prefix=<span class="string">&quot;c&quot;</span> uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span>%&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;stomp&lt;/title&gt;</span><br><span class="line">    &lt;script type=<span class="string">&quot;text/javascript&quot;</span> src = <span class="string">&quot;https://code.jquery.com/jquery-3.0.0.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script type=<span class="string">&quot;text/javascript&quot;</span>  src = <span class="string">&quot;https://cdn.jsdelivr.net/sockjs/1/sockjs.min.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">    &lt;<span class="type">script</span> <span class="variable">type</span> <span class="operator">=</span> <span class="string">&quot;text/javascript&quot;</span> src = <span class="string">&quot;../../js/stomp.min.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;div&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;<span class="type">button</span> <span class="variable">id</span> <span class="operator">=</span> <span class="string">&quot;connect&quot;</span> onclick = <span class="string">&quot;connect()&quot;</span>&gt;连接&lt;/button&gt;</span><br><span class="line">        &lt;<span class="type">button</span> <span class="variable">id</span> <span class="operator">=</span> <span class="string">&quot;disconnect&quot;</span> disabled = <span class="string">&quot;disabled&quot;</span> onclick = <span class="string">&quot;disconnect()&quot;</span>&gt;断开连接&lt;/button&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;<span class="type">div</span> <span class="variable">id</span> <span class="operator">=</span> <span class="string">&quot;convertsationDiv&quot;</span>&gt;</span><br><span class="line">        &lt;p&gt;</span><br><span class="line">            &lt;label&gt;发送给用户&lt;/label&gt;</span><br><span class="line"></span><br><span class="line">        &lt;/p&gt;</span><br><span class="line"></span><br><span class="line">        &lt;p&gt;</span><br><span class="line">            &lt;input type=<span class="string">&quot;text&quot;</span> id = <span class="string">&quot;user&quot;</span>/&gt;</span><br><span class="line"></span><br><span class="line">        &lt;/p&gt;</span><br><span class="line"></span><br><span class="line">        &lt;p&gt;</span><br><span class="line">            &lt;label&gt;发送的内容&lt;/label&gt;</span><br><span class="line">        &lt;/p&gt;</span><br><span class="line">        &lt;p&gt;</span><br><span class="line">            &lt;<span class="type">textarea</span> <span class="variable">id</span> <span class="operator">=</span> <span class="string">&quot;message&quot;</span> rows = <span class="string">&quot;5&quot;</span>&gt;&lt;/textarea&gt;</span><br><span class="line">        &lt;/p&gt;</span><br><span class="line">        &lt;<span class="type">button</span> <span class="variable">id</span> <span class="operator">=</span> <span class="string">&quot;sendMsg&quot;</span> onclick=<span class="string">&quot;sendMsg()&quot;</span>&gt;Send&lt;/button&gt;</span><br><span class="line">        &lt;<span class="type">p</span> <span class="variable">id</span> <span class="operator">=</span> <span class="string">&quot;response&quot;</span>&gt;&lt;/p&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;script type=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">    <span class="type">var</span> <span class="variable">stompClient</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//设置连接</span></span><br><span class="line"></span><br><span class="line">    function <span class="title function_">setConnected</span><span class="params">(connected)</span>&#123;</span><br><span class="line"></span><br><span class="line">        $(<span class="string">&quot;#connect&quot;</span>).attr(&#123;<span class="string">&quot;disabled&quot;</span>:connected&#125;);</span><br><span class="line"></span><br><span class="line">        $(<span class="string">&quot;#disconnect&quot;</span>).attr(&#123;<span class="string">&quot;disabled&quot;</span>:!connected&#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(connected)&#123;</span><br><span class="line">            $(<span class="string">&quot;#convertsationDiv&quot;</span>).show();</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            $(<span class="string">&quot;#convertsationDiv&quot;</span>).hide();</span><br><span class="line">        &#125;</span><br><span class="line">        $(<span class="string">&quot;#response&quot;</span>).html(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//开启socket连接</span></span><br><span class="line">    function <span class="title function_">connect</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//定义请求服务器的端点</span></span><br><span class="line">        <span class="type">var</span> <span class="variable">socket</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SockJS</span>(<span class="string">&quot;/wsuser&quot;</span>);</span><br><span class="line">        <span class="comment">//stomp客户端</span></span><br><span class="line">        stompClient = Stomp.over(socket);</span><br><span class="line">        <span class="comment">//连接服务器端点、</span></span><br><span class="line">        stompClient.connect(&#123;&#125;,function(frame)&#123;</span><br><span class="line">            <span class="comment">//建立连接后的回调</span></span><br><span class="line">            setConnected(<span class="literal">true</span>);</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//断开socket连接</span></span><br><span class="line">    function <span class="title function_">disconnect</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(stompClient = <span class="literal">null</span>)&#123;</span><br><span class="line">            stompClient.disconnect();</span><br><span class="line">        &#125;</span><br><span class="line">        setConnected(<span class="literal">false</span>);</span><br><span class="line">        Console.log(<span class="string">&quot;Disconnected&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//向/request/send服务端发送消息</span></span><br><span class="line">    function <span class="title function_">sendMsg</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">var</span> <span class="variable">value</span> <span class="operator">=</span> $(<span class="string">&quot;#message&quot;</span>).val();</span><br><span class="line">        <span class="type">var</span> <span class="variable">user</span> <span class="operator">=</span> $(<span class="string">&quot;#user&quot;</span>).val();</span><br><span class="line">        <span class="comment">//用户和消息组成的字符串</span></span><br><span class="line">        <span class="type">var</span> <span class="variable">text</span> <span class="operator">=</span> user+<span class="string">&quot;,&quot;</span>+value;</span><br><span class="line">        stompClient.send(<span class="string">&quot;/request/sendUser&quot;</span>,&#123;&#125;,text);</span><br><span class="line">    &#125;</span><br><span class="line">    connect();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></div></figure>

<p>订阅指定用户的消息</p>
<figure class="highlight jsp"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page pageEncoding=<span class="string">&quot;utf-8&quot;</span>%&gt;</span><br><span class="line">&lt;%@ taglib prefix=<span class="string">&quot;c&quot;</span> uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span>%&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;stomp&lt;/title&gt;</span><br><span class="line">    &lt;script type=<span class="string">&quot;text/javascript&quot;</span> src = <span class="string">&quot;https://code.jquery.com/jquery-3.0.0.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script type=<span class="string">&quot;text/javascript&quot;</span>  src = <span class="string">&quot;https://cdn.jsdelivr.net/sockjs/1/sockjs.min.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">    &lt;<span class="type">script</span> <span class="variable">type</span> <span class="operator">=</span> <span class="string">&quot;text/javascript&quot;</span> src = <span class="string">&quot;../../js/stomp.min.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;h1&gt;</span><br><span class="line">    &lt;<span class="type">span</span> <span class="variable">id</span> <span class="operator">=</span> <span class="string">&quot;receive&quot;</span>&gt;等待消息接收&lt;/span&gt;</span><br><span class="line"></span><br><span class="line">&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;script type=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">    <span class="type">var</span> <span class="variable">noticeSocket</span> <span class="operator">=</span> function()&#123;</span><br><span class="line">        <span class="comment">//连接服务端点</span></span><br><span class="line">        <span class="type">var</span> <span class="variable">s</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SockJS</span>(<span class="string">&quot;/wsuser&quot;</span>);</span><br><span class="line">        <span class="comment">//客户端</span></span><br><span class="line">        <span class="type">var</span> <span class="variable">stompClient</span> <span class="operator">=</span> Stomp.over(s);</span><br><span class="line">        stompClient.connect(&#123;&#125;,function()&#123;</span><br><span class="line">            console.log(<span class="string">&quot;notice socket connected!&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//订阅消息地址</span></span><br><span class="line">            stompClient.subscribe(<span class="string">&quot;/user/queue/customer&quot;</span>,function(data)&#123;</span><br><span class="line">                $(<span class="string">&#x27;#receive&#x27;</span>).html(data.body);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">    &#125;;</span><br><span class="line">    noticeSocket();</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></div></figure>

<blockquote>
<p><b><font color="#D2691E">stompClient.subscribe(“&#x2F;user&#x2F;queue&#x2F;customer”,function(data){ $(‘#receive’).html(data.body);中的user前缀是不可缺少的，它代表订阅指定用户的消息</font></b></p>
</blockquote>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2020/07/22/Spring-Security/">Spring Security</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2020-07-22</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">2022-05-21</span></span></div></header><div class="post-body"><div class="post-excerpt"><span id="more"></span>

        <h1 id="安全–Spring-Security">
          <a href="#安全–Spring-Security" class="heading-link"><i class="fas fa-link"></i></a><a href="#安全–Spring-Security" class="headerlink" title="安全–Spring Security"></a>安全–Spring Security</h1>
      <div class="table-container"><table>
<tr>
<td bgcolor="Aquamarine">
    <b>为了使用SpringSecurity，需要在Maven配置文件中引入对应的依赖</b>
</td>
</tr>
</table></div>

<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">	&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">	&lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h2 id="简单安全认证">
          <a href="#简单安全认证" class="heading-link"><i class="fas fa-link"></i></a><a href="#简单安全认证" class="headerlink" title="简单安全认证"></a>简单安全认证</h2>
      <blockquote>
<p>引入依赖完成后，直接启动SpringBoot的应用也会启用Spring Security，启动完后可以看到如下打印随机生成密码的日志(需保证日志级别为INFO或以下才能看到)</p>
</blockquote>
<p><img src="/2020/07/22/Spring-Security/QQ%E6%88%AA%E5%9B%BE20200722153547.png"></p>
<font color="BlueViolet">
这时访问URL http://localhost:8080/ 相关便会进入一个登录页面。使用用户名"user",密码为以上随机生成的密码即可登录成功
</font>

<p><img src="/2020/07/22/Spring-Security/QQ%E6%88%AA%E5%9B%BE20200722154351.png"></p>
<p><strong>Spring Boot的自动配置机制，允许开发者快速修改用户名和密码</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#自定义用户名和密码</span><br><span class="line">spring.security.user.name=myusers</span><br><span class="line">spring.security.user.password=darksouls</span><br></pre></td></tr></table></div></figure>

<p>这样就可以使用上述配置的用户名和密码而不再使用固定的用户名和随机生成的密码</p>

        <h2 id="使用WebSecurityConfigurerAdapter自定义-x2F-自定义用户服务信息">
          <a href="#使用WebSecurityConfigurerAdapter自定义-x2F-自定义用户服务信息" class="heading-link"><i class="fas fa-link"></i></a><a href="#使用WebSecurityConfigurerAdapter自定义-x2F-自定义用户服务信息" class="headerlink" title="使用WebSecurityConfigurerAdapter自定义&#x2F;自定义用户服务信息"></a>使用WebSecurityConfigurerAdapter自定义&#x2F;自定义用户服务信息</h2>
      <div class="table-container"><table>
<tr>
<td bgcolor="#FFFAF0">
    <b>
在Spring Security中默认时没有任何用户配置的，而在SpringBoot中，如果没有用户的配置，它将会自动生成一个名称为user，密码通过随机生成的用户。为了克服这个问题，下面将讨论如何使用内存签名服务，数据库签名服务和自定义签名服务。
    </b>
</td>
</tr>
</table></div>


        <h3 id="使用内存签名服务">
          <a href="#使用内存签名服务" class="heading-link"><i class="fas fa-link"></i></a><a href="#使用内存签名服务" class="headerlink" title="使用内存签名服务"></a>使用内存签名服务</h3>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.rediscachetest.tools;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> ***</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">securityConf</span> <span class="keyword">extends</span> <span class="title class_">WebSecurityConfigurerAdapter</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">configure</span><span class="params">(AuthenticationManagerBuilder auth)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="comment">//密码编码器</span></span><br><span class="line"></span><br><span class="line">        <span class="type">PasswordEncoder</span> <span class="variable">passwordEncoder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BCryptPasswordEncoder</span>();</span><br><span class="line">        <span class="comment">//使用内存存储</span></span><br><span class="line">        InMemoryUserDetailsManagerConfigurer&lt;AuthenticationManagerBuilder&gt; userConfig = auth.inMemoryAuthentication()</span><br><span class="line">                <span class="comment">//设置密码编译器</span></span><br><span class="line">                .passwordEncoder(passwordEncoder);</span><br><span class="line">        <span class="comment">//生成abc加密后的密码</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">secrePass</span> <span class="operator">=</span> passwordEncoder.encode(<span class="string">&quot;abc&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;abc加密后的密码:&quot;</span>+secrePass);</span><br><span class="line">        <span class="comment">//注册用户admin，密码abc，并赋予USER和ADMIN权限</span></span><br><span class="line">        userConfig.withUser(<span class="string">&quot;admin&quot;</span>)</span><br><span class="line">                .password(secrePass)</span><br><span class="line">                .authorities(<span class="string">&quot;ROLE_USER&quot;</span>,<span class="string">&quot;ROLE_ADMIN&quot;</span>);</span><br><span class="line">        <span class="comment">//生成123456加密后的密码</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">secreONETWO</span> <span class="operator">=</span> passwordEncoder.encode(<span class="string">&quot;123456&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;123456加密后的密码:&quot;</span>+secreONETWO);</span><br><span class="line">        <span class="comment">//注册用户myuser，密码为123456并赋予USER角色权限</span></span><br><span class="line">        userConfig.withUser(<span class="string">&quot;myuser&quot;</span>)</span><br><span class="line">                .password(secreONETWO)</span><br><span class="line">                .authorities(<span class="string">&quot;ROLE_USER&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


<blockquote>
<p>在Spring 5的Security中都要求使用密码编译器，否则会发生异常</p>
</blockquote>

        <h3 id="使用数据库定义用户认证服务">
          <a href="#使用数据库定义用户认证服务" class="heading-link"><i class="fas fa-link"></i></a><a href="#使用数据库定义用户认证服务" class="headerlink" title="使用数据库定义用户认证服务"></a>使用数据库定义用户认证服务</h3>
      <p><strong>1. 创建用户表，角色表，用户角色表</strong></p>
<p><font color="orange">用户角色表关联用户表和角色表</font></p>
<p><img src="/2020/07/22/Spring-Security/tabUser.png"></p>
<p><img src="/2020/07/22/Spring-Security/tabRole.png"></p>
<p><img src="/2020/07/22/Spring-Security/tabUserRole.png"></p>
<p><strong>2. 使用数据库验证</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 数据库定义用户认证服务</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//注入数据源</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> <span class="type">DataSource</span> <span class="variable">dataSource</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="comment">//使用用户名称查询密码</span></span><br><span class="line"><span class="type">String</span> <span class="variable">pwdQuery</span> <span class="operator">=</span> <span class="string">&quot; select user_name,user_password,available from tab_user where user_name = ? &quot;</span>;</span><br><span class="line"><span class="comment">//使用用户名称查询角色信息</span></span><br><span class="line"><span class="type">String</span> <span class="variable">roleQuery</span> <span class="operator">=</span> <span class="string">&quot; select u.user_name,r.role_name from tab_user u,tab_user_role ur,tab_role r where u.id = ur.user_id and r.id = ur.role_id and u.user_name=? &quot;</span>;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">configure</span><span class="params">(AuthenticationManagerBuilder auth)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//密码编译器</span></span><br><span class="line">    auth.</span><br><span class="line">            jdbcAuthentication()</span><br><span class="line">            <span class="comment">//密码编译器</span></span><br><span class="line">            .passwordEncoder(<span class="keyword">new</span> <span class="title class_">BCryptPasswordEncoder</span>())</span><br><span class="line">            <span class="comment">//数据源</span></span><br><span class="line">            .dataSource(dataSource)</span><br><span class="line">            <span class="comment">//查询用户</span></span><br><span class="line">            .usersByUsernameQuery(pwdQuery)</span><br><span class="line">            <span class="comment">//赋予权限</span></span><br><span class="line">            .authoritiesByUsernameQuery(roleQuery);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<blockquote>
<p>注意方法中<font color="#0000FF"> .passwordEncoder(new BCryptPasswordEncoder())</font>中的<font color="#0000FF">new BCryptPasswordEncoder()</font>方法。Spring 5的Security中都要求使用密码编码器，这里指定的是<strong>BCryptPasswordEncoder</strong>实例，如果不想指定的话可以写成<font color="#0000FF">NoOpPasswordEncoder.getInstance()</font>，不过此方法已经画横线了所以最好不用。</p>
</blockquote>
<blockquote>
<p><font color="#0000FF">usersByUsernameQuery</font>方法通过定义的sql语句返回3个列。分别是用户名，密码和布尔值，这样就可以对用户名和密码进行验证了。<font color="#0000FF">authoritiesByUsernameQuery</font>方法会用roleQuery定义的SQL通过用户名称查找角色名称，根据查询的结果赋予权限，如果这条SQL语句返回的时多条，那么就会给这个用户赋予多个角色</p>
</blockquote>
<p><strong>值得一提的是，如果使用了<font color="blue">BCryptPasswordEncoder</font>类型的编码器进行加密，那么在保存在数据库中密码的格式就需要是BCryt格式的，否则就会报错。比如密码为”123456789”,那么保存在数据库中的就应该是<font color="#7FFFD4">$2a$10$rrZC9HLI2CwN4WWrVSf9Ie0APh.WVRAzvdcX0Pzm5MpIqjJKjNaNK</font>，切记这只是保存在数据库中的密码格式，如果登录验证时使用的密码一定是”123456789”，它会转换成BCryt格式的密文进行比对。而不是<font color="#7FFFD4">$2a$10$rrZC9HLI2CwN4WWrVSf9Ie0APh.WVRAzvdcX0Pzm5MpIqjJKjNaNK</font>。</strong></p>

        <h3 id="限制请求">
          <a href="#限制请求" class="heading-link"><i class="fas fa-link"></i></a><a href="#限制请求" class="headerlink" title="限制请求"></a>限制请求</h3>
      <div class="table-container"><table>
<tr>
<td bgcolor="Beige">
    <b>
对于不同的角色而言，其访问的权限也是不一样的。通过继承的抽象类WebSecurityConfigurerAdapter的configure(HttpSecurity)方法便能实现对于不同角色赋予不同权限的功能
    </b>
</td>
</tr>
</table></div>

<p><strong>1. 配置请求路径访问权限</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.rediscachetest.tools;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.config.annotation.authentication.configurers.provisioning.InMemoryUserDetailsManagerConfigurer;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.config.annotation.web.builders.HttpSecurity;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.crypto.password.PasswordEncoder;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.sql.DataSource;</span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">securityConf</span>  <span class="keyword">extends</span> <span class="title class_">WebSecurityConfigurerAdapter</span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 数据库定义用户认证服务</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">//注入数据源</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">DataSource</span> <span class="variable">dataSource</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="comment">//使用用户名称查询密码</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">pwdQuery</span> <span class="operator">=</span> <span class="string">&quot; select user_name,user_password,available from tab_user where user_name = ? &quot;</span>;</span><br><span class="line">    <span class="comment">//使用用户名称查询角色信息</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">roleQuery</span> <span class="operator">=</span> <span class="string">&quot; select u.user_name,r.role_name from tab_user u,tab_user_role ur,tab_role r where u.id = ur.user_id and r.id = ur.role_id and u.user_name=? &quot;</span>;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">configure</span><span class="params">(AuthenticationManagerBuilder auth)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//密码编译器</span></span><br><span class="line">        auth.</span><br><span class="line">                jdbcAuthentication()</span><br><span class="line">                <span class="comment">//密码编译器</span></span><br><span class="line">                .passwordEncoder(<span class="keyword">new</span> <span class="title class_">BCryptPasswordEncoder</span>())</span><br><span class="line">                <span class="comment">//数据源</span></span><br><span class="line">                .dataSource(dataSource)</span><br><span class="line">                <span class="comment">//查询用户</span></span><br><span class="line">                .usersByUsernameQuery(pwdQuery)</span><br><span class="line">                <span class="comment">//赋予权限</span></span><br><span class="line">                .authoritiesByUsernameQuery(roleQuery);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">configure</span><span class="params">(HttpSecurity httpSecurity)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">         httpSecurity</span><br><span class="line">                 .authorizeRequests()</span><br><span class="line">                 .antMatchers(<span class="string">&quot;/models/mod1&quot;</span>).hasAnyRole(<span class="string">&quot;SYSTEM&quot;</span>,<span class="string">&quot;SUPER&quot;</span>,<span class="string">&quot;USER&quot;</span>)</span><br><span class="line">                 .antMatchers(<span class="string">&quot;/session/**&quot;</span>).hasAnyAuthority(<span class="string">&quot;ROLE_ADMIN&quot;</span>)</span><br><span class="line">                 .anyRequest().permitAll()</span><br><span class="line">                 .and().anonymous()</span><br><span class="line">                 .and().formLogin()</span><br><span class="line">                 .and().httpBasic();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<blockquote>
<p>着重在于方法**<font color="red">configure(HttpSecurity httpSecurity)</font>**。<font color="orange">antMatchers</font>方法指定了请求的路径。<font color="orange">hasAnyRole</font>指定了该路径访问的角色权限为”ROLE_SYSTEM”,”ROLE_SUPER”,”ROLE_USER”.第二个<font color="orange">antMatchers</font>方法限定”session”下所有请求权限赋予角色”ROLE_ADMIN”.注意，<font color="orange">hasAnyRole</font>方法会自动加入前缀“ROLE_”,<font color="orange">hasAnyAuthority</font>方法则不会，此方法可以使用自定义不带ROLE的角色。<font color="orange">.anyRequest().permitAll()</font>表示其他路径允许签名后访问，<font color="orange">and().anonymous()</font>表示对于没有配置权限的其他请求允许匿名访问。</p>
</blockquote>
<p><strong>2. Spring表达式设置权限</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">configure</span><span class="params">(HttpSecurity httpSecurity)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Spring 表达式设置权限</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    httpSecurity.authorizeRequests()</span><br><span class="line">			<span class="comment">//限定角色只有ROLE_USER或者ROLE_ADMIN</span></span><br><span class="line">            .antMatchers(<span class="string">&quot;/models/mod1&quot;</span>).access(<span class="string">&quot;hasAnyRole(&#x27;USER&#x27;) or hasAnyRole(&#x27;ADMIN&#x27;)&quot;</span>)</span><br><span class="line">			<span class="comment">//限定角色只有testone，要求是完整登录</span></span><br><span class="line">            .antMatchers(<span class="string">&quot;/session/**&quot;</span>).access(<span class="string">&quot;hasAnyAuthority(&#x27;testone&#x27;) &amp;&amp; isFullyAuthenticated()&quot;</span>)</span><br><span class="line">			<span class="comment">//使用记住我功能</span></span><br><span class="line">            .and().rememberMe()</span><br><span class="line">			<span class="comment">//使用Spring Security默认登录页面</span></span><br><span class="line">            .and().formLogin()</span><br><span class="line">			<span class="comment">//启用http基础验证</span></span><br><span class="line">            .and().httpBasic();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h3 id="用户认证功能">
          <a href="#用户认证功能" class="heading-link"><i class="fas fa-link"></i></a><a href="#用户认证功能" class="headerlink" title="用户认证功能"></a>用户认证功能</h3>
      <p><strong>自定义登录界面</strong></p>
<p><strong><font color="gray">1. 配置登录请求和记住我</font></strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">configure</span><span class="params">(HttpSecurity httpSecurity)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Spring 表达式设置权限</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    httpSecurity.authorizeRequests()</span><br><span class="line">            .antMatchers(<span class="string">&quot;/models/mod1&quot;</span>).access(<span class="string">&quot;hasAnyRole(&#x27;USER&#x27;) or hasAnyRole(&#x27;ADMIN&#x27;)&quot;</span>)</span><br><span class="line">            .antMatchers(<span class="string">&quot;/session/**&quot;</span>).access(<span class="string">&quot;hasAnyAuthority(&#x27;testone&#x27;) &amp;&amp; isFullyAuthenticated()&quot;</span>)</span><br><span class="line">            .and().rememberMe().tokenValiditySeconds(<span class="number">86400</span>).key(<span class="string">&quot;remember-me-key&quot;</span>)</span><br><span class="line">            .and().formLogin().loginPage(<span class="string">&quot;/login/page&quot;</span>).defaultSuccessUrl(<span class="string">&quot;/admin/welcome&quot;</span>)</span><br><span class="line">            .and().logout().logoutUrl(<span class="string">&quot;/logout&quot;</span>).logoutSuccessUrl(<span class="string">&quot;/logout/page&quot;</span>)</span><br><span class="line">            .and().httpBasic().realmName(<span class="string">&quot;my_basic_name&quot;</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<blockquote>
<p>这里的rememberMe方法意思是“记住我”功能，有效时间为1天（86400s）,在浏览器中将使用Cookie以键“remember-me-key”进行保存、loginPage方法是指定登录的路径(login&#x2F;page)，defaultSuccessUrl为默认跳转路径。</p>
</blockquote>
<p><strong><font color="gray">2. 指定的login&#x2F;page所映射的路径既可以用传统的控制器映射，也可以使用新增映射关系完成</font></strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.rediscachetest.tools;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.ViewControllerRegistry;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurer;</span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebConfig</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line">    <span class="comment">// 增加映射关系</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addViewControllers</span><span class="params">(ViewControllerRegistry registry)</span>&#123;</span><br><span class="line">        <span class="comment">// 使得/login/page映射为login.jsp</span></span><br><span class="line"></span><br><span class="line">        registry.addViewController(<span class="string">&quot;/login/page&quot;</span>).setViewName(<span class="string">&quot;user/login&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//使得/logout/page映射为/logout_welcome.jsp</span></span><br><span class="line"></span><br><span class="line">        registry.addViewController(<span class="string">&quot;/logout/page&quot;</span>).setViewName(<span class="string">&quot;user/logout_welcome&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//使得/loogout映射为logout.jsp</span></span><br><span class="line">        registry.addViewController(<span class="string">&quot;/logout&quot;</span>).setViewName(<span class="string">&quot;user/logout&quot;</span>);</span><br><span class="line"></span><br><span class="line">        registry.addViewController(<span class="string">&quot;/admin/welcome&quot;</span>).setViewName(<span class="string">&quot;user/welcome&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p><strong><font color="gray">3. 自定义登录界面</font></strong></p>
<figure class="highlight jsp"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page pageEncoding=<span class="string">&quot;utf-8&quot;</span>%&gt;</span><br><span class="line">&lt;%@ taglib prefix=<span class="string">&quot;c&quot;</span> uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span>%&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;登录页面&lt;/title&gt;</span><br><span class="line">    &lt;<span class="type">script</span> <span class="variable">src</span> <span class="operator">=</span> <span class="string">&quot;https://code.jquery.com/jquery-3.0.0.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;h1&gt;</span><br><span class="line">    &lt;% System.out.println(<span class="string">&quot;视图渲染&quot;</span>);%&gt;</span><br><span class="line">&lt;/h1&gt;</span><br><span class="line">&lt;form action=<span class="string">&quot;/login/page&quot;</span> method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">    &lt;input type=<span class="string">&quot;text&quot;</span> id = <span class="string">&quot;username&quot;</span> name = <span class="string">&quot;username&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">    &lt;input type=<span class="string">&quot;text&quot;</span> id = <span class="string">&quot;password&quot;</span> name = <span class="string">&quot;password&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">    &lt;input type=<span class="string">&quot;checkbox&quot;</span> id = <span class="string">&quot;remember_me&quot;</span> name = <span class="string">&quot;remember-me&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">    &lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;登录&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">    &lt;input type=<span class="string">&quot;hidden&quot;</span> id = <span class="string">&quot;$&#123;_csrf.parameterName&#125;&quot;</span> name = <span class="string">&quot;$&#123;_csrf.parameterName&#125;&quot;</span> value=<span class="string">&quot;$&#123;_csrf.token&#125;&quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></div></figure>

<blockquote>
<p>此处的表单提交的action定义为&#x2F;login&#x2F;page,这样安全登录拦截器就会拦截这些参数。此处要求method为post，用户名为username，密码为password，记住我为remember-me且为checkbox类型</p>
</blockquote>
<p><strong><font color="gray">4. 登出页面</font></strong></p>
<p>logout_welcome.jsp</p>
<figure class="highlight jsp"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page pageEncoding=<span class="string">&quot;utf-8&quot;</span>%&gt;</span><br><span class="line">&lt;%@ taglib prefix=<span class="string">&quot;c&quot;</span> uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span>%&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;登出页面&lt;/title&gt;</span><br><span class="line">    &lt;<span class="type">script</span> <span class="variable">src</span> <span class="operator">=</span> <span class="string">&quot;https://code.jquery.com/jquery-3.0.0.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;h1&gt;</span><br><span class="line"></span><br><span class="line">&lt;/h1&gt;</span><br><span class="line">&lt;p&gt;您已登出系统&lt;/p&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></div></figure>

<p>logout.jsp</p>
<figure class="highlight jsp"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page pageEncoding=<span class="string">&quot;utf-8&quot;</span>%&gt;</span><br><span class="line">&lt;%@ taglib prefix=<span class="string">&quot;c&quot;</span> uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span>%&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;登出&lt;/title&gt;</span><br><span class="line">    &lt;<span class="type">script</span> <span class="variable">src</span> <span class="operator">=</span> <span class="string">&quot;https://code.jquery.com/jquery-3.0.0.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;form action=<span class="string">&quot;/logout&quot;</span> method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">&lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;登出&quot;</span>&gt;</span><br><span class="line">&lt;input type=<span class="string">&quot;hidden&quot;</span> id = <span class="string">&quot;$&#123;_csrf.parameterName&#125;&quot;</span> name = <span class="string">&quot;$&#123;_csrf.parameterName&#125;&quot;</span> value=<span class="string">&quot;$&#123;_csrf.token&#125;&quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure></div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2020/07/19/REST%E9%A3%8E%E6%A0%BC/">REST风格</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2020-07-19</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">2022-05-21</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h1 id="REST简述">
          <a href="#REST简述" class="heading-link"><i class="fas fa-link"></i></a><a href="#REST简述" class="headerlink" title="REST简述"></a>REST简述</h1>
      
        <h2 id="REST名词">
          <a href="#REST名词" class="heading-link"><i class="fas fa-link"></i></a><a href="#REST名词" class="headerlink" title="REST名词"></a>REST名词</h2>
      <p><strong>1. 资源:是一个具体存在的对象，它可以是系统权限用户，角色和菜单等。也可以是一些媒体类型，如文本，图片，歌曲</strong></p>
<p><strong>2. 表现层:表现这个资源</strong></p>
<p><strong>3. 状态转换:现实中的资源不是一层不变的，它是一个变化的过程，一个资源可以经历创建，访问，修改和删除的过程。</strong></p>

        <h2 id="开发REST风格端点">
          <a href="#开发REST风格端点" class="heading-link"><i class="fas fa-link"></i></a><a href="#开发REST风格端点" class="headerlink" title="开发REST风格端点"></a>开发REST风格端点</h2>
      
        <h3 id="Spring-4-3之后除了-RequestMapping外，还可以使用以下5个注解">
          <a href="#Spring-4-3之后除了-RequestMapping外，还可以使用以下5个注解" class="heading-link"><i class="fas fa-link"></i></a><a href="#Spring-4-3之后除了-RequestMapping外，还可以使用以下5个注解" class="headerlink" title="Spring 4.3之后除了@RequestMapping外，还可以使用以下5个注解:"></a>Spring 4.3之后除了@RequestMapping外，还可以使用以下5个注解:</h3>
      <p><strong>1. @GetMapping:对应HTTP的GET请求，获取资源</strong></p>
<p><strong>2. @PostMapping: 对应HTTP的POST请求，创建资源</strong></p>
<p><strong>3. @PutMapping: 对应HTTP的PUT请求，提交所有的资源属性以修改资源</strong></p>
<p><strong>4. @PatchMapping: 对应HTTP的PATCH请求，提交资源部分修改的属性</strong></p>
<p><strong>5. @DeleteMapping: 对应HTTP的DELETE请求，删除服务器端的资源。</strong></p>
<blockquote>
<div class="table-container"><table><tr><td bgcolor="#F0FFFF">通过这些注解就能把URI定位到对应的控制器方法上。通过注解@PathVariable进行获取，这样就能满足REST风格传递参数的要求。对于复杂的参数，比如传递十几个的字段，可以考虑请求体JSON的方式提交给服务器。</td></tr></table></div>
</blockquote>

        <h2 id="RestController使用">
          <a href="#RestController使用" class="heading-link"><i class="fas fa-link"></i></a><a href="#RestController使用" class="headerlink" title="RestController使用"></a>RestController使用</h2>
      <div class="table-container"><table><tr><td bgcolor="#F5F5F5">因为现在的前后端分离，所以使用JSOM作为前后端交互已经十分普遍。如果每个方法都加上@ResponseBody才能将数据转换为JSON，显然有些冗余。@RestController注解，通过它可以将控制器返回的对象转换为JSON数据集。</td></tr></table></div>

<div class="table-container"><table><tr><td bgcolor="#FFF5EE">使用此注解就能让之前的getUser方法返回的对象转变为JSON数据集了，为了使得JSP视图也能够被渲染成功，原本通过直接返回字符串的方式就不能使用了。这时可以使用ModelAndView的返回，通过视图名称找到对应的视图，将数据模型进行渲染，展示JSP视图给用户观看。</td></tr></table></div>


        <h2 id="渲染结果">
          <a href="#渲染结果" class="heading-link"><i class="fas fa-link"></i></a><a href="#渲染结果" class="headerlink" title="渲染结果"></a>渲染结果</h2>
      <p>在@RequestMapping，@GetMapping中还存在consumes和produces属性。欠着代表的是限制该方法接受什么类型的请求体，后者代表的是限定返回的媒体类型，仅当request请求头中的类型中包含该指定的类型才返回。如：</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(value=&quot;user2/name/&#123;id&#125;&quot;,consumes=MediaType.All_VALUE,prodices=MediaType.TEXT_PLAIN_VALUE)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">getUsername</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Long id)</span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userService.getUser(id);</span><br><span class="line">	<span class="keyword">return</span> user.getUserName();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>
<blockquote>
<p>以上表示接收任意的请求体，限定返回的媒体类型为文本。</p>
</blockquote>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2020/06/17/Spring-MVC%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0v1/">Spring MVC学习笔记v1</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2020-06-17</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">2022-05-21</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h1 id="Spring-MVC">
          <a href="#Spring-MVC" class="heading-link"><i class="fas fa-link"></i></a><a href="#Spring-MVC" class="headerlink" title="Spring MVC"></a>Spring MVC</h1>
      
        <h2 id="简单页面配置">
          <a href="#简单页面配置" class="heading-link"><i class="fas fa-link"></i></a><a href="#简单页面配置" class="headerlink" title="简单页面配置"></a>简单页面配置</h2>
      <p><strong>1. 控制器</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.rediscachetest.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.rediscachetest.pojo.ServerUser;</span><br><span class="line"><span class="keyword">import</span> com.example.rediscachetest.serviceImpl.userServiceImpl;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/users&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">userController</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">userServiceImpl</span> <span class="variable">uSer</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/resUser&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ModelAndView <span class="title function_">getUserOne</span><span class="params">(<span class="type">long</span> id)</span>&#123;</span><br><span class="line">        <span class="type">ServerUser</span> <span class="variable">sUser</span> <span class="operator">=</span> uSer.getServerUser(id);</span><br><span class="line">        <span class="type">ModelAndView</span> <span class="variable">mav</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ModelAndView</span>();</span><br><span class="line">        mav.setViewName(<span class="string">&quot;user/detail&quot;</span>);</span><br><span class="line">        mav.addObject(<span class="string">&quot;user&quot;</span>,sUser);</span><br><span class="line">        <span class="keyword">return</span> mav;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p><strong>2. 引入关于jsp、jstl的依赖并通过application.properties定制InternalResourceViewResolver初始化.</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">	&lt;groupId&gt;javax.servlet&lt;/groupId&gt;</span><br><span class="line">	&lt;artifactId&gt;jstl&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">	&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">	&lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;</span><br><span class="line">	&lt;scope&gt;provided&lt;/scope&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">	&lt;groupId&gt;org.apache.tomcat.embed&lt;/groupId&gt;</span><br><span class="line">	&lt;artifactId&gt;tomcat-embed-jasper&lt;/artifactId&gt;</span><br><span class="line">	&lt;scope&gt;provided&lt;/scope&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></div></figure>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">spring.mvc.view.prefix=/WEB-INF/jsp/</span><br><span class="line">spring.mvc.view.suffix=.jsp</span><br></pre></td></tr></table></div></figure>

<p><strong>3. jsp视图</strong></p>
<figure class="highlight html"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page pageEncoding=&quot;utf-8&quot;%&gt;</span><br><span class="line">&lt;%@ taglib prefix=&quot;c&quot; uri=&quot;http://java.sun.com/jsp/jstl/core&quot;%&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>用户详情<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">center</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span> = <span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span>标签<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span>值<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span>用户编号<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">c:out</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;user.id&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">c:out</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span>用户名称<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">c:out</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;user.name&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">c:out</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span>用户备注<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">c:out</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;user.remark&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">c:out</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></div></figure>

<p><strong>4. jsp视图的位置</strong></p>
<p><img src="/2020/06/17/Spring-MVC%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0v1/QQ%E6%88%AA%E5%9B%BE20200617135014.png"></p>

        <h2 id="使用JSON视图-MappingJackson2JsonView转换出JSON">
          <a href="#使用JSON视图-MappingJackson2JsonView转换出JSON" class="heading-link"><i class="fas fa-link"></i></a><a href="#使用JSON视图-MappingJackson2JsonView转换出JSON" class="headerlink" title="使用JSON视图(MappingJackson2JsonView转换出JSON)"></a>使用JSON视图(MappingJackson2JsonView转换出JSON)</h2>
      <p><strong>控制器</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/detailsForjson&quot;)</span></span><br><span class="line">   <span class="keyword">public</span> ModelAndView <span class="title function_">detailsForJson</span><span class="params">(<span class="type">long</span> id)</span>&#123;</span><br><span class="line">       <span class="comment">//访问模型层得到数据</span></span><br><span class="line">       <span class="type">ServerUser</span> <span class="variable">oUser</span> <span class="operator">=</span> uSer.getServerUser(id);</span><br><span class="line">       <span class="comment">//模型和视图</span></span><br><span class="line">       <span class="type">ModelAndView</span> <span class="variable">mav</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ModelAndView</span>();</span><br><span class="line">       <span class="comment">//生成Json视图</span></span><br><span class="line">       <span class="type">MappingJackson2JsonView</span> <span class="variable">jsonView</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MappingJackson2JsonView</span>();</span><br><span class="line">       mav.setView(jsonView);</span><br><span class="line">       <span class="comment">//加入模型</span></span><br><span class="line">       mav.addObject(oUser);</span><br><span class="line">       <span class="keyword">return</span> mav;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></div></figure>

<blockquote>
<p>注意到这里在控制器的方法中模型和视图中捆绑了JSON视图(MappingJackson2JsonView),这里的JSON视图是没有视图解析器的定位视图的，它并不是一个逻辑视图，只是需要将数据模型转换为json。<br>。</p>
</blockquote>

        <h2 id="Spring-MVC实例">
          <a href="#Spring-MVC实例" class="heading-link"><i class="fas fa-link"></i></a><a href="#Spring-MVC实例" class="headerlink" title="Spring MVC实例"></a>Spring MVC实例</h2>
      
        <h3 id="1-定制InternalResourceViewResolver初始化">
          <a href="#1-定制InternalResourceViewResolver初始化" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-定制InternalResourceViewResolver初始化" class="headerlink" title="1. 定制InternalResourceViewResolver初始化"></a>1. 定制InternalResourceViewResolver初始化</h3>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">spring.mvc.view.prefix=/WEB-INF/jsp/</span><br><span class="line">spring.mvc.view.suffix=.jsp</span><br></pre></td></tr></table></div></figure>
<blockquote>
<p>通过这样的配置，就能在SpringBoot的机制下定制InternalResourceViewResolver这个视图解析器的初始化，也就是在返回视图名称之后，它会以前缀和后缀以及视图的名称组成全路径定位视图。</p>
</blockquote>

        <h3 id="2-控制器">
          <a href="#2-控制器" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-控制器" class="headerlink" title="2. 控制器"></a>2. 控制器</h3>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/tablePage&quot;)</span></span><br><span class="line"><span class="keyword">public</span> ModelAndView <span class="title function_">disTablePage</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">ModelAndView</span> <span class="variable">mv</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ModelAndView</span>();</span><br><span class="line">    List&lt;ServerUser&gt; suList = uSer.getTarServerUser(<span class="literal">null</span>,<span class="literal">null</span>);</span><br><span class="line">    mv.addObject(<span class="string">&quot;suserList&quot;</span>,suList);</span><br><span class="line">    mv.setViewName(<span class="string">&quot;user/table&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> mv;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@RequestMapping(&quot;/likeData&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> List&lt;ServerUser&gt; <span class="title function_">likeSeruList</span><span class="params">(<span class="meta">@RequestParam(value = &quot;suName&quot;,required = false)</span> String sName, <span class="meta">@RequestParam(value = &quot;suRemark&quot;,required = false)</span> String sRemark)</span>&#123;</span><br><span class="line">    <span class="comment">//访问模型层得到数据</span></span><br><span class="line">    List&lt;ServerUser&gt; suserList = uSer.getTarServerUser(sName,sRemark);</span><br><span class="line">    <span class="keyword">return</span> suserList;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


<blockquote>
<p>该控制器的第一个方法是指当访问到它时它将会跳转到table.jsp页面，且将查询到的用户列表捆绑到模型和视图中，这样当跳转到jsp页面时数据将会显示出来。<br>第二个方法，如果对当前表格数据进行查询时可以通过**@RequestParam**注解传递参数进行查询。因为它标注了@ResponseBody,于是SpringMVC就知道最终需要将返回的结果转换为JSON。</p>
</blockquote>

        <h3 id="3-jsp页面">
          <a href="#3-jsp页面" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-jsp页面" class="headerlink" title="3. jsp页面"></a>3. jsp页面</h3>
      <figure class="highlight jsp"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page pageEncoding=<span class="string">&quot;utf-8&quot;</span>%&gt;</span><br><span class="line">&lt;%@ taglib prefix=<span class="string">&quot;c&quot;</span> uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span>%&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">    &lt;title&gt;用户列表&lt;/title&gt;</span><br><span class="line">    &lt;<span class="type">link</span> <span class="variable">rel</span> <span class="operator">=</span> <span class="string">&quot;stylesheet&quot;</span> type=<span class="string">&quot;text/css&quot;</span> href = <span class="string">&quot;../../easyUI/themes/default/easyui.css&quot;</span>&gt;</span><br><span class="line">    &lt;<span class="type">link</span> <span class="variable">rel</span> <span class="operator">=</span> <span class="string">&quot;stylesheet&quot;</span> type=<span class="string">&quot;text/css&quot;</span> href = <span class="string">&quot;../../easyUI/themes/icon.css&quot;</span>&gt;</span><br><span class="line">    &lt;<span class="type">script</span> <span class="variable">type</span> <span class="operator">=</span> <span class="string">&quot;text/javascript&quot;</span> src = <span class="string">&quot;../../easyUI/jquery.min.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">    &lt;<span class="type">script</span> <span class="variable">type</span> <span class="operator">=</span> <span class="string">&quot;text/javascript&quot;</span> src = <span class="string">&quot;../../easyUI/jquery.easyui.min.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;div id=<span class="string">&quot;cc&quot;</span> class=<span class="string">&quot;easyui-layout&quot;</span> style=<span class="string">&quot;width:600px;height:400px;&quot;</span>&gt;</span><br><span class="line">    &lt;div data-options = <span class="string">&quot;region:&#x27;north&#x27;&quot;</span> style = <span class="string">&quot;height:70px;&quot;</span>&gt;</span><br><span class="line">        &lt;<span class="type">form</span> <span class="variable">id</span> <span class="operator">=</span> <span class="string">&quot;searchForm&quot;</span> method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">            &lt;table&gt;</span><br><span class="line">                &lt;tr&gt;</span><br><span class="line">                &lt;td&gt;</span><br><span class="line">                    用户名称:</span><br><span class="line">                &lt;/td&gt;</span><br><span class="line">                &lt;td&gt;</span><br><span class="line">                    &lt;<span class="type">input</span> <span class="variable">id</span> <span class="operator">=</span> <span class="string">&quot;userName&quot;</span> name = <span class="string">&quot;userName&quot;</span> class = <span class="string">&quot;easyui-textbox&quot;</span> data-options = <span class="string">&quot;prompt:&#x27;请输入用户名称...&#x27;&quot;</span></span><br><span class="line">                    style = <span class="string">&quot;width:100%;height:32px;&quot;</span>&gt;</span><br><span class="line">                &lt;/td&gt;</span><br><span class="line">                    &lt;td&gt;</span><br><span class="line">                        备注:</span><br><span class="line">                    &lt;/td&gt;</span><br><span class="line">                    &lt;td&gt;</span><br><span class="line">                        &lt;<span class="type">input</span> <span class="variable">id</span> <span class="operator">=</span> <span class="string">&quot;note&quot;</span> name = <span class="string">&quot;note&quot;</span> class = <span class="string">&quot;easyui-textbox&quot;</span> data-options = <span class="string">&quot;prompt:&#x27;请输入备注...&#x27;&quot;</span></span><br><span class="line">                               style = <span class="string">&quot;width:100%;height:32px;&quot;</span>&gt;</span><br><span class="line">                    &lt;/td&gt;</span><br><span class="line">                    &lt;td&gt;</span><br><span class="line">                        &lt;<span class="type">a</span> <span class="variable">href</span> <span class="operator">=</span> <span class="string">&quot;#&quot;</span> class = <span class="string">&quot;easyui-linkbutton&quot;</span> data-options = <span class="string">&quot;iconCls:&#x27;icon-search&#x27;&quot;</span> style=<span class="string">&quot;width: 80px;&quot;</span> onclick = <span class="string">&quot;onSearch()&quot;</span>&gt;查询&lt;/a&gt;</span><br><span class="line">                    &lt;/td&gt;</span><br><span class="line">                &lt;/tr&gt;</span><br><span class="line">            &lt;/table&gt;</span><br><span class="line"></span><br><span class="line">        &lt;/form&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;div data-options = <span class="string">&quot;region:&#x27;center&#x27;,title:&#x27;用户列表&#x27;,iconCls:&#x27;icon-ok&#x27;&quot;</span>&gt;</span><br><span class="line">&lt;<span class="type">table</span> <span class="variable">id</span> <span class="operator">=</span> <span class="string">&quot;dg&quot;</span> class = <span class="string">&quot;easyui-datagrid&quot;</span> data-options = <span class="string">&quot;border:false,singleSelect:true,fit:true,fitColumns:true&quot;</span>&gt;</span><br><span class="line">        &lt;thead&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">                &lt;th data-options = <span class="string">&quot;field:&#x27;id&#x27;&quot;</span> width=<span class="string">&quot;80&quot;</span>&gt;</span><br><span class="line">                    编号</span><br><span class="line">                &lt;/th&gt;</span><br><span class="line">                &lt;th data-options = <span class="string">&quot;field:&#x27;name&#x27;&quot;</span> width=<span class="string">&quot;100&quot;</span>&gt;</span><br><span class="line">                    用户名称</span><br><span class="line">                &lt;/th&gt;</span><br><span class="line">                &lt;th data-options = <span class="string">&quot;field:&#x27;phone&#x27;&quot;</span> width=<span class="string">&quot;100&quot;</span>&gt;</span><br><span class="line">                    用户电话</span><br><span class="line">                &lt;/th&gt;</span><br><span class="line">                &lt;th data-options = <span class="string">&quot;field:&#x27;remark&#x27;&quot;</span> width=<span class="string">&quot;80&quot;</span>&gt;</span><br><span class="line">                    备注</span><br><span class="line">                &lt;/th&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">        &lt;/thead&gt;</span><br><span class="line">        &lt;tbody&gt;</span><br><span class="line">        &lt;c:forEach items=<span class="string">&quot;$&#123;suserList&#125;&quot;</span> <span class="keyword">var</span> = <span class="string">&quot;user&quot;</span>&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">                &lt;td&gt;$&#123;user.id&#125;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;$&#123;user.name&#125;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;$&#123;user.phone&#125;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;$&#123;user.remark&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">        &lt;/c:forEach&gt;</span><br><span class="line"></span><br><span class="line">        &lt;/tbody&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;/table&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;script type=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line">    function <span class="title function_">onSearch</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">var</span> <span class="variable">opts</span> <span class="operator">=</span> $(<span class="string">&quot;#dg&quot;</span>).datagrid(<span class="string">&quot;options&quot;</span>);</span><br><span class="line">        opts.url = <span class="string">&quot;./likeData&quot;</span>;</span><br><span class="line">        <span class="comment">//获取参数</span></span><br><span class="line">        <span class="type">var</span> <span class="variable">suName</span> <span class="operator">=</span> $(<span class="string">&quot;#userName&quot;</span>).val();</span><br><span class="line">        <span class="type">var</span> <span class="variable">suRemark</span> <span class="operator">=</span> $(<span class="string">&quot;#note&quot;</span>).val();</span><br><span class="line">        <span class="type">var</span> <span class="variable">params</span> <span class="operator">=</span> &#123;&#125;;</span><br><span class="line">        <span class="keyword">if</span>(suName!=<span class="literal">null</span>&amp;&amp;suName.trim()!=<span class="string">&quot;&quot;</span>)&#123;</span><br><span class="line">            params.suName = suName;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(suRemark!=<span class="literal">null</span>&amp;&amp;suRemark.trim()!=<span class="string">&quot;&quot;</span>)&#123;</span><br><span class="line">            params.suRemark = suRemark;</span><br><span class="line">        &#125;</span><br><span class="line">        $(<span class="string">&quot;#dg&quot;</span>).datagrid(<span class="string">&quot;load&quot;</span>,params);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></div></figure>

<ol>
<li>JSP页面及静态资源所在位置:</li>
</ol>
<p><img src="/2020/06/17/Spring-MVC%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0v1/QQ%E6%88%AA%E5%9B%BE20200622175140.png"></p>
<ol start="2">
<li>JSP页面所需要的依赖关系</li>
</ol>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">	&lt;groupId&gt;javax.servlet&lt;/groupId&gt;</span><br><span class="line">	&lt;artifactId&gt;jstl&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">	&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">	&lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;</span><br><span class="line">	&lt;scope&gt;provided&lt;/scope&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">	&lt;groupId&gt;org.apache.tomcat.embed&lt;/groupId&gt;</span><br><span class="line">	&lt;artifactId&gt;tomcat-embed-jasper&lt;/artifactId&gt;</span><br><span class="line">	&lt;scope&gt;provided&lt;/scope&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<blockquote>
<p>首先，在我们访问控制器第一个方法后就会跳转到jsp页面，因为我们绑定了所查询到的用户列表数据，可以直接使用jstl语言将查询到的数据展示在表格中。然后写查询的js方法，在输入用户名称或者是备注后将数据传入到后台中。</p>
</blockquote>
<p><img src="/2020/06/17/Spring-MVC%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0v1/QQ%E6%88%AA%E5%9B%BE20200622175618.png"></p>
<p><img src="/2020/06/17/Spring-MVC%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0v1/QQ%E6%88%AA%E5%9B%BE20200622175640.png"></p>
<p><strong>注意传递参数值的一致</strong></p>
<blockquote>
<p> 注意一点的是，在jsp页面中使用的是easyui的框架，所以表格头<strong>th</strong>的<strong>field</strong>的属性要与封装类的属性一致，这样在查询后返回的数据才能完整的显示在表格中。</p>
</blockquote>

        <h2 id="获取控制器参数">
          <a href="#获取控制器参数" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取控制器参数" class="headerlink" title="获取控制器参数"></a>获取控制器参数</h2>
      
        <h4 id="1-无注解获取参数">
          <a href="#1-无注解获取参数" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-无注解获取参数" class="headerlink" title="1.无注解获取参数"></a>1.无注解获取参数</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/no/annotation&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">getNoAnnotationParam</span><span class="params">(Integer par1,Long par2,String str3)</span>&#123;</span><br><span class="line">    Map&lt;String,Object&gt; parMap = <span class="keyword">new</span> <span class="title class_">LinkedHashMap</span>&lt;&gt;();</span><br><span class="line">    parMap.put(<span class="string">&quot;par1&quot;</span>,par1);</span><br><span class="line">    parMap.put(<span class="string">&quot;par2&quot;</span>,par2);</span><br><span class="line">    parMap.put(<span class="string">&quot;str3&quot;</span>,str3);</span><br><span class="line">    <span class="keyword">return</span> parMap;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>
<p>访问:<span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="http://localhost:8080/users/no/annotation?par1=3&amp;par2=4&amp;str3=aaa">http://localhost:8080/users/no/annotation?par1=3&amp;par2=4&amp;str3=aaa</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p><strong>注意:参数的名称要与http请求的参数名称保持一致。</strong></p>

        <h4 id="2-RequestParam传递参数">
          <a href="#2-RequestParam传递参数" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-RequestParam传递参数" class="headerlink" title="2.@RequestParam传递参数"></a>2.@RequestParam传递参数</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/have/annotationParam&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">getParamMap</span><span class="params">(<span class="meta">@RequestParam(value = &quot;par1&quot;,required = false)</span> String par1,<span class="meta">@RequestParam(value = &quot;par2&quot;,required = false)</span> String par2)</span>&#123;</span><br><span class="line"></span><br><span class="line">    Map&lt;String,Object&gt; paraMap = <span class="keyword">new</span> <span class="title class_">LinkedHashMap</span>&lt;&gt;();</span><br><span class="line">    paraMap.put(<span class="string">&quot;par1&quot;</span>,par1);</span><br><span class="line">    paraMap.put(<span class="string">&quot;par2&quot;</span>,par2);</span><br><span class="line">    <span class="keyword">return</span> paraMap;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<blockquote>
<p>required属性可以支持传递的参数为空</p>
</blockquote>

        <h4 id="3-传递数组">
          <a href="#3-传递数组" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-传递数组" class="headerlink" title="3.传递数组"></a>3.传递数组</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/arrParam&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">getArrParameter</span><span class="params">(<span class="type">int</span>[] intarr,<span class="type">long</span>[] longarr,String[] strarr)</span>&#123;</span><br><span class="line"></span><br><span class="line">    Map&lt;String,Object&gt; arrMap = <span class="keyword">new</span> <span class="title class_">LinkedHashMap</span>&lt;&gt;();</span><br><span class="line">    arrMap.put(<span class="string">&quot;intarr&quot;</span>,intarr);</span><br><span class="line">    arrMap.put(<span class="string">&quot;longarr&quot;</span>,longarr);</span><br><span class="line">    arrMap.put(<span class="string">&quot;strarr&quot;</span>,strarr);</span><br><span class="line">    <span class="keyword">return</span> arrMap;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<blockquote>
<p>访问地址<span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="http://localhost:8080/users/arrParam?intarr=1,2,3&amp;longarr=4,5,6&amp;strarr=a,b,c">http://localhost:8080/users/arrParam?intarr=1,2,3&amp;longarr=4,5,6&amp;strarr=a,b,c</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
</blockquote>
<blockquote>
<p>可以看到，传递数组时，每个参数的数组元素只需要通过逗号分隔开即可</p>
</blockquote>

        <h4 id="4-传递JSON">
          <a href="#4-传递JSON" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-传递JSON" class="headerlink" title="4.传递JSON"></a>4.传递JSON</h4>
      <p><strong>搭建表单JSP文件</strong></p>
<figure class="highlight jsp"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page pageEncoding=<span class="string">&quot;utf-8&quot;</span>%&gt;</span><br><span class="line">&lt;%@ taglib prefix=<span class="string">&quot;c&quot;</span> uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span>%&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;添加用户&lt;/title&gt;</span><br><span class="line">    &lt;<span class="type">script</span> <span class="variable">src</span> <span class="operator">=</span> <span class="string">&quot;https://code.jquery.com/jquery-3.0.0.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">        &lt;table&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">                &lt;td&gt;</span><br><span class="line">                    用户名称：</span><br><span class="line">                &lt;/td&gt;</span><br><span class="line">                &lt;td&gt;</span><br><span class="line">                    &lt;<span class="type">input</span> <span class="variable">id</span> <span class="operator">=</span> <span class="string">&quot;userName&quot;</span> name = <span class="string">&quot;userName&quot;</span>/&gt;</span><br><span class="line">                &lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">                &lt;td&gt;</span><br><span class="line">                    备注：</span><br><span class="line">                &lt;/td&gt;</span><br><span class="line">                &lt;td&gt;</span><br><span class="line">                    &lt;<span class="type">input</span> <span class="variable">id</span> <span class="operator">=</span> <span class="string">&quot;userRemark&quot;</span> name = <span class="string">&quot;userRemark&quot;</span>/&gt;</span><br><span class="line">                &lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">                &lt;td colspan=<span class="string">&quot;2&quot;</span>&gt;</span><br><span class="line">                    &lt;<span class="type">button</span> <span class="variable">id</span> <span class="operator">=</span> <span class="string">&quot;userSubmit&quot;</span>&gt;</span><br><span class="line">                        提交</span><br><span class="line">                    &lt;/button&gt;</span><br><span class="line"></span><br><span class="line">                &lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">        &lt;/table&gt;</span><br><span class="line"></span><br><span class="line">&lt;script type=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line">    $(function()&#123;</span><br><span class="line">       $(<span class="string">&quot;#userSubmit&quot;</span>) .click(function()&#123;</span><br><span class="line">           <span class="comment">//获取表单输入的值</span></span><br><span class="line">          <span class="type">var</span> <span class="variable">userName</span> <span class="operator">=</span> $(<span class="string">&quot;#userName&quot;</span>).val();</span><br><span class="line">          <span class="type">var</span> <span class="variable">userRemark</span> <span class="operator">=</span> $(<span class="string">&quot;#userRemark&quot;</span>).val();</span><br><span class="line"></span><br><span class="line">          <span class="type">var</span> <span class="variable">params</span> <span class="operator">=</span> &#123;&#125;;</span><br><span class="line">          params.name = userName;</span><br><span class="line">          params.remark = userRemark;</span><br><span class="line"></span><br><span class="line">          $.post(&#123;</span><br><span class="line">              url : <span class="string">&quot;./addUserInfo&quot;</span>,</span><br><span class="line">              <span class="comment">//告知传递的类型为json，不可缺少</span></span><br><span class="line">              contentType : <span class="string">&quot;application/json&quot;</span>,</span><br><span class="line">              <span class="comment">//将JSON转化为字符串传递</span></span><br><span class="line">              data : JSON.stringify(params),</span><br><span class="line">              <span class="comment">//成功后的回调方法</span></span><br><span class="line">              success : function(result)&#123;</span><br><span class="line">                  <span class="keyword">if</span>(result == <span class="literal">null</span>||result.id == <span class="literal">null</span>)&#123;</span><br><span class="line">                      alert(<span class="string">&quot;插入失败!&quot;</span>);</span><br><span class="line">                      <span class="keyword">return</span>;</span><br><span class="line">                  &#125;</span><br><span class="line">                  alert(<span class="string">&quot;插入成功！！&quot;</span>);</span><br><span class="line"></span><br><span class="line">              &#125;</span><br><span class="line">          &#125;);</span><br><span class="line">       &#125;);</span><br><span class="line"></span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></div></figure>

<p><strong>控制器方法(访问页面和添加数据的方法)</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 访问添加用户对象的页面</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/add&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">addUserPage</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;/user/add&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 添加数据</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/addUserInfo&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> ServerUser <span class="title function_">addServerUser</span><span class="params">(<span class="meta">@RequestBody</span> ServerUser sUser)</span>&#123;</span><br><span class="line">    <span class="type">ServerUser</span> <span class="variable">serUser</span> <span class="operator">=</span> uSer.insertServerUser(sUser);</span><br><span class="line">    <span class="keyword">return</span> serUser;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<blockquote>
<p>在控制器的第二个方法addServerUser中，参数标注为@RequestBody，意味着它将接受前端提交的JSON请求体，而前端JSON数据的请求体与ServerUser类之间的属性名称是保持一致的，这样SpringMVC就会通过这层映射关系将JSON请求体转换为ServerUser对象。</p>
</blockquote>
<p><strong>添加测试</strong></p>

        <h4 id="5-通过URL传递数据">
          <a href="#5-通过URL传递数据" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-通过URL传递数据" class="headerlink" title="5.通过URL传递数据"></a>5.通过URL传递数据</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 通过URL传递数据</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> ServerUser <span class="title function_">getUrlParamSerUser</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Long id)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> uSer.getServerUser(id);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<blockquote>
<p>一些网站中，提供了REST风格，这时的参数往往通过URL传递。例如获取编号为1的用户，URL就要写为&#x2F;user&#x2F;1，1代表用户编号。可以通过处理器映射和注解@PathVariable的组合获取URL参数。例如以上控制器的方法就可以使用网址<span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="http://localhost:8080/users/16">http://localhost:8080/users/16</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>访问编号为16的用户信息。</p>
</blockquote>
<p><strong>JSP页面</strong></p>
<figure class="highlight jsp"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="type">form</span> <span class="variable">action</span> <span class="operator">=</span> <span class="string">&quot;./formatParam&quot;</span> method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">    &lt;<span class="type">input</span> <span class="variable">type</span> <span class="operator">=</span> <span class="string">&quot;text&quot;</span> name = <span class="string">&quot;date1&quot;</span> value = <span class="string">&quot;2019-12-15&quot;</span>/&gt;</span><br><span class="line">    &lt;<span class="type">input</span> <span class="variable">type</span> <span class="operator">=</span> <span class="string">&quot;text&quot;</span> name = <span class="string">&quot;number1&quot;</span> value = <span class="string">&quot;1,234,567.89&quot;</span>/&gt;</span><br><span class="line">    &lt;<span class="type">input</span> <span class="variable">type</span> <span class="operator">=</span> <span class="string">&quot;submit&quot;</span> value = <span class="string">&quot;提交&quot;</span>/&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></div></figure>

<p><strong>控制器</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 获取格式化参数</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/formatParam&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">getFormatterParams</span><span class="params">(<span class="meta">@DateTimeFormat(iso = DateTimeFormat.ISO.DATE)</span> Date date1, <span class="meta">@NumberFormat(pattern = &quot;#,###.##&quot;)</span> Double number1)</span>&#123;</span><br><span class="line">    Map&lt;String,Object&gt; formatNums = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    formatNums.put(<span class="string">&quot;date&quot;</span>,date1);</span><br><span class="line">    formatNums.put(<span class="string">&quot;nums&quot;</span>,number1);</span><br><span class="line">    <span class="keyword">return</span> formatNums;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>提交后页面数据显示:</p>
<p><img src="/2020/06/17/Spring-MVC%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0v1/QQ%E6%88%AA%E5%9B%BE20200624191746.png"></p>

        <h4 id="6-一对一转换器">
          <a href="#6-一对一转换器" class="heading-link"><i class="fas fa-link"></i></a><a href="#6-一对一转换器" class="headerlink" title="6.一对一转换器"></a>6.一对一转换器</h4>
      <p><strong>字符串用户转换器</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.rediscachetest.tools;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.rediscachetest.pojo.ServerUser;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.convert.converter.Converter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StringToUserConvert</span> <span class="keyword">implements</span> <span class="title class_">Converter</span>&lt;String, ServerUser&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> ServerUser <span class="title function_">convert</span><span class="params">(String s)</span> &#123;</span><br><span class="line">        <span class="type">ServerUser</span> <span class="variable">suser</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServerUser</span>();</span><br><span class="line">        String[] strArr = s.split(<span class="string">&quot;-&quot;</span>);</span><br><span class="line">        <span class="type">Long</span> <span class="variable">id</span> <span class="operator">=</span> Long.parseLong(strArr[<span class="number">0</span>]);</span><br><span class="line">        <span class="type">String</span> <span class="variable">userName</span> <span class="operator">=</span> strArr[<span class="number">1</span>];</span><br><span class="line">        <span class="type">String</span> <span class="variable">remark</span> <span class="operator">=</span> strArr[<span class="number">2</span>];</span><br><span class="line">        suser.setId(id);</span><br><span class="line">        suser.setName(userName);</span><br><span class="line">        suser.setRemark(remark);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> suser;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<blockquote>
<p>这里的类标注为@Component，并且实现了Converter接口，这样Spring就会将这个类扫描并装配到IoC容器中。这里的泛型指定为String和ServerUser，这样SpringMVC就会通过HTTP的参数类型（String）和控制器的参数类型（ServerUser）进行匹配，就可以从注册机制中发现这个转换类，这样就能够将参数转换出来。</p>
</blockquote>
<p><strong>控制器验证</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/convertTest&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> ServerUser <span class="title function_">getUserByConverter</span><span class="params">(ServerUser serverUser)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> serverUser;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>输入地址：<span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="http://localhost:8080/users/convertTest?serverUser=1--note_1&amp;date=2018-01-01">http://localhost:8080/users/convertTest?serverUser=1--note_1&amp;date=2018-01-01</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p>如此一来就可以得到用户的id和备注</p>

        <h2 id="数据验证">
          <a href="#数据验证" class="heading-link"><i class="fas fa-link"></i></a><a href="#数据验证" class="headerlink" title="数据验证"></a>数据验证</h2>
      
        <h3 id="JSR-303验证">
          <a href="#JSR-303验证" class="heading-link"><i class="fas fa-link"></i></a><a href="#JSR-303验证" class="headerlink" title="JSR-303验证"></a>JSR-303验证</h3>
      <p><strong>验证POJO类</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.rediscachetest.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.type.Alias;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.validator.constraints.Range;</span><br><span class="line"><span class="keyword">import</span> org.springframework.format.annotation.DateTimeFormat;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.validation.constraints.*;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="meta">@Alias(&quot;validdate&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ValidatorPojo</span> &#123;</span><br><span class="line">    <span class="meta">@NotNull(message = &quot;Id不能为空&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long Id;</span><br><span class="line">    <span class="meta">@NotNull(message = &quot;日期不能为空&quot;)</span></span><br><span class="line">    <span class="meta">@Future(message = &quot;需要一个将来的日期&quot;)</span></span><br><span class="line">    <span class="meta">@DateTimeFormat(pattern = &quot;yyyy-MM-dd&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Date Date;</span><br><span class="line">    <span class="meta">@NotNull</span></span><br><span class="line">    <span class="meta">@DecimalMin(value = &quot;0.1&quot;)</span></span><br><span class="line">    <span class="meta">@DecimalMax(value = &quot;10000.00&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Double DoubleValue;</span><br><span class="line">    <span class="meta">@Min(value = 1,message = &quot;最小值为1&quot;)</span></span><br><span class="line">    <span class="meta">@Max(value = 3,message = &quot;最大值为3&quot;)</span></span><br><span class="line">    <span class="meta">@NotNull</span></span><br><span class="line">    <span class="keyword">private</span> Integer IntegerValue;</span><br><span class="line">    <span class="meta">@org</span>.hibernate.validator.constraints.Range(min = <span class="number">1</span>,max = <span class="number">888</span>,message = <span class="string">&quot;范围1-888&quot;</span>)</span><br><span class="line">    <span class="meta">@NotNull</span></span><br><span class="line">    <span class="keyword">private</span> Long Range;</span><br><span class="line">    <span class="meta">@Email(message = &quot;邮箱格式错误&quot;)</span></span><br><span class="line">    <span class="meta">@NotNull</span></span><br><span class="line">    <span class="keyword">private</span> String Email;</span><br><span class="line">    <span class="meta">@Size(min = 20,max = 30,message = &quot;字段长度20-30&quot;)</span></span><br><span class="line">    <span class="meta">@NotNull</span></span><br><span class="line">    <span class="keyword">private</span> String Size;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">	 *set/get</span></span><br><span class="line"><span class="comment">	 **/</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p><strong>ajax发送请求</strong></p>
<figure class="highlight jsp"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page pageEncoding=<span class="string">&quot;utf-8&quot;</span>%&gt;</span><br><span class="line">&lt;%@ taglib prefix=<span class="string">&quot;c&quot;</span> uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span>%&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;验证用户&lt;/title&gt;</span><br><span class="line">    &lt;<span class="type">script</span> <span class="variable">src</span> <span class="operator">=</span> <span class="string">&quot;https://code.jquery.com/jquery-3.0.0.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;script type=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line">    $(function()&#123;</span><br><span class="line">            <span class="comment">//获取表单输入的值</span></span><br><span class="line">            <span class="type">var</span> <span class="variable">pojo</span> <span class="operator">=</span> &#123;</span><br><span class="line">                id:<span class="literal">null</span>,</span><br><span class="line">                date:<span class="string">&quot;2017-08-08&quot;</span>,</span><br><span class="line">                doubleValue:<span class="number">1999999.09</span>,</span><br><span class="line">                integerValue:<span class="number">100</span>,</span><br><span class="line">                range:<span class="number">1000</span>,</span><br><span class="line">                email:<span class="string">&quot;email&quot;</span>,</span><br><span class="line">                size:<span class="string">&#x27;adv1212&#x27;</span>,</span><br><span class="line">            &#125;;</span><br><span class="line">            $.post(&#123;</span><br><span class="line">                url : <span class="string">&quot;./validate&quot;</span>,</span><br><span class="line">                <span class="comment">//告知传递的类型为json，不可缺少</span></span><br><span class="line">                contentType : <span class="string">&quot;application/json&quot;</span>,</span><br><span class="line">                <span class="comment">//将JSON转化为字符串传递</span></span><br><span class="line">                data : JSON.stringify(pojo),</span><br><span class="line">                <span class="comment">//成功后的回调方法</span></span><br><span class="line">                success : function(result)&#123;</span><br><span class="line">                    console.info(result);</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></div></figure>

<blockquote>
<p>注意此处json数据需要和封装类的属性对应，且json数据的属性开头字母必须小写</p>
</blockquote>
<p><strong>控制器</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">@GetMapping(&quot;/page/trans&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">returnPageVali</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;/user/valid&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@RequestMapping(&quot;/page/validate&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">validate</span><span class="params">(<span class="meta">@Valid</span> <span class="meta">@RequestBody</span> ValidatorPojo vpo, Errors errors)</span>&#123;</span><br><span class="line">    Map&lt;String,Object&gt; errMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    List&lt;ObjectError&gt; oes = errors.getAllErrors();</span><br><span class="line">    <span class="keyword">for</span>(ObjectError oe:oes)&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">msg</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span>(oe <span class="keyword">instanceof</span> FieldError)&#123;</span><br><span class="line">            <span class="type">FieldError</span> <span class="variable">fe</span> <span class="operator">=</span> (FieldError)oe;</span><br><span class="line">            key = fe.getField();<span class="comment">//获取错误字段名</span></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            key = oe.getObjectName();<span class="comment">//获取验证对象名称</span></span><br><span class="line">        &#125;</span><br><span class="line">        msg = oe.getDefaultMessage();</span><br><span class="line">        errMap.put(key,msg);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> errMap;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<blockquote>
<p>由于一开始访问的jsp页面的路径中包含<strong>page</strong>，所以ajax访问的控制器方法的路径也需要包含page。在一开始访问jsp页面时路径中就包含了<strong>page</strong>路径，所以在ajax访问控制器路径时不需要加上<strong>page</strong>的路径。</p>
</blockquote>
<blockquote>
<p>@Valid注解表示启动验证机制。他会自动将最后的验证结果放入Errors对象中，这样就可以从中得到相关验证过后的信息。</p>
</blockquote>
<p><strong>结果</strong></p>
<p><img src="/2020/06/17/Spring-MVC%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0v1/QQ%E6%88%AA%E5%9B%BE20200628183852.png"></p>

        <h3 id="参数验证机制">
          <a href="#参数验证机制" class="heading-link"><i class="fas fa-link"></i></a><a href="#参数验证机制" class="headerlink" title="参数验证机制"></a>参数验证机制</h3>
      <p><strong>自定义用户验证器</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.rediscachetest.validator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.rediscachetest.pojo.ServerUser;</span><br><span class="line"><span class="keyword">import</span> org.springframework.util.StringUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.validation.Errors;</span><br><span class="line"><span class="keyword">import</span> org.springframework.validation.Validator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserValidator</span> <span class="keyword">implements</span> <span class="title class_">Validator</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">supports</span><span class="params">(Class&lt;?&gt; aClass)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> aClass.equals(ServerUser.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">validate</span><span class="params">(Object o, Errors errors)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(o == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="comment">//直接在参数处报错，这样就无法进入控制器</span></span><br><span class="line">            errors.rejectValue(<span class="string">&quot;&quot;</span>,<span class="literal">null</span>,<span class="string">&quot;用户不能为空&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">ServerUser</span> <span class="variable">sUser</span> <span class="operator">=</span> (ServerUser)o;</span><br><span class="line">        <span class="keyword">if</span>(StringUtils.isEmpty(sUser.getName()))&#123;</span><br><span class="line">            errors.rejectValue(<span class="string">&quot;name&quot;</span>,<span class="literal">null</span>,<span class="string">&quot;用户名不能为空&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<blockquote>
<p>其中，support方法参数为需要验证的POJO类型。若返回为true，则Spring会使用当前验证器的validate方法去验证POJO。validate方法包含需要额target对象和错误对象errors，其中，target是参数绑定后的POJO，如果发现错误，则会保存在errors对象中，然后返回给控制器。</p>
</blockquote>
<p><strong>虽然有了这个验证器，但是Spring还不会启用它，因为还没有绑定WebDataBinder机制。这里提供了注解@InitBinder,他的作用是在执行控制器的方法前，处理器会先执行被@InitBinder标注额地方法。这时可以将WebDataBinder对象作为参数传递到方法中。通过这层关系得到WebDataBinder对象，此对象有一个setValidator方法，可以绑定自定义的验证器，这样就可以获取参数后，通过自定义的验证器去验证参数。WebDataBinder除了可以绑定验证器外，还可以进行参数的自定义。</strong></p>
<p><strong>绑定验证器</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 调用控制器前先执行此方法</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> binder</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@InitBinder</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initBinder</span><span class="params">(WebDataBinder binder)</span>&#123;</span><br><span class="line">    binder.setValidator(<span class="keyword">new</span> <span class="title class_">UserValidator</span>());</span><br><span class="line">    <span class="comment">//定义日期参数格式，参数不在需要注解@DateTimeFormat，boolean参数表示是否允许为空</span></span><br><span class="line">    binder.registerCustomEditor(Date.class,<span class="keyword">new</span> <span class="title class_">CustomDateEditor</span>(<span class="keyword">new</span> <span class="title class_">SimpleDateFormat</span>(<span class="string">&quot;yyyy-MM-dd&quot;</span>),<span class="literal">false</span>));</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@GetMapping(&quot;/validatorOne&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">validator</span><span class="params">(<span class="meta">@Valid</span> ServerUser serverUserOne,Errors errorrs,Date date)</span>&#123;</span><br><span class="line">    Map&lt;String,Object&gt; mapObj = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    mapObj.put(<span class="string">&quot;ServerUser&quot;</span>,serverUserOne);</span><br><span class="line">    mapObj.put(<span class="string">&quot;date&quot;</span>,date);</span><br><span class="line">    <span class="comment">//判断是否存在错误</span></span><br><span class="line">    List&lt;ObjectError&gt; oes = errorrs.getAllErrors();</span><br><span class="line">    <span class="keyword">for</span>(ObjectError oe:oes)&#123;</span><br><span class="line">        <span class="keyword">if</span>(oe <span class="keyword">instanceof</span> FieldError)&#123;</span><br><span class="line">            <span class="type">FieldError</span> <span class="variable">fe</span> <span class="operator">=</span> (FieldError)oe;</span><br><span class="line">            mapObj.put(fe.getField(),fe.getDefaultMessage());</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            mapObj.put(oe.getObjectName(),oe.getDefaultMessage());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> mapObj;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>最后访问地址<span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="http://localhost:8080/users/validatorOne?serverUser=1--note_1&amp;date=2018-01-01%E3%80%82">http://localhost:8080/users/validatorOne?serverUser=1--note_1&amp;date=2018-01-01。</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>

        <h2 id="数据模型">
          <a href="#数据模型" class="heading-link"><i class="fas fa-link"></i></a><a href="#数据模型" class="headerlink" title="数据模型"></a>数据模型</h2>
      <p>数据模型的作用就是绑定数据，为后面的视图渲染做准备。</p>
<p><strong>如果在控制器的方法中的参数中使用ModelAndView，Model，ModelMap作为参数类型，SpringMVC会自动创建数据模型对象。如下代码:</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.rediscachetest.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.rediscachetest.pojo.ServerUser;</span><br><span class="line"><span class="keyword">import</span> com.example.rediscachetest.serviceImpl.userServiceImpl;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ui.Model;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ui.ModelMap;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ResponseBody;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/models&quot;)</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">modelController</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> userServiceImpl uServ;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/mod1&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getModelUser</span><span class="params">(Long id, Model moodel)</span>&#123;</span><br><span class="line">        <span class="type">ServerUser</span> <span class="variable">suser</span> <span class="operator">=</span> uServ.getServerUser(id);</span><br><span class="line">        moodel.addAttribute(<span class="string">&quot;user&quot;</span>,suser);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;/user/detail&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/mod2&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ModelAndView <span class="title function_">userModelMap</span><span class="params">(Long id, ModelMap modelMap)</span>&#123;</span><br><span class="line">        <span class="type">ServerUser</span> <span class="variable">serverUser</span> <span class="operator">=</span> uServ.getServerUser(id);</span><br><span class="line">        <span class="type">ModelAndView</span> <span class="variable">mv1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ModelAndView</span>();</span><br><span class="line">        <span class="comment">//设置视图名称</span></span><br><span class="line">        mv1.setViewName(<span class="string">&quot;/user/detail&quot;</span>);</span><br><span class="line">        <span class="comment">//设置视图模型，此处modelMap并没有与mv绑定，这个步骤系统会自动处理</span></span><br><span class="line">        modelMap.put(<span class="string">&quot;user&quot;</span>,serverUser);</span><br><span class="line">        <span class="keyword">return</span> mv1;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/mod3&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ModelAndView <span class="title function_">useModelAndView</span><span class="params">(Long id,ModelAndView mv)</span>&#123;</span><br><span class="line">        <span class="type">ServerUser</span> <span class="variable">serverUser</span> <span class="operator">=</span> uServ.getServerUser(id);</span><br><span class="line">        mv.setViewName(<span class="string">&quot;/user/detail&quot;</span>);</span><br><span class="line">        mv.addObject(<span class="string">&quot;user&quot;</span>,serverUser);</span><br><span class="line">        <span class="keyword">return</span>  mv;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<blockquote>
<p>从上述代码中可以看出，SpringMVC是比较智能的，比如第一个控制器的方法啊只是返回了一个字符串，SpringMVC便会自动生成对应的视图，并且绑定数据模型，第二个方法中，返回的是ModelAndView对象，但是并没有绑定ModelMap对象，SpringMVC会自动绑定它。上述数据对象，使用哪一个都是可以的，因为他们都是渲染的同一个jsp视图，这样通过定位，就可以将数据渲染到JSP中了。</p>
</blockquote>

        <h2 id="SpringMVC文件上传">
          <a href="#SpringMVC文件上传" class="heading-link"><i class="fas fa-link"></i></a><a href="#SpringMVC文件上传" class="headerlink" title="SpringMVC文件上传"></a>SpringMVC文件上传</h2>
      <p><strong>1. SpringMVC上传文件配置</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">spring.servlet.multipart.location=d:/Otherfiles/JSPdownload</span><br><span class="line">spring.servlet.multipart.max-file-size=<span class="number">5242880</span></span><br><span class="line">spring.servlet.multipart.max-request-size=20MB</span><br></pre></td></tr></table></div></figure>

<p><strong>2. JSP文件</strong></p>
<figure class="highlight jsp"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page pageEncoding=<span class="string">&quot;utf-8&quot;</span>%&gt;</span><br><span class="line">&lt;%@ taglib prefix=<span class="string">&quot;c&quot;</span> uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span>%&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;上传文件&lt;/title&gt;</span><br><span class="line">    &lt;<span class="type">script</span> <span class="variable">src</span> <span class="operator">=</span> <span class="string">&quot;https://code.jquery.com/jquery-3.0.0.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">    &lt;<span class="type">form</span> <span class="variable">method</span> <span class="operator">=</span> <span class="string">&quot;post&quot;</span> action = <span class="string">&quot;./requests&quot;</span> enctype=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span><br><span class="line">        &lt;input type=<span class="string">&quot;file&quot;</span> name = <span class="string">&quot;file&quot;</span> value = <span class="string">&quot;请选择上传的文件&quot;</span>&gt;</span><br><span class="line">        &lt;<span class="type">input</span> <span class="variable">type</span> <span class="operator">=</span> <span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;提交&quot;</span>&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></div></figure>

<blockquote>
<p>此处form表单声明为  multipart&#x2F;form-data ,如果没有这个声明，SpringMVC就会解析文件请求出错。method的属性也必须是POST</p>
</blockquote>
<p><strong>3. 文件上传控制器</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 打开文件上传的请求界面</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/uploads/pages&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">openUpPage</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;user/upload&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 上传文件</span></span><br><span class="line"><span class="comment"> * 使用HttpServletRequest作为参数</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/uploads/requests&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">uploadRequest</span><span class="params">(HttpServletRequest request)</span>&#123;</span><br><span class="line">    <span class="type">MultipartHttpServletRequest</span> <span class="variable">mreq</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">if</span>(request <span class="keyword">instanceof</span> MultipartHttpServletRequest)&#123;</span><br><span class="line">        mreq = (MultipartHttpServletRequest)request;</span><br><span class="line"></span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> dealResultMap(<span class="literal">false</span>,<span class="string">&quot;上传失败&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//获取MultipartFile信息</span></span><br><span class="line">    <span class="type">MultipartFile</span> <span class="variable">mf</span> <span class="operator">=</span> mreq.getFile(<span class="string">&quot;file&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">filename</span> <span class="operator">=</span> mf.getOriginalFilename();</span><br><span class="line">    <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(filename);</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        mf.transferTo(file);</span><br><span class="line">    &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">        e.printStackTrace();;</span><br><span class="line">        <span class="keyword">return</span> dealResultMap(<span class="literal">false</span>,<span class="string">&quot;上传失败&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dealResultMap(<span class="literal">true</span>,<span class="string">&quot;上传成功&quot;</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 使用MultipartFile作为参数</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> file</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/uploads/multipart&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">uplloadMultipartFile</span><span class="params">(MultipartFile file)</span>&#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">fileName</span> <span class="operator">=</span> file.getOriginalFilename();</span><br><span class="line">    <span class="type">File</span> <span class="variable">dest</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(fileName);</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        file.transferTo(dest);</span><br><span class="line">    &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">        <span class="keyword">return</span> dealResultMap(<span class="literal">false</span>,<span class="string">&quot;上传失败&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dealResultMap(<span class="literal">true</span>,<span class="string">&quot;上传成功&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 使用Part作为参数</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> file</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/uploads/part&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">uploadPart</span><span class="params">(Part file)</span>&#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">fileName</span> <span class="operator">=</span> file.getSubmittedFileName();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        file.write(fileName);</span><br><span class="line">    &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">        <span class="keyword">return</span> dealResultMap(<span class="literal">false</span>,<span class="string">&quot;上传失败&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dealResultMap(<span class="literal">true</span>,<span class="string">&quot;上传成功&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 处理上传文件结果</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> success</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> msg</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">dealResultMap</span><span class="params">(<span class="type">boolean</span> success,String msg)</span>&#123;</span><br><span class="line">    Map&lt;String,Object&gt; result = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;String,Object&gt;();</span><br><span class="line">    result.put(<span class="string">&quot;success&quot;</span>,success);</span><br><span class="line">    result.put(<span class="string">&quot;msg&quot;</span>,msg);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<blockquote>
<p>参数是HttpServletRequest对象时。在调用控制器之前，DispatcherSerrvlet会将其转换为iMultipartHttpServletRequest对象，所以方法中使用了强制转换。通过transferTo方法，就可以将文件保存到对应的路径中。</p>
</blockquote>

        <h2 id="定义多个拦截器">
          <a href="#定义多个拦截器" class="heading-link"><i class="fas fa-link"></i></a><a href="#定义多个拦截器" class="headerlink" title="定义多个拦截器"></a>定义多个拦截器</h2>
      <p><strong>1. 定义拦截器</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.rediscachetest.interceptor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.HandlerInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">selfInterceptor</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;处理前方法1&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">postHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;处理后方法1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;处理完成方法1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.rediscachetest.interceptor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.HandlerInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">selfInteceptor2</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;处理前方法2&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">postHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;处理后方法2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;处理完成方法2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.rediscachetest.interceptor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.HandlerInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">selfInterceptor3</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;处理前方法3&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">postHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;处理后方法3&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;处理完成方法3&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p><strong>2. 注册多个拦截器</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.rediscachetest;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.rediscachetest.interceptor.selfInteceptor2;</span><br><span class="line"><span class="keyword">import</span> com.example.rediscachetest.interceptor.selfInterceptor;</span><br><span class="line"><span class="keyword">import</span> com.example.rediscachetest.interceptor.selfInterceptor3;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.spring.annotation.MapperScan;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Repository;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.InterceptorRegistration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.InterceptorRegistry;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurer;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication(scanBasePackages = &quot;com.example.rediscachetest&quot;)</span></span><br><span class="line"><span class="meta">@MapperScan(basePackages = &quot;com.example.rediscachetest.*&quot;,annotationClass = Repository.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RediscachetestApplication</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(RediscachetestApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span>&#123;</span><br><span class="line">        <span class="type">InterceptorRegistration</span> <span class="variable">ir</span> <span class="operator">=</span> registry.addInterceptor(<span class="keyword">new</span> <span class="title class_">selfInterceptor</span>());</span><br><span class="line">        ir.addPathPatterns(<span class="string">&quot;/interceptor/*&quot;</span>);</span><br><span class="line">        <span class="type">InterceptorRegistration</span> <span class="variable">ir1</span> <span class="operator">=</span> registry.addInterceptor(<span class="keyword">new</span> <span class="title class_">selfInteceptor2</span>());</span><br><span class="line">        ir1.addPathPatterns(<span class="string">&quot;/interceptor/*&quot;</span>);</span><br><span class="line">        <span class="type">InterceptorRegistration</span> <span class="variable">ir2</span> <span class="operator">=</span> registry.addInterceptor(<span class="keyword">new</span> <span class="title class_">selfInterceptor3</span>());</span><br><span class="line">        ir2.addPathPatterns(<span class="string">&quot;/interceptor/*&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<blockquote>
<p>这些拦截器都会拦截与“&#x2F;interceptor&#x2F;*”匹配的请求。</p>
</blockquote>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.rediscachetest.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/interceptor&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">intercepController</span> &#123;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/reqPage&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">reqPages</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;/user/add&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p>那么访问控制器后执行的结果是责任链模式的规则，对于处理器前方法采用先注册先执行，而处理器后方法和完成方法则是先注册后执行的规则。</p>
<p>上述只是测试的处理签方法返回为true的情况。如果将第二个注册的拦截器的处理前方法返回为false，则后续的拦截器，处理和所有拦截器的处理后方法都不会执行。完成方法afterCompletion则不一样，它知会执行返回true的拦截器的完成方法。而且顺序是先注册后执行</p>

        <h2 id="重定向">
          <a href="#重定向" class="heading-link"><i class="fas fa-link"></i></a><a href="#重定向" class="headerlink" title="重定向"></a>重定向</h2>
      <p><strong>控制器方法</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//显示用户</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/show&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">showUser</span><span class="params">(Long id,Model model)</span>&#123;</span><br><span class="line">	<span class="type">ServerUser</span> <span class="variable">user</span> <span class="operator">=</span> uServ.getServerUser(id);</span><br><span class="line">	model.addAttribute(<span class="string">&quot;user&quot;</span>,user);</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&quot;user/detail&quot;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@GetMapping(&quot;/redirect1&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">redirect1</span><span class="params">(String name,String remark)</span>&#123;</span><br><span class="line">    <span class="type">ServerUser</span> <span class="variable">sUser</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServerUser</span>();</span><br><span class="line">    sUser.setName(name);</span><br><span class="line">    sUser.setRemark(remark);</span><br><span class="line">    <span class="comment">//插入数据库后，回填ServerUser的Id</span></span><br><span class="line">    uServ.insertServerUser(sUser);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;redirect:/models/show?id=&quot;</span>+sUser.getId();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<blockquote>
<p>首先，添加用户信息进入到<strong>redirect1</strong>的方法中，新增用户数据库会返回用户编号，然后通过以”redirect:”开头的字符串。并以id作为参数传递，这样就能够调用这个请求，跳转到展示用户的界面</p>
</blockquote>
<p><strong>如果采用数据模型重定向</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/redirect2&quot;)</span></span><br><span class="line"><span class="keyword">public</span> ModelAndView <span class="title function_">redirect2</span><span class="params">(String name,String remark)</span>&#123;</span><br><span class="line">    <span class="type">ServerUser</span> <span class="variable">sUser</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServerUser</span>();</span><br><span class="line">    sUser.setName(name);</span><br><span class="line">    sUser.setRemark(remark);</span><br><span class="line">    <span class="comment">//插入数据库后，回填ServerUser的Id</span></span><br><span class="line">    uServ.insertServerUser(sUser);</span><br><span class="line">	<span class="type">ModelAndView</span> <span class="variable">mv</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ModelAndView</span>();</span><br><span class="line">	mv.setViewName(<span class="string">&quot;redirect:/models/show?id=&quot;</span>+sUser.getId());</span><br><span class="line">    <span class="keyword">return</span> mv;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p><strong>重定向传递Java对象</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//显示用户</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/show&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">showUser</span><span class="params">(ServerUser user,Model model)</span>&#123;</span><br><span class="line">	model.addAttribute(<span class="string">&quot;user&quot;</span>,user);</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&quot;user/detail&quot;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@GetMapping(&quot;/redirect1&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">redirect1</span><span class="params">(String name,String remark,RedirectAttributes ra)</span>&#123;</span><br><span class="line">    <span class="type">ServerUser</span> <span class="variable">sUser</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServerUser</span>();</span><br><span class="line">    sUser.setName(name);</span><br><span class="line">    sUser.setRemark(remark);</span><br><span class="line">    <span class="comment">//插入数据库后，回填ServerUser的Id</span></span><br><span class="line">    uServ.insertServerUser(sUser);</span><br><span class="line">	ra.addFlashAttribute(<span class="string">&quot;user&quot;</span>,user);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;redirect:/models/show&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h2 id="操作会话对象">
          <a href="#操作会话对象" class="heading-link"><i class="fas fa-link"></i></a><a href="#操作会话对象" class="headerlink" title="操作会话对象"></a>操作会话对象</h2>
      <p>SpringMVC提供了支持，主要是两个注解用来操作HttpSession对象。**@SessionAttribute和@SessionAttributes<strong>。前者应用于参数，主要是读取HttpSession得属性，后者只能用于类得注解，它会将相关</strong>数据模型**得属性保存到Session中。</p>
<p><strong>控制器</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.rediscachetest.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.rediscachetest.pojo.ServerUser;</span><br><span class="line"><span class="keyword">import</span> com.example.rediscachetest.serviceImpl.userServiceImpl;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SessionAttributes(names = &#123;&quot;users&quot;,&quot;ServerUser&quot;&#125;,types = Long.class)</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/session&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">intercepController</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">userServiceImpl</span> <span class="variable">userService</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/test&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="keyword">public</span> ModelAndView <span class="title function_">reqPages</span><span class="params">(<span class="meta">@SessionAttribute</span> (<span class="string">&quot;id&quot;</span>)</span> Long id)&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;session取出值Id:&quot;</span>+id);</span><br><span class="line">        <span class="type">ServerUser</span> <span class="variable">user</span> <span class="operator">=</span> userService.getServerUser(id);</span><br><span class="line">        <span class="type">ModelAndView</span> <span class="variable">mav</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ModelAndView</span>();</span><br><span class="line">        mav.addObject(<span class="string">&quot;id_new&quot;</span>,id);</span><br><span class="line">        mav.addObject(<span class="string">&quot;users&quot;</span>,user);</span><br><span class="line">        mav.setViewName(<span class="string">&quot;user/getsession&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> mav;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/sessionPage&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getSessPage</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;user/session&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<blockquote>
<p>SessionAttributes注解中得names属性表示数据模型中名称为users或者SessionAttributes会被保存在HttpSession中，types属性表示Long类型得数据模型会被保存在HttpSession中。它们是或者得关系。</p>
</blockquote>
<p><strong>存储Session数据得JSP和读取Session数据得JSP</strong></p>
<figure class="highlight jsp"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page pageEncoding=<span class="string">&quot;utf-8&quot;</span>%&gt;</span><br><span class="line">&lt;%@ taglib prefix=<span class="string">&quot;c&quot;</span> uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span>%&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;上传文件&lt;/title&gt;</span><br><span class="line">    &lt;<span class="type">script</span> <span class="variable">src</span> <span class="operator">=</span> <span class="string">&quot;https://code.jquery.com/jquery-3.0.0.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;h1&gt;</span><br><span class="line">    &lt;% session.setAttribute(<span class="string">&quot;id&quot;</span>,<span class="number">13</span>);</span><br><span class="line">       response.sendRedirect(<span class="string">&quot;./test&quot;</span>);</span><br><span class="line">    %&gt;</span><br><span class="line">&lt;/h1&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></div></figure>


<figure class="highlight jsp"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;com.example.rediscachetest.pojo.ServerUser&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page pageEncoding=<span class="string">&quot;utf-8&quot;</span>%&gt;</span><br><span class="line">&lt;%@ taglib prefix=<span class="string">&quot;c&quot;</span> uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span>%&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;用户详情&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    <span class="type">ServerUser</span> <span class="variable">user</span> <span class="operator">=</span> (ServerUser)session.getAttribute(<span class="string">&quot;users&quot;</span>);</span><br><span class="line">    <span class="type">Long</span> <span class="variable">id</span> <span class="operator">=</span> (Long)session.getAttribute(<span class="string">&quot;id_new&quot;</span>);</span><br><span class="line">    out.print(user.getName());</span><br><span class="line">    out.print(id);</span><br><span class="line"></span><br><span class="line">%&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></div></figure>


        <h2 id="获取请求头信息">
          <a href="#获取请求头信息" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取请求头信息" class="headerlink" title="获取请求头信息"></a>获取请求头信息</h2>
      <p><strong>1. JSP</strong></p>
<figure class="highlight jsp"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page pageEncoding=<span class="string">&quot;utf-8&quot;</span>%&gt;</span><br><span class="line">&lt;%@ taglib prefix=<span class="string">&quot;c&quot;</span> uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span>%&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;上传文件&lt;/title&gt;</span><br><span class="line">    &lt;<span class="type">script</span> <span class="variable">src</span> <span class="operator">=</span> <span class="string">&quot;https://code.jquery.com/jquery-3.0.0.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;h1&gt;</span><br><span class="line">    &lt;% System.out.println(<span class="string">&quot;视图渲染&quot;</span>);%&gt;</span><br><span class="line">&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;script type=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line">    $.post(&#123;</span><br><span class="line">        url:<span class="string">&quot;./userHeader&quot;</span>,</span><br><span class="line">        headers:&#123;id:<span class="string">&#x27;13&#x27;</span>,iname:<span class="string">&#x27;genji&#x27;</span>&#125;,</span><br><span class="line"></span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></div></figure>


<p><strong>2. Controller</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/userHeader&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> ServerUser <span class="title function_">headerServerUser</span><span class="params">(<span class="meta">@RequestHeader(&quot;id&quot;)</span> Long id,<span class="meta">@RequestHeader(&quot;iname&quot;)</span> String iname)</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;请求头Id：&quot;</span>+id);</span><br><span class="line">    System.out.println(<span class="string">&quot;请求头名称：&quot;</span>+iname);</span><br><span class="line">    <span class="type">ServerUser</span> <span class="variable">serverUser</span> <span class="operator">=</span> userService.getServerUser(id);</span><br><span class="line">    <span class="keyword">return</span> serverUser;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@GetMapping(&quot;/accessHeader&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">accHeader</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;user/intercec&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<blockquote>
<p>使用**@RequestHeader**注解获取请求头中的信息。注意控制器是@PostMapping</p>
</blockquote>
</div></div></article></section><nav class="paginator"><div class="paginator-inner"><a class="extend prev" rel="prev" href="/page/2/"><i class="fas fa-angle-left"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/4/"><i class="fas fa-angle-right"></i></a></div></nav></div></div><div class="sidebar-wrap" id="sidebar-wrap"><aside class="sidebar" id="sidebar"><section class="sidebar-toc hide"></section><!-- ov = overview--><section class="sidebar-ov"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="/images/icons/stun-logo.svg" alt="avatar"></div><p class="sidebar-ov-author__text">hello world</p></div><div class="sidebar-ov-state"><a class="sidebar-ov-state-item sidebar-ov-state-item--posts" href="/archives/"><div class="sidebar-ov-state-item__count">42</div><div class="sidebar-ov-state-item__name">Archives</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--categories" href="/categories/"><div class="sidebar-ov-state-item__count">0</div><div class="sidebar-ov-state-item__name">Categories</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--tags" href="/tags/"><div class="sidebar-ov-state-item__count">60</div><div class="sidebar-ov-state-item__name">Tags</div></a></div><div class="sidebar-ov-cc"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" target="_blank" rel="noopener" data-popover="Creative Commons" data-popover-pos="up"><img src="/images/cc-by-nc-sa.svg"></a></div></section></aside></div><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>Copyright © 2022</span><span class="footer__icon"><i class="fas fa-heart"></i></span><span>ashen</span></div><div><span>Powered by <a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a></span><span> v6.1.0</span><span class="footer__devider">|</span><span>Theme - <a href="https://github.com/liuyib/hexo-theme-stun/" title="Stun" target="_blank" rel="noopener">Stun</a></span><span> v2.6.2</span></div></div></footer><div class="loading-bar" id="loading-bar"><div class="loading-bar__progress"></div></div><div class="back2top" id="back2top"><span class="back2top__icon"><i class="fas fa-rocket"></i></span></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><script src="/js/utils.js?v=2.6.2"></script><script src="/js/stun-boot.js?v=2.6.2"></script><script src="/js/scroll.js?v=2.6.2"></script><script src="/js/header.js?v=2.6.2"></script><script src="/js/sidebar.js?v=2.6.2"></script></body></html>