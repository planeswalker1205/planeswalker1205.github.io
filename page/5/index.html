<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/images/icons/favicon-16x16.png?v=2.6.2" type="image/png" sizes="16x16"><link rel="icon" href="/images/icons/favicon-32x32.png?v=2.6.2" type="image/png" sizes="32x32"><meta property="og:type" content="website">
<meta property="og:title" content="MIRACLE">
<meta property="og:url" content="https://planeswalker1205.github.io/page/5/index.html">
<meta property="og:site_name" content="MIRACLE">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="ashen">
<meta name="twitter:card" content="summary"><title>MIRACLE</title><link ref="canonical" href="https://planeswalker1205.github.io/page/5/index.html"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=2.6.2"><script>var Stun = window.Stun || {};
var CONFIG = {
  root: '/',
  algolia: undefined,
  assistSearch: undefined,
  fontIcon: {"prompt":{"success":"fas fa-check-circle","info":"fas fa-arrow-circle-right","warning":"fas fa-exclamation-circle","error":"fas fa-times-circle"},"copyBtn":"fas fa-copy"},
  sidebar: {"offsetTop":"20px","tocMaxDepth":6},
  header: {"enable":true,"showOnPost":true,"scrollDownIcon":false},
  postWidget: {"endText":true},
  nightMode: {"enable":true},
  back2top: {"enable":true},
  codeblock: {"style":"default","highlight":"light","wordWrap":false},
  reward: false,
  fancybox: false,
  zoomImage: {"gapAside":"20px"},
  galleryWaterfall: undefined,
  lazyload: false,
  pjax: undefined,
  externalLink: {"icon":{"enable":true,"name":"fas fa-external-link-alt"}},
  shortcuts: undefined,
  prompt: {"copyButton":"Copy","copySuccess":"Copy Success","copyError":"Copy Error"},
  sourcePath: {"js":"js","css":"css","images":"images"},
};

window.CONFIG = CONFIG;</script><meta name="generator" content="Hexo 6.1.0"></head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner"><nav class="header-nav header-nav--fixed"><div class="header-nav-inner"><div class="header-nav-menubtn"><i class="fas fa-bars"></i></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__icon"><i class="fas fa-home"></i></span><span class="header-nav-menu-item__text">Home</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/archives/"><span class="header-nav-menu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-menu-item__text">Archives</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/categories/"><span class="header-nav-menu-item__icon"><i class="fas fa-layer-group"></i></span><span class="header-nav-menu-item__text">Categories</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/tags/"><span class="header-nav-menu-item__icon"><i class="fas fa-tags"></i></span><span class="header-nav-menu-item__text">Tags</span></a></div></div><div class="header-nav-mode"><div class="mode"><div class="mode-track"><span class="mode-track-moon"></span><span class="mode-track-sun"></span></div><div class="mode-thumb"></div></div></div></div></nav><div class="header-banner"><div class="header-banner-info"><div class="header-banner-info__title">MIRACLE</div><div class="header-banner-info__subtitle"></div></div></div></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content content-home" id="content"><section class="postlist"><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2020/02/01/%E8%AE%B0%E5%BD%95Spring-Boot%E4%B8%AD%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/">记录Spring Boot中遇到的问题</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2020-02-01</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">2022-05-21</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h1 id="记录Spring-Boot学习中遇到的一些错误及解决方案">
          <a href="#记录Spring-Boot学习中遇到的一些错误及解决方案" class="heading-link"><i class="fas fa-link"></i></a><a href="#记录Spring-Boot学习中遇到的一些错误及解决方案" class="headerlink" title="记录Spring Boot学习中遇到的一些错误及解决方案"></a>记录Spring Boot学习中遇到的一些错误及解决方案</h1>
      <ul>
<li>
        <h2 id="关于SpringBoot项目中-Controller无法引入的问题">
          <a href="#关于SpringBoot项目中-Controller无法引入的问题" class="heading-link"><i class="fas fa-link"></i></a><a href="#关于SpringBoot项目中-Controller无法引入的问题" class="headerlink" title="关于SpringBoot项目中@Controller无法引入的问题"></a>关于SpringBoot项目中@Controller无法引入的问题</h2>
      </li>
</ul>
<p><img src="/2020/02/01/%E8%AE%B0%E5%BD%95Spring-Boot%E4%B8%AD%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/QQ%E6%88%AA%E5%9B%BE20200201223809.png" alt="controller无法引入"></p>
<p>一般在工程中无法引入jar文件或者Dependencies报错只需以下操作:</p>
<ol>
<li><p>工程中clean再install</p>
</li>
<li><p>找到本地仓库删除对应包，然后到工程中clean&#x2F;install</p>
</li>
<li><p>打开项目 pom.xml 文件，右键 maven –&gt; reimport ，等待maven重新加载依赖。</p>
</li>
<li><p>将对应<dependency></dependency>标签删除，保存后,点击Reimport All Maven Project。然后再从pom.xml撤销刚刚的删除操作，然后再点击Reimport All Maven Project</p>
</li>
</ol>
<p>然而这些方案依然解决不了@Controller无法引入的问题，几经波折后，在百度上找到以下依赖：</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-context&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;4.2.5.RELEASE&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p>@Controller(org.springframework.stereotype.Controller)确实是正常引入了，但SpringBootApplication类启动报错。原因是jar包冲突。</p>
<p>再再几经波折后，发现其实是maven版本不对应，因为Intellij IDEA是最新下载的版本，而maven还是使用的以前的apache-maven-3.5.0，换成apache-maven-3.6.3就好了。@Controller便可正常引入。</p>

        <h2 id="错误-Could-not-transfer-artifact-org-apache-maven-plugins-maven-resources-plugin">
          <a href="#错误-Could-not-transfer-artifact-org-apache-maven-plugins-maven-resources-plugin" class="heading-link"><i class="fas fa-link"></i></a><a href="#错误-Could-not-transfer-artifact-org-apache-maven-plugins-maven-resources-plugin" class="headerlink" title="错误:Could not transfer artifact org.apache.maven.plugins:maven-resources-plugin"></a>错误:Could not transfer artifact org.apache.maven.plugins:maven-resources-plugin</h2>
      
        <h2 id="错误-Cannot-resolve-symbol-‘SpringApplication异常">
          <a href="#错误-Cannot-resolve-symbol-‘SpringApplication异常" class="heading-link"><i class="fas fa-link"></i></a><a href="#错误-Cannot-resolve-symbol-‘SpringApplication异常" class="headerlink" title="错误:Cannot resolve symbol ‘SpringApplication异常"></a>错误:Cannot resolve symbol ‘SpringApplication异常</h2>
      <ol>
<li><p>找到本地库文件</p>
</li>
<li><p>找到报错的对应包（第二个错误对应包是:repository\org\springframework\boot目录下的spring-boot-autoconfigure）</p>
</li>
<li><p>删除包，然后到工程中reimport</p>
</li>
</ol>

        <h2 id="错误-Failed-to-execute-goal-org-apache-maven-plugins-maven-war-plugin-3-2-2-war">
          <a href="#错误-Failed-to-execute-goal-org-apache-maven-plugins-maven-war-plugin-3-2-2-war" class="heading-link"><i class="fas fa-link"></i></a><a href="#错误-Failed-to-execute-goal-org-apache-maven-plugins-maven-war-plugin-3-2-2-war" class="headerlink" title="错误:Failed to execute goal org.apache.maven.plugins:maven-war-plugin:3.2.2:war"></a>错误:Failed to execute goal org.apache.maven.plugins:maven-war-plugin:3.2.2:war</h2>
      <p>以下配置:</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;plugins&gt;</span><br><span class="line"> &lt;plugin&gt; </span><br><span class="line">	 &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;</span><br><span class="line">	 &lt;artifactId&gt;maven-war-plugin&lt;/artifactId&gt;</span><br><span class="line">	 &lt;version&gt;3.0.0&lt;/version&gt;</span><br><span class="line">	 &lt;configuration&gt; &lt;failOnMissingWebXml&gt;false&lt;/failOnMissingWebXml&gt; &lt;/configuration&gt;</span><br><span class="line"> &lt;/plugin&gt;</span><br></pre></td></tr></table></div></figure>


        <h2 id="SpringBoot无法正常启动的问题">
          <a href="#SpringBoot无法正常启动的问题" class="heading-link"><i class="fas fa-link"></i></a><a href="#SpringBoot无法正常启动的问题" class="headerlink" title="SpringBoot无法正常启动的问题"></a>SpringBoot无法正常启动的问题</h2>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">	&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">	&lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;</span><br><span class="line">	&lt;scope&gt;provided&lt;/scope&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></div></figure>

<blockquote>
<p>去掉此处的作用域provided</p>
</blockquote>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2020/01/28/Spring-Boot%E5%AD%A6%E4%B9%A0v1/">Spring Boot学习v1</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2020-01-28</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">2022-05-21</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h2 id="简单搭建Spring-Boot开发环境">
          <a href="#简单搭建Spring-Boot开发环境" class="heading-link"><i class="fas fa-link"></i></a><a href="#简单搭建Spring-Boot开发环境" class="headerlink" title="简单搭建Spring Boot开发环境"></a>简单搭建Spring Boot开发环境</h2>
      
        <h3 id="搭建环境">
          <a href="#搭建环境" class="heading-link"><i class="fas fa-link"></i></a><a href="#搭建环境" class="headerlink" title="搭建环境"></a>搭建环境</h3>
      <ol>
<li><p>启动Intellij IDEA，选择Create New Project，看到了一个新的窗口之后，选择Spring Initializr，将JDK切换为你想要的版本。</p>
</li>
<li><p>点击Next，进行一定的配置</p>
</li>
</ol>
<p><img src="/2020/01/28/Spring-Boot%E5%AD%A6%E4%B9%A0v1/QQ%E6%88%AA%E5%9B%BE20200128160719.png" alt="config1"></p>
<ol start="3">
<li><p>点击Next，可以根据自己的需要选择对应的starter进行依赖。</p>
</li>
<li><p>建好后，工程目录可以看到一个已经建好的类Spbotdemo1Application、ServletInitializer和Maven的pom.xml文件。运行Spbotdemo1Application就可以启动Spring Boot的工程，而pom.xml则配置好了你选中的starter依赖，这样就能够基于Intellij IDEA开发Spring Boot工程了。</p>
</li>
</ol>
<p><img src="/2020/01/28/Spring-Boot%E5%AD%A6%E4%B9%A0v1/QQ%E6%88%AA%E5%9B%BE20200128161252.png" alt="config1"></p>
<ol start="5">
<li>自定义配置:在新建的工程中可以看到一个属性文件application.properties文件，通过它可以根据自己的需要实现自定义。如图:</li>
</ol>
<p><img src="/2020/01/28/Spring-Boot%E5%AD%A6%E4%B9%A0v1/QQ%E6%88%AA%E5%9B%BE20200128161536.png" alt="config1"></p>

        <h3 id="开发项目">
          <a href="#开发项目" class="heading-link"><i class="fas fa-link"></i></a><a href="#开发项目" class="headerlink" title="开发项目"></a>开发项目</h3>
      <ol>
<li>新增JSP和JSTL的Maven依赖配置</li>
</ol>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">   &lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.apache.tomcat.embed&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;tomcat-embed-jasper&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;<span class="number">9.0</span><span class="number">.24</span>&lt;/version&gt;</span><br><span class="line">    &lt;scope&gt;provided&lt;/scope&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;javax.servlet&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;jstl&lt;/artifactId&gt;</span><br><span class="line">    &lt;scope&gt;provided&lt;/scope&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></div></figure>

<ol start="2">
<li>application.properties文件定义视图前后缀</li>
</ol>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">server.port=8090</span><br><span class="line">spring.mvc.view.prefix=/WEB-INF/jsp/</span><br><span class="line">spring.mvc.view.suffix=.jsp</span><br></pre></td></tr></table></div></figure>

<ol start="3">
<li>开发控制器</li>
</ol>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.sbtest.onespbot.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">IndexController</span> &#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/index&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">index</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;index&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<ol start="4">
<li>开发视图</li>
</ol>
<figure class="highlight html"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;%--</span><br><span class="line">  Created by IntelliJ IDEA.</span><br><span class="line">  User: acer</span><br><span class="line">  Date: 2020/1/28</span><br><span class="line">  Time: 15:07</span><br><span class="line">  To change this template use File | Settings | File Templates.</span><br><span class="line">--%&gt;</span><br><span class="line">&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>jsp文件<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>测试视图解析器<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<ol start="5">
<li>运行application文件，打开浏览器访问<code>http://localhost:8090/index</code></li>
</ol>
<p><img src="/2020/01/28/Spring-Boot%E5%AD%A6%E4%B9%A0v1/QQ%E6%88%AA%E5%9B%BE20200128162325.png" alt="config1"></p>
<p><strong>注:Application启动类要放在最外侧，即包含所有的子包。因为Spring Boot会自动加载启动类所在包下及其子包下的所有组件</strong></p>
<p>如果@Controller注解报错失效的话添加以下依赖:</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-context&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;4.2.5.RELEASE&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></div></figure>


        <h2 id="IoC容器">
          <a href="#IoC容器" class="heading-link"><i class="fas fa-link"></i></a><a href="#IoC容器" class="headerlink" title="IoC容器"></a>IoC容器</h2>
      <p>定义：<strong>在Spring中把每一个需要管理的对象成为Spring Bean(简称Bean)，而Spring管理这些Bean的容器，被我们成为Spring IoC容器(简称IoC容器)。</strong></p>
<blockquote>
<p>Spring IoC容器是一个管理Bean的容器，在Spring的定义中，所有的IoC容器都需要实现接口BeanFactory，它是顶级容器接口。而由于BeanFactory的功能还不够强大，因此Spring在BeanFactory的基础上，还设计了更为高级的接口ApplicationContext，它是BeanFactory的子接口之一，在现实中我们使用的大部分Spring IoC容器是ApplicationContext接口的实现类。</p>
</blockquote>
<p>以下示例是基于注解的IoC容器AnnotationConfigApplicationContext。</p>
<ul>
<li><strong>第一个装配Bean的方法</strong></li>
</ul>
<ol>
<li>定义User实体</li>
</ol>
<p><img src="/2020/01/28/Spring-Boot%E5%AD%A6%E4%B9%A0v1/QQ%E6%88%AA%E5%9B%BE20200128210557.png" alt="User"></p>
<ol start="2">
<li>定义Java配置文件</li>
</ol>
<p><img src="/2020/01/28/Spring-Boot%E5%AD%A6%E4%B9%A0v1/QQ%E6%88%AA%E5%9B%BE20200128210935.png" alt="config"></p>
<blockquote>
<p>注解<code>@Configuration</code>代表这是一个Java配置文件，Spring的容器会根据它来生成IoC容器去装配Bean；<code>@Bean</code>代表将initUser方法返回的pojo装配到IoC容器中，属性name表示这个Bean的名称，如果没有配置它，默认是方法名称”initUser”.</p>
</blockquote>
<ol start="3">
<li>使用AnnotationConfigApplicationContext构建IoC容器。</li>
</ol>
<p><img src="/2020/01/28/Spring-Boot%E5%AD%A6%E4%B9%A0v1/QQ%E6%88%AA%E5%9B%BE20200128211358.png" alt="config"></p>
<ul>
<li><strong>通过扫描装配Bean</strong></li>
</ul>
<blockquote>
<p>如果Bean使用注解<code>@Bean</code>一个个注入到IoC容器中，将使一个非常麻烦的事情。Spring允许我们进行扫描装配Bean到IoC容器中。对于扫描装配而言使用的注解是<code>@Component</code>和<code>@ComponentScan</code>。<code>@Component</code>是表明哪个类被扫描进入Spring IoC容器，而<code>@ComponentScan</code>是标明采用何种策略去扫描装配Bean。</p>
</blockquote>
<ol>
<li>首先移动User类到conf包下，这是因为注解了<code>@ComponentScan</code>的类默认扫描该类所在的当前包和其子包。</li>
</ol>
<p><img src="/2020/01/28/Spring-Boot%E5%AD%A6%E4%B9%A0v1/QQ%E6%88%AA%E5%9B%BE20200128212945.png" alt="config"></p>
<ol start="2">
<li>User类加入注解@Component</li>
</ol>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.sbtest.onespbot.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.logging.Logger;</span><br><span class="line"><span class="meta">@Component(&quot;user&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="meta">@Value(&quot;016&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="meta">@Value(&quot;LWX&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line">    <span class="meta">@Value(&quot;note1&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String note;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//GET&amp;SET...</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<blockquote>
<p><code>@Component</code>表示这个类将被Spring IoC容器扫描装配，“user”是作为Bean的名称，不配置“user”的话默认会把类名的第一个字母作为小写，其他不变作为Bean名称放入到IoC容器中。<code>@Value</code>指具体的值。</p>
</blockquote>
<ol start="3">
<li>AppConfig类加入注解<code>@ComponentScan</code></li>
</ol>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.sbtest.onespbot.conf;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.ComponentScan;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Appconfig</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<blockquote>
<p>注解<code>@ComponentScan</code>表示它会进行扫描，且默认知会扫描类Appconfig所在的当前包以及子包。</p>
</blockquote>
<ol start="4">
<li>测试扫描</li>
</ol>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.sbtest.onespbot.conf;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.sbtest.onespbot.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.apache.log4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.AnnotationConfigApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">IoCTest</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">Logger</span> <span class="variable">logger</span> <span class="operator">=</span> Logger.getLogger(IoCTest.class);</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(Appconfig.class);</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> (User)context.getBean(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">        logger.info(<span class="string">&quot;用户的id是:&quot;</span>+user.getId());</span><br><span class="line">        logger.info(<span class="string">&quot;用户姓名是:&quot;</span>+user.getUserName());</span><br><span class="line">        logger.info(<span class="string">&quot;便签是:&quot;</span>+user.getNote());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>
<p>可见，可以正常输出日志信息。</p>
<p>上述方法2为了能使User类能够被扫描而把它迁移到了其他的包中，这显然是不合理的，为了更加合理，<code>@ComponentScan</code>允许我们自定义扫描的包。</p>
<ul>
<li><strong>自定义扫描包</strong></li>
</ul>
<p>可以通过配置项<strong>basePackages</strong>定义扫描的包名，其中还有<strong>includeFilters</strong>和<strong>excludeFilters</strong>。前者是定义满足过滤器条件的Bean才去扫描，后者则是排除过滤器条件的Bean</p>
<ol>
<li>重新把类User放到pojo包下。</li>
</ol>
<p><img src="/2020/01/28/Spring-Boot%E5%AD%A6%E4%B9%A0v1/QQ%E6%88%AA%E5%9B%BE20200128214250.png" alt="diyBean"></p>
<ol start="2">
<li>把Appconfig中的注解修改为:</li>
</ol>
<p>(1)<code>@ComponentScan(&quot;com.example.sbtest.onespbot.pojo&quot;)</code>或<code>@ComponentScan(&quot;com.example.sbtest.onespbot.*&quot;)</code></p>
<p>这样就可以扫描到pojo包下的类或者是onespbot下所有的包。注意，这里的地址不能直接写到类的位置。</p>
<p>(2) <code>@ComponentScan(basePackages=&#123;&quot;com.example.sbtest.onespbot.pojo&quot;&#125;)</code></p>
<p>(3) <code>@ComponentScan(basePackageClasses = &#123;User.class&#125;)</code></p>
<blockquote>
<p>当你扫描的包下面包含了标注了<code>@Service</code>(该标准注入了@Component，默认情况下会被Spring扫描装配到IoC容器中)的服务类而你又不想服务类被扫描装配的话，需要把扫描策略修改为:</p>
</blockquote>
<p><code>@ComponentScan(basePackages = &quot;com.example.sbtest.onespbot.*&quot;,excludeFilters = &#123;@Filter(classes = &#123;UserService.class&#125;)&#125;)</code>。</p>
<p>这样，就可以把服务类UserService排除到SpringIoC容器之外了。事实上，之前的Spring Boot注解<code>@SpringBootApplication</code>也注入了<code>@ComponentScan</code>。所以如果标注了<code>@Component</code>的pojo类在标注了<code>@SpringBootApplication</code>的类所在的包或子包下，可以不用在类上标注<code>@ComponentScan</code>(OnespbotApplication是标注了@SpringBootApplication的启动类。):</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(OnespbotApplication.class);</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> (User)context.getBean(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">        logger.info(<span class="string">&quot;用户的id是:&quot;</span>+user.getId());</span><br><span class="line">        logger.info(<span class="string">&quot;用户姓名是:&quot;</span>+user.getUserName());</span><br><span class="line">        logger.info(<span class="string">&quot;便签是:&quot;</span>+user.getNote());</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p><strong>可以被</strong><code>@ComponentScan</code><strong>扫描到的类的标注有:</strong></p>
<p><code>@Controller</code>，<code>@Repository</code>，<code>@Service</code>或<code>@Component</code></p>

        <h2 id="自定义第三方Bean">
          <a href="#自定义第三方Bean" class="heading-link"><i class="fas fa-link"></i></a><a href="#自定义第三方Bean" class="headerlink" title="自定义第三方Bean"></a>自定义第三方Bean</h2>
      <p>现实的Java应用往往需要引入第三方的包，并且想要把第三方包的类对象放图到Spring IoC容器中。这时就可以使用@Bean注解:</p>
<ul>
<li>定义DBCP数据源</li>
</ul>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;commons-dbcp2&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;mysql&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></div></figure>

<ul>
<li>使用DBCP生成数据源:</li>
</ul>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean(name=&quot;dataSource&quot;)</span></span><br><span class="line"><span class="keyword">public</span> DataSource <span class="title function_">getDataSource</span><span class="params">()</span>&#123;</span><br><span class="line">	<span class="type">Properties</span> <span class="variable">props</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">	props.setProperty(<span class="string">&quot;driver&quot;</span>,<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">	props.setProperty(<span class="string">&quot;url&quot;</span>,<span class="string">&quot;jdbc:mysql://localhost:3306/currDemo&quot;</span>);</span><br><span class="line">	props.setProperty(<span class="string">&quot;username&quot;</span>,<span class="string">&quot;root&quot;</span>);</span><br><span class="line">	props.setProperty(<span class="string">&quot;password&quot;</span>,<span class="string">&quot;123456&quot;</span>);</span><br><span class="line">	<span class="type">DataSource</span> <span class="variable">dataSource</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">	<span class="keyword">try</span>&#123;</span><br><span class="line">	dataSource = BasicDataSourceFactory.createDataSource(props);</span><br><span class="line">	&#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">	e.printStackTrace();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> dataSource;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>通过以上，便可以将第三方包的类装配到Spring IoC容器中。</p>

        <h2 id="依赖注入Autowired">
          <a href="#依赖注入Autowired" class="heading-link"><i class="fas fa-link"></i></a><a href="#依赖注入Autowired" class="headerlink" title="依赖注入Autowired"></a>依赖注入Autowired</h2>
      <p>Spring IoC中Bean之间可以相互依赖，即依赖注入(Dependency Injection,DI)</p>
<p>如下例子:</p>
<p>定义人类接口</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Person</span>&#123;</span><br><span class="line">	<span class="comment">//动物类行为</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">()</span>;</span><br><span class="line">	<span class="comment">//动物类设置</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAnimal</span><span class="params">(Animal animal)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>定义动物接口</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Animal</span>&#123;</span><br><span class="line">	<span class="comment">//动物类使用</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">use</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>人类实现类:</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">oneperson</span> <span class="keyword">implements</span> <span class="title class_">Person</span>()&#123;</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> <span class="type">Animal</span> <span class="variable">cat</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">()</span>&#123;</span><br><span class="line">	<span class="built_in">this</span>.animal.use();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAnimal</span><span class="params">(Animal animal)</span>&#123;</span><br><span class="line">	<span class="built_in">this</span>.animal = animal;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>动物实现类:</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Cat</span> <span class="keyword">implements</span> <span class="title class_">Animal</span>()&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">use</span><span class="params">()</span>&#123;</span><br><span class="line">	System.out.println(<span class="string">&quot;这是一只cat&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Dog</span> <span class="keyword">implements</span> <span class="title class_">Animal</span>()&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">use</span><span class="params">()</span>&#123;</span><br><span class="line">	System.out.println(<span class="string">&quot;这是一只dog&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>测试类:</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">	<span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(Appconf.class);</span><br><span class="line">	<span class="type">Person</span> <span class="variable">person</span> <span class="operator">=</span> context.getBean(<span class="string">&quot;person&quot;</span>);</span><br><span class="line">	person.service();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p>最终打印结果为<code>这是一只cat</code>。</p>
<p>注意：<strong>如果依赖的类属性名称是</strong><code>Animals animal = null</code><strong>或者其他不相干的属性名称的话，那么运行测试类的结果是报错，因为你所定义的动物类不止一个，Spring IoC无法确定要注入哪一个，故而报错。如果将属性名称改为</strong><code>dog</code><strong>或者</strong><code>cat</code><strong>的话，测试类正常运行，原因在于@Autowired首先会根据类型找到对应的Bean，如果其不是唯一的，那么会根据属性名称和Bean的名称进行匹配。</strong></p>
<p>那么是否有其他的方法确定依赖注入的类到底是哪个呢:</p>
<p><strong>消除歧义性:@Primary和@Qualifier</strong></p>
<p>@Primary:它是一个修改优先权的注解，把它定义在其中一个类的上面，那么当Spring IoC发现有多个同样类型的Bean时，会优先使用它进行注入，当有多个此注解时该报错还是报错。</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Primary</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Dog</span> <span class="keyword">implements</span> <span class="title class_">Animal</span>()&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">use</span><span class="params">()</span>&#123;</span><br><span class="line">	System.out.println(<span class="string">&quot;这是一只dog&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p>@Qualifier:表限定，具体使用哪一个Bean注入:</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">oneperson</span> <span class="keyword">implements</span> <span class="title class_">Person</span>()&#123;</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="meta">@Qualifier(&quot;dog&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> <span class="type">Animal</span> <span class="variable">cat</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">()</span>&#123;</span><br><span class="line">	<span class="built_in">this</span>.animal.use();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAnimal</span><span class="params">(Animal animal)</span>&#123;</span><br><span class="line">	<span class="built_in">this</span>.animal = animal;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p><strong>@Autowired还可以使用在方法上</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">oneperson</span> <span class="keyword">implements</span> <span class="title class_">Person</span>()&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">Animal</span> <span class="variable">cat</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">()</span>&#123;</span><br><span class="line">	<span class="built_in">this</span>.animal.use();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAnimal</span><span class="params">(Animal animal)</span>&#123;</span><br><span class="line">	<span class="built_in">this</span>.animal = animal;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p><strong>也可以用在参数中</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">oneperson</span> <span class="keyword">implements</span> <span class="title class_">Person</span>()&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">Animal</span> <span class="variable">cat</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">oneperson</span><span class="params">(<span class="meta">@Autowired</span> <span class="meta">@Qualifier(&quot;dog&quot;)</span> Animal animal)</span>&#123;</span><br><span class="line">	<span class="built_in">this</span>.animal = animal;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">()</span>&#123;</span><br><span class="line">	<span class="built_in">this</span>.animal.use();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAnimal</span><span class="params">(Animal animal)</span>&#123;</span><br><span class="line">	<span class="built_in">this</span>.animal = animal;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p><strong>注解@lazyInit</strong></p>
<p>在ComponentScan中还有一个配置项是lazyInit，只可以配置Boolean值，默认是false，也就是默认不延迟初始化，因此，在默认的情况下Spring会对Bean进行实例化和依赖注入对应的属性值。</p>
<blockquote>
<p>在默认为false的情况下，SpringIoC容器初始化时执行了实例化和依赖注入，而为了改变这种情况，我们可以在配置类的@ComponentScan中加入lazyInit配置。</p>
</blockquote>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">@ComponentScan(lazyInit=true)</span><br></pre></td></tr></table></div></figure>

<p>这样的话就会在Bean实力化之后进行初始化（依赖注入）。</p>

        <h2 id="使用属性文件">
          <a href="#使用属性文件" class="heading-link"><i class="fas fa-link"></i></a><a href="#使用属性文件" class="headerlink" title="使用属性文件"></a>使用属性文件</h2>
      <p><strong>可以采用默认的application.properties文件。</strong></p>
<ol>
<li>添加属性文件依赖</li>
</ol>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-configuration-processor&lt;/artifactId&gt;</span><br><span class="line">    &lt;optional&gt;true&lt;/optional&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<ol start="2">
<li>application.properties文件属性配置</li>
</ol>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">database.driverName: com.mysql.jdbc.Driver</span><br><span class="line">database.url: jdbc:mysql://localhost:3306/sprbot</span><br><span class="line">database.username: root</span><br><span class="line">database.password: 123456</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<ol start="3">
<li>使用属性配置</li>
</ol>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.sprbot.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.context.properties.ConfigurationProperties;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DataBaseProperties</span> &#123;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;database.driverName&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String driverName=<span class="literal">null</span>;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;database.url&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String url=<span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">private</span> String username=<span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">private</span> String password=<span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setDriverName</span><span class="params">(String driverName)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.driverName = driverName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUrl</span><span class="params">(String url)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.url = url;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;database.username&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUsername</span><span class="params">(String username)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;username的值是:&quot;</span>+username);</span><br><span class="line">        <span class="built_in">this</span>.username = username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;database.password&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPassword</span><span class="params">(String password)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;当前密码是:&quot;</span>+password);</span><br><span class="line">        <span class="built_in">this</span>.password = password;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p>可以通过Value注解，使用${…}占位符读取配置。这里的@Value注解，可以加在属性，也可以加在方法上。</p>
<p>启动SpringBoot，由于我们已经知道了如果没有在ComponentScan中配置lazyInit属性值为true的话，默认在定义bean的时候就实例化(依赖注入)，所以我们可以看到以下打印信息。</p>
<p><img src="/2020/01/28/Spring-Boot%E5%AD%A6%E4%B9%A0v1/QQ%E6%88%AA%E5%9B%BE20200203172450.png" alt="console"></p>
<p><strong>@ConfigurationProperties读取配置文件</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.sprbot.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.context.properties.ConfigurationProperties;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(&quot;database&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DataBaseProperties</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String driverName=<span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">private</span> String url=<span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">private</span> String username=<span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">private</span> String password=<span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setDriverName</span><span class="params">(String driverName)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;driverName的值是:&quot;</span>+driverName);</span><br><span class="line">        <span class="built_in">this</span>.driverName = driverName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUrl</span><span class="params">(String url)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;url的值是:&quot;</span>+url);</span><br><span class="line">        <span class="built_in">this</span>.url = url;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUsername</span><span class="params">(String username)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;username的值是:&quot;</span>+username);</span><br><span class="line">        <span class="built_in">this</span>.username = username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPassword</span><span class="params">(String password)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;当前密码是:&quot;</span>+password);</span><br><span class="line">        <span class="built_in">this</span>.password = password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>
<p>在这里注解@ConfigurationProperties中配置的字符串database，将于POJO的属性名称组成属性的全限定名去配置文件中查找，这样就可以将对应的属性读入POJO当中。<strong>注意，POJO的属性名称要与.properties&#x2F;.yml文件中的名称相同。</strong></p>
<p>也可以自定义配置属性文件:</p>
<ol>
<li>新建jdbc.properties文件,将application.properties文件的内容迁移至jdbc.properties中:</li>
</ol>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">database.driverName: com.mysql.jdbc.Driver</span><br><span class="line">database.url: jdbc:mysql:<span class="comment">//localhost:3306/sprbot</span></span><br><span class="line">database.username: root</span><br><span class="line">database.password: <span class="number">654321</span></span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<ol start="2">
<li>使用@PropertySource注解:</li>
</ol>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.sprbot;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.ComponentScan;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.PropertySource;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@PropertySource(value = &#123;&quot;classpath:jdbc.yml&quot;&#125;,ignoreResourceNotFound = true)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SprbotApplication</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(SprbotApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p>value可以配置多个配置文件，使用classpath前缀，意味着去类文件路径下找到属性文件。ignoreResourceNotFound则是是否忽略配置文件找不到的问题，如果为true，就表示没有该配置文件的话就忽略，不会报错。为false或不配置的话表示如果没有该属性文件会报错。</p>

        <h2 id="条件装配Bean">
          <a href="#条件装配Bean" class="heading-link"><i class="fas fa-link"></i></a><a href="#条件装配Bean" class="headerlink" title="条件装配Bean"></a>条件装配Bean</h2>
      <p>某些情况下可能会使一些Bean无法初始化，比如，在数据库连接池配置中漏掉一些配置会造成数据源不能连接上。在这样的情况下，如果IoC还进行数据源的装配，系统将会跑出异常，这时我们希望IoC容器不去装配数据源。</p>
<p>Spring提供了@Conditional注解，此注解需要配合另外一个借口Condition(org.springframework.context.annotation.Condition)来完成对应的功能。</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.sprbot.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.context.properties.ConfigurationProperties;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Conditional;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(&quot;database&quot;)</span></span><br><span class="line"><span class="meta">@Conditional(Databaseconditional.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DataBaseProperties</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String driverName=<span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">private</span> String url=<span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">private</span> String username=<span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">private</span> String password=<span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setDriverName</span><span class="params">(String driverName)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;driverName的值是:&quot;</span>+driverName);</span><br><span class="line">        <span class="built_in">this</span>.driverName = driverName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUrl</span><span class="params">(String url)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;url的值是:&quot;</span>+url);</span><br><span class="line">        <span class="built_in">this</span>.url = url;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUsername</span><span class="params">(String username)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;username的值是:&quot;</span>+username);</span><br><span class="line">        <span class="built_in">this</span>.username = username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPassword</span><span class="params">(String password)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;当前密码是:&quot;</span>+password);</span><br><span class="line">        <span class="built_in">this</span>.password = password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;DataBaseProperties&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;driverName=&#x27;&quot;</span> + driverName + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, url=&#x27;&quot;</span> + url + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, username=&#x27;&quot;</span> + username + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, password=&#x27;&quot;</span> + password + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p>Databaseconditional类:</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.sprbot.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Condition;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.ConditionContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.env.Environment;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.type.AnnotatedTypeMetadata;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Databaseconditional</span> <span class="keyword">implements</span> <span class="title class_">Condition</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">matches</span><span class="params">(ConditionContext conditionContext, AnnotatedTypeMetadata annotatedTypeMetadata)</span> &#123;</span><br><span class="line">        <span class="comment">//取出环境配置</span></span><br><span class="line">        <span class="type">Environment</span> <span class="variable">env</span> <span class="operator">=</span> conditionContext.getEnvironment();</span><br><span class="line">        <span class="comment">//判断属性文件是否存在对应的数据库配置</span></span><br><span class="line">        <span class="keyword">return</span> env.containsProperty(<span class="string">&quot;database.driverName&quot;</span>)&amp;&amp;env.containsProperty(<span class="string">&quot;database.url&quot;</span>)</span><br><span class="line">                &amp;&amp;env.containsProperty(<span class="string">&quot;database.username&quot;</span>)&amp;&amp;env.containsProperty(<span class="string">&quot;database.password&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<blockquote>
<p>matches方法首先读取上下文环境，然后判断是否已经配置了对应的数据库信息，这样，当所有配置信息都配置好的话返回true，这个时候Spring会装配数据库连接池的Bean，否则是不装配的。</p>
</blockquote>
<p>以此，当配置属性文件中不存在某个配置的话，启动springapplication将不会打印一下信息。</p>
<p><img src="/2020/01/28/Spring-Boot%E5%AD%A6%E4%B9%A0v1/QQ%E6%88%AA%E5%9B%BE20200203204506.png" alt="println"></p>

        <h2 id="Bean的作用域">
          <a href="#Bean的作用域" class="heading-link"><i class="fas fa-link"></i></a><a href="#Bean的作用域" class="headerlink" title="Bean的作用域"></a>Bean的作用域</h2>
      <p>singleton</p>
<p>prototype</p>
<p>session</p>
<p>application</p>
<p>request</p>
<p>globalSession</p>

        <h2 id="引入XML配置Bean">
          <a href="#引入XML配置Bean" class="heading-link"><i class="fas fa-link"></i></a><a href="#引入XML配置Bean" class="headerlink" title="引入XML配置Bean"></a>引入XML配置Bean</h2>
      <p>在某些情况下我们还是想引入xml来配置Bean</p>
<ol>
<li>创建一个类（此类不会标注@Component注解，且不在springapplication所在包及其子包，不会被扫描到）</li>
</ol>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.sprbot.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.sprbot.interfece.Animals;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Squirrel</span> <span class="keyword">implements</span> <span class="title class_">Animals</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">use</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;我是一只松鼠:&quot;</span>+Squirrel.class.getSimpleName());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>
<ol start="2">
<li>定义xml文件</li>
</ol>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;</span><br><span class="line">       xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">       xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;&gt;</span><br><span class="line">    &lt;bean id=&quot;squirrel&quot; class=&quot;com.example.sprbot.pojo.Squirrel&quot;&gt;</span><br><span class="line">    &lt;/bean&gt;</span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></div></figure>

<ol start="3">
<li>装配xml定义的Bean</li>
</ol>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.sprbot.conf;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.sprbot.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="meta">@ImportResource(value=&#123;&quot;classpath:spring-other.xml&quot;&#125;)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpConfiguration</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<ol start="4">
<li>测试类</li>
</ol>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.sprbot.conf;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.sprbot.pojo.Squirrel;</span><br><span class="line"><span class="keyword">import</span> com.example.sprbot.pojo.User;</span><br><span class="line"><span class="keyword">import</span> com.example.sprbot.service.Oneperson;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.AnnotationConfigApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.ImportResource;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">testMain</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(SpConfiguration.class);</span><br><span class="line">        <span class="type">Squirrel</span> <span class="variable">sq</span> <span class="operator">=</span> (Squirrel)context.getBean(<span class="string">&quot;squirrel&quot;</span>);</span><br><span class="line">        sq.use();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p>运行正常。</p>

        <h2 id="Spring-EL">
          <a href="#Spring-EL" class="heading-link"><i class="fas fa-link"></i></a><a href="#Spring-EL" class="headerlink" title="Spring EL"></a>Spring EL</h2>
      
        <h2 id="本章总结">
          <a href="#本章总结" class="heading-link"><i class="fas fa-link"></i></a><a href="#本章总结" class="headerlink" title="本章总结"></a>本章总结</h2>
      <blockquote>
<p>本章主要介绍了Spring IoC容器，以及Bean装配的各种方式，依赖注入等等。</p>
</blockquote>
<ol>
<li><p>@Bean注解来装配Bean</p>
</li>
<li><p>@ComponentScan及@Component扫描装配Bean。@ComponentScan默认只扫描所在类的包及其子包，如果想要扫描到其他的包，可以使用basePackage或basePackageClasses定义扫描范围。</p>
</li>
<li><p>依赖注入@Autowired，Bean与Bean之间可以相互依赖。如果依赖的父类接口存在多个子类的话，除了定义的名称为子类Bean的名称外，还可以使用@Primary优先级和@Qualifier限定。</p>
</li>
<li><p>@lazyInit。默认情况下，当运行的时候SpringIoC会在定义Bean的时候就会实例化(依赖注入)，想要在实例化Bean之后再依赖注入可以<code>@ComponentScan(lazyInit=true)</code></p>
</li>
<li><p>使用属性文件。@ConfigurationProperties读取配置文件。在自定义创建一个配置文件的话，可以使用<code>@PropertySource</code>定义读取哪个配置文件，属性<code>ignoreResourceNotFound</code>表示如果不存在该属性文件是否忽略</p>
</li>
<li><p>引入xml配置Bean<code>@ImportResource(value=&#123;&quot;classpath:spring-other.xml&quot;&#125;)</code></p>
</li>
</ol>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2020/01/21/Git%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0v2/">Git学习笔记v2</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2020-01-21</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">2022-06-16</span></span></div></header><div class="post-body"><div class="post-excerpt"><p><strong>网页无法访问GitHub网站的解决办法:</strong></p>
<p>进入Window下目录：C：\ Windows \ System32 \ drivers \ etc</p>
<p>notepad++打开hosts文件,在末尾添加如下代码:</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#github </span><br><span class="line">192.30.253.113 github.com </span><br><span class="line">192.30.253.113 github.com </span><br><span class="line">192.30.253.118 gist.github.com </span><br><span class="line">192.30.253.119 gist.github.com</span><br></pre></td></tr></table></div></figure>

<p><em>此方法来自博客:</em> <span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_39087263/article/details/84493188">https://blog.csdn.net/weixin_39087263&#x2F;article&#x2F;details&#x2F;84493188</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>

        <h2 id="如何使用ssh密钥">
          <a href="#如何使用ssh密钥" class="heading-link"><i class="fas fa-link"></i></a><a href="#如何使用ssh密钥" class="headerlink" title="如何使用ssh密钥"></a>如何使用ssh密钥</h2>
      <p>初次使用git的用户要使用git协议大概需要三个步骤:</p>
<ul>
<li><p>生成密钥对</p>
<ol>
<li>ssh公钥默认存储在账户的主目录下的~&#x2F;.ssh目录，查看:</li>
</ol>
 <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ cd~/.ssh</span><br><span class="line">$ ls</span><br><span class="line"> 	authorized_leys2 id_dsa		known_hosts config		id_dsa.pub</span><br></pre></td></tr></table></div></figure>
<p> 查看是否存在id_rsa和id_rsa.pub(id_dsa和id_dsa.pub之类成对的文件.)。</p>
<p> <code>.pub</code>后缀的文件为公钥，另一个文件时密钥。</p>
<ol start="2">
<li>如果没有上述文件，没有.ssh目录，可以使用ssh-keygen创建</li>
</ol>
 <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-keygen -t rsa -C &quot;email@email.com&quot;</span><br><span class="line"></span><br><span class="line">Creates a new ssh key using the provided email # Generating public/private rsa key pair.</span><br><span class="line"></span><br><span class="line">Enter file in which to save the key (/home/you/.ssh/id_rsa):</span><br></pre></td></tr></table></div></figure>
<p> 直接enter，然后输入密码。</p>
<p> <img src="/2020/01/21/Git%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0v2/QQ%E6%88%AA%E5%9B%BE20200121232408.png" alt="输入密码"></p>
</li>
<li><p>设置远程仓库上的公钥</p>
<ol>
<li>查看生成的公钥:</li>
</ol>
  <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ cat ~/.ssh/id_rsa.pub</span><br><span class="line"></span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDBGTYBoVSyZsK0FyYuL3u5ATxwaETtplLsejKsj76G9ca1Bx519YLZCzY6zFnaD/2jYEZv1/IUjNxHWWRqP47zWTdQvdvSfPOheIp1j+mbA0HWPtCIi4c8vX3XWSv90uDoyzllMT3Qwi1XAn3TdcthLxIXKIb0v70ZdmXcl5t3t68BQfhrB/ykL4m6Nji0qPdTOtYwNYT0FH/n8Wvb7wBd8w1BJ6YNUZzyWkWLHFcF+hvXpaM4w5A0P7M880xsYROnyMB57WSejp1Dcp69KAp0WpjV5CPXsMgyvwEQ/aYKTYw06EAVUMavDTDTOZ9/I08P0R9X07HG+V99pB2r74f7AC2vvuglTLC4OT0hc3ZuyGYX3ATasv4og46sJJY46q65WUEyVvfNF6+QVRV8j9scy/OyjzrEQqXOjFVaxx7RE7LgcVvLhNRnartavD7Ll+4wMNDdiWqD88EBe8p3nbtl4/5Eu5w35BWm0AJg3jSykT643lOD0LJVSXIzyHkXST0= 462083214@qq.com</span><br></pre></td></tr></table></div></figure>
<ol start="2">
<li><p>登录GitHub账户，点击头像，Settings–SSH and GPG kets–New SSH key。</p>
</li>
<li><p>把命令行查看的密钥复制粘贴进去，记得要把前面的<code>ssh-rsa</code>一块复制进去，title随便填，最后点击Add key。</p>
</li>
</ol>
<p>  <img src="/2020/01/21/Git%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0v2/QQ%E6%88%AA%E5%9B%BE20200121233114.png" alt="pic"></p>
<ol start="4">
<li>验证key是否正常工作</li>
</ol>
  <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ ssh -T git@github.com</span><br><span class="line"></span><br><span class="line">Attempts to ssh to github</span><br></pre></td></tr></table></div></figure>
<p>  这里可能会让你输入密码。</p>
<p>  最后，如果看到<code>Hi xxx! You&#39;ve successfully authenticated, but GitHub does not # provide shell access.</code>则代表已经设置成功！</p>
</li>
<li><p>把git的remote url修改为git协议</p>
<ol>
<li>使用命令git remote -v查看当前remote url</li>
</ol>
  <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git remote -v</span><br><span class="line">origin https://github.com/someaccount/someproject.git (fetch)</span><br><span class="line">origin https://github.com/someaccount/someproject.git (push)</span><br></pre></td></tr></table></div></figure>

<p>  若是以上结果说明此项目是使用https协议进行访问的.(如果地址是git开头则表示是git协议).且只有是SSH URL的链接我们才能推送数据上去。</p>
<ol start="2">
<li>使用命令<code>git remote set-url</code>来调整url</li>
</ol>
<p>  <code>git remote set-url origin git@github.com:planeswalker1205/newRepository.git</code></p>
<p>  最后再使用<code>git remote -v查看</code></p>
<p>  <img src="/2020/01/21/Git%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0v2/QQ%E6%88%AA%E5%9B%BE20200121233712.png" alt="ssh地址"></p>
</li>
</ul>

        <h2 id="远程仓库">
          <a href="#远程仓库" class="heading-link"><i class="fas fa-link"></i></a><a href="#远程仓库" class="headerlink" title="远程仓库"></a>远程仓库</h2>
      <p><strong>添加远程仓库</strong></p>
<ol>
<li><p>登录GitHub，创建一个新的仓库，仓库名称叫newRepository。</p>
</li>
<li><p>本地仓库运行如下命令:</p>
</li>
</ol>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote add origin git@git.com:planewalker1205/newRepository.git</span><br></pre></td></tr></table></div></figure>

<blockquote>
<p>以上命令中:<strong>gitrep</strong>：远程仓库名称，默认可以叫origin，一看就可以知道是远程仓库，<strong>planewalker1205</strong>是你的GitHub用户名名称，<strong>newRepository.git</strong>是GitHub上创建的仓库的名称。再次强调只有SSH URL的链接(也就是git开头)我们才可以推送数据上去。</p>
</blockquote>
<ol start="3">
<li>将本地数据推送到远程仓库</li>
</ol>
<p><code>$ git push -u origin master</code></p>
<blockquote>
<p>由于远程库是空的，我们第一次推送<code>master</code>分支时，加上了-u参数。Git不但会把本地的<code>master</code>分支内容推送到远程新的<code>master</code>分支，还会把本地的<code>master</code>分支和远程的<code>master</code>分支关联起来，在以后的推送或者拉取时就可以简化命令。<code>$ git push origin master</code></p>
</blockquote>
<p><strong>删除指定的远程仓库</strong></p>
<p><code>git remote rm origin</code></p>

        <h2 id="分支的创建与合并">
          <a href="#分支的创建与合并" class="heading-link"><i class="fas fa-link"></i></a><a href="#分支的创建与合并" class="headerlink" title="分支的创建与合并"></a>分支的创建与合并</h2>
      <p>注意:</p>
<blockquote>
<p>在使用分支时要注意，各分支之间工作区与暂存区是公共的，所以在一个分支的工作区修改的内容如果未add或commit就切换到另一个分支那么这些修改的内容也会被带到另一个分支。只有在一个分支中把内容提交另一个分支的工作区的内容才会更改回原来的状态。如果一个分支的内容已经作出修改并提交，而在另一个分支的工作区修改内容，再从另一个分支切换到已经修改并提交的分支时是不允许的。可以使用git stash命令处理相关问题。</p>
</blockquote>
<p>即:</p>
<blockquote>
<p>当前创建了a分支，a分支有文件a.txt，然后创建并切换到b分支，同样的b分支会自动生成a.txt，那么此时如果在b分支修改a.txt的内容，然后切换到a分支，b分支修改后的内容会带到a分区，在然后无论是提交修改后的a分支的内容还是提交修改后的b分支的内容，最终没被提交的哪一个分支的内容会自动回退到被修改之前的状态。</p>
</blockquote>
<blockquote>
<p>接上。如果a分支或者b分支的对应文件内容作出了修改并且提交，那么无论是在a分支还是在b分支修改工作区的对应文件的内容并且不commit，那么切换到另一个分支（a或者b）都是Git不允许的。反之，如果没有修改分支的对应文件的内容而只是新建了其他的文件，那么切换分支参考上一个tips。</p>
</blockquote>
<p><strong>对于刚创建的新分支，只有两个分支都有修改才提交后才判断同一个文件作出不同的修改操作的冲突。而对于新创建一个分支b只修改其中一个分支a&#x2F;b并且提交，那么在另一个分支a合并(修改并提交的分支)b，另一个分支a会被(修改并提交的分支)b覆盖。</strong></p>
<ul>
<li>创建分支</li>
</ul>
<p><code>$ git checkout -b dev</code></p>
<blockquote>
<p>上述命令表示创建并切换到分支dev，等同下列命令:</p>
</blockquote>
<p><code>$ git branch dev</code></p>
<p><code>$ git checkout dev</code></p>
<p>使用<code>$ git branch</code>查看当前分支</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git branch</span><br><span class="line">* dev</span><br><span class="line">  master</span><br></pre></td></tr></table></div></figure>

<blockquote>
<p>*号表示当前在哪个分支。</p>
</blockquote>
<ul>
<li>合并分支</li>
</ul>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git branch</span><br><span class="line">* master</span><br><span class="line">  dev</span><br></pre></td></tr></table></div></figure>

<p><code>$ git merge dev</code></p>
<blockquote>
<p>表示把dev分支合并到master分支上</p>
</blockquote>
<p>合并完成后，就可以删除dev分支:</p>
<p><code>$ git branch -d dev</code></p>
<p>如果报错的话可能是因为当前的分支还没有合并提示你并不能删除。此时，如果想要强制删除的话可以使用大写的D</p>
<p><code>$ git branch -D dev</code></p>
<p>再次查看分支，可以看到只剩下<code>master</code>分支了。</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git branch</span><br><span class="line">* master</span><br></pre></td></tr></table></div></figure>

<ul>
<li>switch切换分支</li>
</ul>
<p><code>$ git switch -c dev</code>等同于<code>$ git checkout -b dev</code></p>
<p><code>$ git switch master</code>等同于<code>$ git checkout master</code></p>
<p><strong>解决冲突</strong></p>
<ol>
<li>创建dev分支</li>
</ol>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git switch -c dev</span><br></pre></td></tr></table></div></figure>

<ol start="2">
<li>修改test.txt内容并提交</li>
</ol>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ cat test.txt</span><br><span class="line"></span><br><span class="line">dev test.txt</span><br><span class="line"></span><br><span class="line">$ git add test.txt</span><br><span class="line"></span><br><span class="line">$ git commit -m &quot;dev commit&quot;</span><br></pre></td></tr></table></div></figure>

<ol start="3">
<li>切换到master分支，修改test.txt内容并提交</li>
</ol>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ cat test.txt</span><br><span class="line"></span><br><span class="line">master test.txt</span><br><span class="line"></span><br><span class="line">$ git add test.txt</span><br><span class="line"></span><br><span class="line">$ git commit -m &quot;master commit&quot;</span><br></pre></td></tr></table></div></figure>

<ol start="4">
<li>合并dev分支</li>
</ol>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ git merge dev</span><br><span class="line"></span><br><span class="line">Auto-merging readme.txt</span><br><span class="line">CONFLICT (content): Merge conflict in readme.txt</span><br><span class="line">Automatic merge failed; fix conflicts and then commit the result.</span><br></pre></td></tr></table></div></figure>

<blockquote>
<p>可以看到如果两个分支的同一个文件的不同位置都有修改且提交的话，再次合并就会发生冲突。必须手动解决冲突后才能提交。</p>
</blockquote>
<hr>
<p>合并分支默认会使用<code>Fast forward</code>模式，该模式下如果删除分支会丢失分支信息。如果要禁用<code>Fast forward</code>模式，Git就会在merge时生成一个新的commit。</p>
<p><code>git merge --no-ff -m &quot;merge with no-ff&quot; dev</code></p>
<p>使用<code>git log</code>查看分支历史</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ git log --graph --pretty=oneline --abbrev-commit</span><br><span class="line">*   e1e9c68 (HEAD -&gt; master) merge with no-ff</span><br><span class="line">|\  </span><br><span class="line">| * f52c633 (dev) add merge</span><br><span class="line">|/  </span><br><span class="line">*   cf810e4 conflict fixed</span><br></pre></td></tr></table></div></figure>

<p>在不使用<code>Fast forward</code>模式，merge后就会像这样。</p>
<p><img src="/2020/01/21/Git%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0v2/0.png" alt="0"></p>
<p>如果你在一个分支dev上工作许久，此时需要紧急切换到另一个分支，但你还并不想提交当前工作的分支的内容，那么你就可以使用<code>stash</code>命令，把当前工作现场”储藏”起来，等以后恢复现场后继续工作。</p>
<p><code>$ git stash</code></p>
<p>现在，用<code>git status</code>查看工作区，就是干净的。可以放心创建或者切换到别的分支而不受本分支的影响。</p>
<p>当你处理完别的分支上的事情，切换到了之前工作并使用<code>stash</code>命令储藏工作内容的dev分支上。使用<code>git stash list</code>命令查看储藏起来的工作现场。</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git stash list</span><br><span class="line">stash@&#123;0&#125;: WIP on dev: f52c633 add merge</span><br></pre></td></tr></table></div></figure>

<p>想要恢复工作现场。有两种办法。</p>
<ol>
<li><p>使用<code>git stash apply</code>命令。使用此命令在恢复后stash内容并不会删除。需要使用<code>git stash drop</code>命令来删除。</p>
</li>
<li><p>使用<code>git stash pop</code>，使用此命令在恢复的同时也会把stash的内容删除。</p>
</li>
</ol>
<p>再使用<code>git stash list</code>命令就看不到任何stash内容了。</p>
<blockquote>
<p>当你在master分支上修复了bug后，由于dev分支时早期从master分支分出来的，所以，此bug也存在于dev分支。如果想在dev分支上修复同样的bug，除了可以重复操作一次再提交外。还有一种方法，只需要把在master上<code>4c805e2 fix bug 101</code>这个提交所做的修改“复制”到dev分支上。注意，此处是复制，而不是merge合并。</p>
</blockquote>
<p><code>$ git cheery-pick 4c805e2</code> </p>
<p>此时，Git自动给dev分支做了一次提交。而这次提交的commitID是<code>1d4b803</code>，虽然它们的改动相同，但提交的commitID不同。</p>
<p><strong>多人协作</strong></p>
<p>当你从远程仓库克隆时，实际上Git自动把本地的master分支和远程的master分支对应起来了，并且，远程仓库的默认名称是origin。</p>
<p>要查看远程库的信息，用git remote：.</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git remote</span><br><span class="line">origin</span><br></pre></td></tr></table></div></figure>

<p>或者，使用<code>git remote -v</code>查看更详细的信息。</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git remote -v</span><br><span class="line">origin  git@github.com:planewalker1205/newRepository.git (fetch)</span><br><span class="line">origin  git@github.com:planewalker1205/newRepository.git (push)</span><br></pre></td></tr></table></div></figure>

<p>上面显示的是可以抓取的<code>origin</code>的地址，如果没有推送权限的话，是看不到push的地址的。</p>
<ul>
<li>推送分支</li>
</ul>
<p><code>$ git push origin master</code></p>
<ul>
<li>推送其他分支</li>
</ul>
<p><code>$ git push origin dev</code></p>
<p>但是，并不是一定要把本地分支往远程推送，那么，哪些分支需要推送，哪些不需要呢？</p>
<ol>
<li><p><code>master</code>分支是主分支，因此要时刻与远程同步；</p>
</li>
<li><p><code>dev</code>分支是开发分支，团队所有成员都需要在上面工作，所以也需要与远程同步；</p>
</li>
<li><p><code>bug</code>分支只用于在本地修复bug，就没必要推到远程了，除非老板要看看你每周到底修复了几个bug；</p>
</li>
<li><p><code>feature</code>分支是否推到远程，取决于你是否和你的小伙伴合作在上面开发。</p>
</li>
</ol>
<p>总之，就是在Git中，分支完全可以在本地自己藏着玩，是否推送，视你的心情而定！</p>
<ul>
<li>抓取分支</li>
</ul>
<ol>
<li>先向远程仓库的目录克隆</li>
</ol>
<p><code>$ git clone git@github.com:planewalker1205/newRepository.git</code></p>
<p>默认情况是只能看到本地的<code>master</code>分支。</p>
<ol start="2">
<li>若想要在<code>dev</code>分支上开发，那么就必须创建远程<code>origin</code>的<code>dev</code>分支到本地:</li>
</ol>
<p><code>$ git checkout -b dev origin/dev</code></p>
<blockquote>
<p>在此之前，如果远程仓库没有dev分支，可以使用<code>$ git push origin dev:dev</code>创建远程分支.也就相当于把本地分支push到远程服务器.可以同名也可以随意取名.</p>
</blockquote>
<p>这样,就可以在<code>dev</code>上修改并且<code>push</code>到远程.</p>
<ol start="3">
<li><p>此时,又有其他人clone了远程仓库,并作出了修改且试图推送,推送失败,原因是其他人的推送提交与你之前的推送提交有冲突,解决办法是<code>git pull</code>把最新的提交从<code>origin/dev</code>抓下来，与本地合并，解决冲突，重新推送。</p>
</li>
<li><p>此时，<code>git pull</code>也失败了，原因是他没有指定本地的<code>dev</code>分支与远程<code>origin/dev</code>分支链接</p>
</li>
</ol>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git branch --set-upstream-to=origin/dev dev</span><br><span class="line">Branch &#x27;dev&#x27; set up to track remote branch &#x27;dev&#x27; from &#x27;origin&#x27;.</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


<p>再重新<code>pull</code></p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ git pull</span><br><span class="line">Auto-merging env.txt</span><br><span class="line">CONFLICT (add/add): Merge conflict in env.txt</span><br><span class="line">Automatic merge failed; fix conflicts and then commit the result.</span><br></pre></td></tr></table></div></figure>

<p>此时，会提示与本地合并有冲突，手动解决后，提交，<code>push</code></p>
<p><strong>跟踪分支</strong></p>
<blockquote>
<p>如果从一个远程跟踪分支检出一个本地分支会自动创建所谓的“跟踪分支”，它跟踪的分支叫做“上游分支”，跟踪分支是与远程分支有直接关系的本地分支。如果在一个分支上输入<code>pull</code>，Git能自动识别去哪个服务器上抓取，合并到哪个分支。</p>
</blockquote>
<p>比如:</p>
<p><code>$ git checkout -b [branch] [remotename]/[branch]</code></p>
<p><code>$ git branch -u origin/serverfix</code></p>
<p><code>$ git branch --set-upstream-to=origin/dev dev</code></p>
<p>如果想要查看设置的所有跟踪分支，可以使用 <code>git branch</code> 的 <code>-vv</code> 选项。 这会将所有的本地分支列出来并且包含更多的信息，如每一个分支正在跟踪哪个远程分支与本地分支是否是领先、落后或是都有。</p>
<p>相关学习地址:</p>
<p><span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://blog.csdn.net/u012701023/article/details/79222731" title="创建远程分支">https://blog.csdn.net/u012701023/article/details/79222731</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p><span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://git-scm.com/book/zh/v2/Git-%E5%88%86%E6%94%AF-%E8%BF%9C%E7%A8%8B%E5%88%86%E6%94%AF" title="远程分支">https://git-scm.com/book/zh/v2/Git-%E5%88%86%E6%94%AF-%E8%BF%9C%E7%A8%8B%E5%88%86%E6%94%AF</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>

        <h2 id="本章命令总结">
          <a href="#本章命令总结" class="heading-link"><i class="fas fa-link"></i></a><a href="#本章命令总结" class="headerlink" title="本章命令总结"></a>本章命令总结</h2>
      <ul>
<li>创建并切换分支</li>
</ul>
<p><code>$ git checkout -b dev</code></p>
<p><code>$ git switch -c dev</code></p>
<ul>
<li>创建分支</li>
</ul>
<p><code>$ git branch dev</code></p>
<ul>
<li>切换分支</li>
</ul>
<p><code>$ git checkout dev</code></p>
<p><code>$ git switch dev</code></p>
<ul>
<li>查看分支</li>
</ul>
<p><code>$ git branch</code></p>
<ul>
<li>合并分支</li>
</ul>
<p><code>$ git merge dev</code></p>
<ul>
<li>删除分支</li>
</ul>
<p><code>$ git branch -d dev</code></p>
<ul>
<li>强制删除分支</li>
</ul>
<p><code>$ git branch -D dev</code></p>
<ul>
<li>合并分支时禁用Fast forward模式</li>
</ul>
<p><code>git merge --no-ff -m &quot;merge with no-ff&quot; dev</code></p>
<ul>
<li>查看分支历史</li>
</ul>
<p><code>$ git log --graph --pretty=oneline --abbrev-commit</code></p>
<ul>
<li>“储藏”当前分支</li>
</ul>
<p><code>$ git stash</code></p>
<ul>
<li>查看“储藏起来的分支”</li>
</ul>
<p><code>$ git stash list</code></p>
<ul>
<li>恢复“储藏”起来的工作分支</li>
</ul>
<p><code>$ git stash apply</code></p>
<ul>
<li>删除stash的内容</li>
</ul>
<p><code>$ git stash drop</code></p>
<ul>
<li>恢复并删除“储藏”起来的工作分支</li>
</ul>
<p><code>$ git stash pop</code></p>
<ul>
<li>复制另一条分支提交的内容到本分支</li>
</ul>
<p><code>$ git cheery-pick 4c805e2</code></p>
<ul>
<li>添加远程仓库</li>
</ul>
<p><code>$ git remote add origin git@git.com:planewalker1205/newRepository.git</code></p>
<ul>
<li>查看远程仓库</li>
</ul>
<p><code>$ git remote</code></p>
<p><code>$ git remote -v</code></p>
<ul>
<li><strong>将本地数据推送到远程仓库（-u表示联系到远程仓库的master分支）</strong></li>
</ul>
<p><code>$ git push -u origin master</code></p>
<ul>
<li>删除指定的远程仓库</li>
</ul>
<p><code>$ git remote rm origin</code></p>
<ul>
<li>推送master分支</li>
</ul>
<p><code>$ git push origin master</code></p>
<ul>
<li>推送dev分支</li>
</ul>
<p><code>$ git push origin dev</code></p>
<ul>
<li>强制推送到远程仓库，且覆盖远程代码库</li>
</ul>
<p><code>$ git push -f --set-upstream origin master:master</code></p>
<ul>
<li>远程仓库克隆</li>
</ul>
<p><code>$ git clone git@github.com:planewalker1205/newRepository.git</code></p>
<ul>
<li>远程仓库创建分支(前提是本地有此分支)</li>
</ul>
<p><code>$ git push origin dev:dev</code></p>
<ul>
<li><strong>本地创建dev分支并联系到远程仓库的dev分支</strong></li>
</ul>
<p><code>$ git checkout -b dev origin/dev</code></p>
<ul>
<li>从远程仓库拉去最新提交（前提是指定本地分支与远程仓库分支的链接）</li>
</ul>
<p><code>$ git pull</code></p>
<ul>
<li>抓取远程仓库有而本地没有的数据</li>
</ul>
<p><code>$ git fetch origin</code></p>
<ul>
<li>将刚刚抓取到的内容合并到当前分支(注意，下列dev表示远程仓库的分支)</li>
</ul>
<p><code>$ git merge origin/dev</code></p>
<ul>
<li><strong>指定本地的dev分支与远程origin&#x2F;dev分支链接</strong></li>
</ul>
<p><code>$ git branch --set-upstream-to=origin/dev dev</code></p>
<ul>
<li>查看设置的所有的跟踪分支</li>
</ul>
<p><code>$ git branch -vv</code></p>
<ul>
<li>删除远程分支</li>
</ul>
<p><code>$ git push origin --delete dev</code></p>
<ul>
<li>删除远程分支(推送一个空分支到远程分支)</li>
</ul>
<p><code>$ git push origin:dev</code></p>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2020/01/15/Git%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">Git学习笔记1</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2020-01-15</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">2022-05-21</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h2 id="Git安装">
          <a href="#Git安装" class="heading-link"><i class="fas fa-link"></i></a><a href="#Git安装" class="headerlink" title="Git安装"></a>Git安装</h2>
      
        <h3 id="在Linux上安装Git">
          <a href="#在Linux上安装Git" class="heading-link"><i class="fas fa-link"></i></a><a href="#在Linux上安装Git" class="headerlink" title="在Linux上安装Git"></a>在Linux上安装Git</h3>
      <p>首先，您可以试着输入<code>git</code>，看看系统有没有安装Git:</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git</span><br><span class="line">The program <span class="string">&#x27;git&#x27;</span> is currently not installed. You can install it by typing:</span><br><span class="line">sudo apt-get install git</span><br></pre></td></tr></table></div></figure>

<p>如果您碰巧用Debian或Ubuntu Linux，通过一条<code>sudo apt-get install git</code>就可以直接完成</p>
<p>Git的安装。老一点的eDebian或者Ubuntu Linux，要把命令改为<code>sudo apt-get install git-core</code></p>

        <h3 id="在Mac-OS-X上安装Git">
          <a href="#在Mac-OS-X上安装Git" class="heading-link"><i class="fas fa-link"></i></a><a href="#在Mac-OS-X上安装Git" class="headerlink" title="在Mac OS X上安装Git"></a>在Mac OS X上安装Git</h3>
      <ol>
<li>安装homebrew，然后通过homebrew安装Git，具体方法参考homebrew的文档:http:&#x2F;&#x2F;<br>brew.sh&#x2F;</li>
<li>直接从AppStore安装Xcode，Xcode集成了Git，不过默认没有安装，你需要运行Xcode，选择菜<br>单”Xcode”-&gt;”Preferences”,在弹出窗口找到”Downloads”，选择”Command Line Tools”,<br>点”Install”就可以完成安装。</li>
</ol>

        <h3 id="在Windows上安装Git">
          <a href="#在Windows上安装Git" class="heading-link"><i class="fas fa-link"></i></a><a href="#在Windows上安装Git" class="headerlink" title="在Windows上安装Git"></a>在Windows上安装Git</h3>
      <p>可以直接从Git官网直接下载安装程序。默认下一步即可。</p>
<p>在开始菜单里找到”Git”-&gt;”Git Bash”，蹦出一个类似命令行的窗口。就说明Git安装成功！</p>
<p><strong>安装成功后，还需要最后一步设置:</strong></p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git config --global user.name &quot;Your Name&quot;</span><br><span class="line">$ git config --global user.email &quot;email@example.com&quot;</span><br></pre></td></tr></table></div></figure>
<p>由于Git是分布式版本控制系统，所以，每个机器都必须自报家门:你的名字和email地址。</p>
<blockquote>
<p><code>--global</code>参数，表示你这台机器上所有的Git仓库都会使用这个配置，当然也可以对某个仓库指定不同的用户名和Email地址.</p>
</blockquote>

        <h2 id="创建版本库">
          <a href="#创建版本库" class="heading-link"><i class="fas fa-link"></i></a><a href="#创建版本库" class="headerlink" title="创建版本库"></a>创建版本库</h2>
      <blockquote>
<p>什么是版本库呢？版本库又名仓库，英文名<strong>repository</strong>，你可以简单的理解成一个目录，这个目录里面的所有文件都可以被Git管理起来，每个文件的修改，删除，Git都可以跟踪，以便任何时刻都可以追踪历史，或者在将来某个时刻可以”还原”.</p>
</blockquote>
<ol>
<li>首先，选择一个合适的地方，创建一个空目录:<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ mkdir learngit</span><br><span class="line">$ cd learngit</span><br><span class="line">$ pwd</span><br><span class="line">/Users/michael/learngit</span><br></pre></td></tr></table></div></figure>
<code>pwd</code>命令用于显示当前目录，从上可以看出，这个仓库位于<code>/Users/michael/learngit</code></li>
</ol>
<blockquote>
<p>如果您使用的是Windows系统，为了避免遇到各种各样莫名其妙的问题，请确保目录名(包括父目录)不包含中文。</p>
</blockquote>
<ol start="2">
<li>通过<code>git init</code>命令把这个目录变成Git可以管理的仓库。</li>
</ol>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git init</span><br><span class="line">Initialized empty Git repository in /Users/michael/learngit/. git/</span><br></pre></td></tr></table></div></figure>

<p>瞬间Git就把仓库创建好了，而且告诉你是一个空的仓库(empty Git repository),自动生成的一个.git目录千万不要乱动！.git目录默认是隐藏的，使用’ls -ah’命令就可以看到.</p>

        <h2 id="提交">
          <a href="#提交" class="heading-link"><i class="fas fa-link"></i></a><a href="#提交" class="headerlink" title="提交"></a>提交</h2>
      <ol>
<li>编写一个<code>readme.txt</code>文件:<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Git is a version control system</span><br><span class="line">Git is free softwware</span><br></pre></td></tr></table></div></figure>
<blockquote>
<p>注:一定要放到创建的<code>learngit</code>目录下(子目录也可以)，因为这是一个Git仓库，放到其他地方Git是不会找到这个恩建的。而把一个文件放到Git仓库只需要两步。</p>
</blockquote>
</li>
</ol>
<ul>
<li>使用命令<code>git add</code>告诉Git，要把文件添加到仓库:</li>
</ul>
<p><code>git add readme.txt</code></p>
<p>执行上面的命令，不会有任何显示。这就对了，Unix的哲学:“没有消息就是好消息”，这说明添加成功。</p>
<ul>
<li>使用命令<code>git commit</code>告诉Git，把文件提交到仓库:</li>
</ul>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ git commit -m &quot;wrote a readme file&quot;</span><br><span class="line">[master (root-commit) eaadf4e] wrote a readme file</span><br><span class="line"> 1 file changed, 2 insertions(+)</span><br><span class="line"> create mode 100644 readme.txt</span><br></pre></td></tr></table></div></figure>

<p>简单解释一下<code>git commit</code>命令，<code>-m</code>后面输入的是本次提交的说明，可以输入任意内容，当然最好是有意义的，这样你就能从历史记录里方便地找到改动记录。</p>
<p>嫌麻烦不想输入<code>-m &quot;xxx&quot;</code>行不行？确实有办法可以这么干，但是强烈不建议你这么干，因为输入说明对自己对别人阅读都很重要。</p>
<p><code>git commit</code>命令执行成功后会告诉你，<code>1 file changed</code>：1个文件被改动（我们新添加的readme.txt文件）；<code>2 insertions</code>：插入了两行内容（readme.txt有两行内容）。</p>
<blockquote>
<p>为什么将文件提交到仓库需要两步呢，因为<code>git add &lt;file&gt;</code>的命令可以多次使用，最后再<code>git commit</code>一次性提交，非常方便。</p>
</blockquote>
<p><strong>当命令出现end结束后，无法退出时，可以直接按q结束</strong></p>

        <h2 id="版本回退">
          <a href="#版本回退" class="heading-link"><i class="fas fa-link"></i></a><a href="#版本回退" class="headerlink" title="版本回退"></a>版本回退</h2>
      <p>在Git中，我们可以使用<code>git log</code>命令来查看我们提交过的具体版本:</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">$ git log</span><br><span class="line">commit 1094adb7b9b3807259d8cb349e7df1d4d6477073 (HEAD -&gt; master)</span><br><span class="line">Author: Michael Liao &lt;askxuefeng@gmail.com&gt;</span><br><span class="line">Date:   Fri May 18 21:06:15 2018 +0800</span><br><span class="line"></span><br><span class="line">    append GPL</span><br><span class="line"></span><br><span class="line">commit e475afc93c209a690c39c13a46716e8fa000c366</span><br><span class="line">Author: Michael Liao &lt;askxuefeng@gmail.com&gt;</span><br><span class="line">Date:   Fri May 18 21:03:36 2018 +0800</span><br><span class="line"></span><br><span class="line">    add distributed</span><br><span class="line"></span><br><span class="line">commit eaadf4e385e865d25c48e7ca9c8395c3f7dfaef0</span><br><span class="line">Author: Michael Liao &lt;askxuefeng@gmail.com&gt;</span><br><span class="line">Date:   Fri May 18 20:59:18 2018 +0800</span><br><span class="line"></span><br><span class="line">    wrote a readme file</span><br></pre></td></tr></table></div></figure>
<p><code>git log</code>命令显示从最近到最远的提交日志。如果嫌输出信息听太多，可以加上<code>--pretty=oneline</code></p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ git log --pretty=oneline</span><br><span class="line">1094adb7b9b3807259d8cb349e7df1d4d6477073 (HEAD -&gt; master) append GPL</span><br><span class="line">e475afc93c209a690c39c13a46716e8fa000c366 add distributed</span><br><span class="line">eaadf4e385e865d25c48e7ca9c8395c3f7dfaef0 wrote a readme file</span><br></pre></td></tr></table></div></figure>

<blockquote>
<p>以上输出信息中<code>1094abd...</code>的东西是<code>commid id</code>（版本号）.在Git中，用’HEAD’表示当前版本，也就是最新的提交<code>1094adb...</code>，上一个版本就是<code>HEAD^</code>，上上一个版本就是<code>HEAD^^</code>,也可以写成<code>HEAD~100</code>，表示第100个版本。</p>
</blockquote>
<p>如果想要回退版本，那么可以使用<code>git reset --hard HEAD^</code></p>
<p>查看版本是否被还原 :</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ cat readme.txt</span><br><span class="line">aaaaaaaa</span><br><span class="line">bbbbbbbb</span><br></pre></td></tr></table></div></figure>

<p>再用<code>git log</code>命令查看版本库的状态，可以看到最新的版本已经看不到了。</p>
<p>如果你想回退的版本已经没有了，那么只要命令行中还存在<code>1094abd</code>之类的版本号，那么依旧可以回退。</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$git reset --hard 1094a</span><br></pre></td></tr></table></div></figure>
<p>如果你的命令行重新打开了，却还想要回退到之前的某个版本，那么使用命令<code>$ git reflog</code>用来记录你的每一次命令。</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ git reflog</span><br><span class="line">e475afc HEAD@&#123;1&#125;: reset: moving to HEAD^</span><br><span class="line">1094adb (HEAD -&gt; master) HEAD@&#123;2&#125;: commit: append GPL</span><br><span class="line">e475afc HEAD@&#123;3&#125;: commit: add distributed</span><br><span class="line">eaadf4e HEAD@&#123;4&#125;: commit (initial): wrote a readme file</span><br></pre></td></tr></table></div></figure>


        <h2 id="工作区和暂存区">
          <a href="#工作区和暂存区" class="heading-link"><i class="fas fa-link"></i></a><a href="#工作区和暂存区" class="headerlink" title="工作区和暂存区"></a>工作区和暂存区</h2>
      <p>Git中存在着暂存区的概念。</p>
<p><strong>工作区</strong>指的就是你在电脑里能看到的目录，比如创建的包含<code>.git</code>的文件夹就是一个工作区。</p>
<p><strong>版本库</strong>工作区中有一个隐藏的目录<code>.git</code>，他不算是工作区，而是Git的版本库。Git的版本库中存放了很多东西，其中，最重要的就是称为stage（或者叫index）的暂存区，还有Git为我们自动创建的 第一个分支<code>master</code>，以及指向<code>master</code>的一个指针<code>HEAD</code><br><img src="/2020/01/15/Git%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%B7%A5%E4%BD%9C%E5%8C%BA%E6%9A%82%E7%BC%93%E5%8C%BA.jpg" alt="示意图"></p>
<p>可以用命令试着去比较一下工作区，暂缓区和版本库之间的区别。</p>
<p><strong>git diff的命令只会比较两区域都存在的文件,如果工作区存在a文件,暂存区不存在a文件,其他都相同,那么git diff也不会打印出任何东西.这是可以使用git status命令比较查看.</strong></p>
<p><code>git status</code> —查看状态。</p>
<p><code>git diff</code> —-查看工作区和暂存区差异</p>
<p><code>git diff --cached</code> —-查看暂存区和仓库的差异</p>
<p><code>git diff HEAD</code> —-查看工作区和仓库的差异</p>
<p><code>git add</code>的反向命令<code>git checkout --file</code>，撤销工作区修改，如果修改后还没有放到暂存区，那么就是仓库的最新版本转至工作区。如果已经添加到暂存区，又做了修改，那么撤销修改就是回到添加到暂存区后的状态。</p>
<p><code>git commit</code>的反向命令<code>git reset HEAD</code>,就是把仓库最新版本转移至暂存区。    </p>
<blockquote>
<p><code>git checkout --file</code>命令中的<code>--</code>很重要，没有<code>--</code>，就变成了’切换到另一分支’的命令。</p>
</blockquote>
<p>当你不小心把工作区的内容添加到了暂缓区，那么就可以使用<code>git reset HEAD&lt;file&gt;</code>命令把暂存区的修改回退到工作区。当我们使用<code>HEAD</code>时，表示最新的版本。</p>
<p><code>git reset</code>命令个既可以回退版本。也可以把暂存区的修改回退到工作区。</p>

        <h2 id="删除文件">
          <a href="#删除文件" class="heading-link"><i class="fas fa-link"></i></a><a href="#删除文件" class="headerlink" title="删除文件"></a>删除文件</h2>
      <p>一般情况下，通常直接删除没用的文件，或者使用<code>rm</code>命令删了:</p>
<p><code>$ rm test.txt</code></p>
<p>这种时候，工作区和版本库就不一致了。可以<code>git status</code>命令 查看状态。</p>
<p>现在，如果你想要从版本库中删除该文件，那么就是用命令<code>git rm</code>删掉，然后<code>git commit</code></p>
<p>还有一种情况是删错了，那么直接<code>$ git checkout --test.txt</code></p>

        <h2 id="总结">
          <a href="#总结" class="heading-link"><i class="fas fa-link"></i></a><a href="#总结" class="headerlink" title="总结"></a>总结</h2>
      <p><code>git checkout file</code>和<code>git reset HEAD file</code></p>
<ol>
<li>当你只是单纯的修改了工作区的内容，当发现修改的内容错误时，就可以使用<code>git checkout file</code>回退工作区的内容。</li>
</ol>
<blockquote>
<p>当你的暂存区有对应文件的话，那么回退得版本是暂存区的版本，当暂存区已经提交或没有存在的话，那么回退的版本就是版本库最近一次的版本。(据我自己试验可得，此命令就是把暂存区的内容回退到工作区.)</p>
</blockquote>
<ol start="2">
<li>当你已经把工作区的内容添加到了暂存区，那么你想撤销掉暂存区的内容，就可以使用<code>git reset HEAD file</code>命令，把暂存区的内容撤回到版本库最近一次的版本，然后再使用<code>git checkout file</code>命令把工作区的版本回退到暂存区的最近一次版本。</li>
</ol>
<blockquote>
<p><code>git reset</code>命令既可以回退版本，也可以把暂存区的修改回退到工作区。当我们用HEAD时，表示最新的版本。</p>
</blockquote>
<ol start="3">
<li>当你把错误的文件提交到版本库时，参考上面的回退版本。</li>
</ol>
<p><strong>本节命令</strong></p>
<ul>
<li><p>git设置用户名邮箱:  </p>
<p>  <code>$ git config --flobal user.name &quot;Your Name&quot;</code></p>
<p>  <code>$ git config --global user.email &quot;email@ex.com&quot;</code></p>
</li>
<li><p>本地创建空目录:</p>
<p>  <code>$ mkdir emptyPro</code></p>
</li>
<li><p>进入创建的目录</p>
<p>  <code>$ cd emptyPro</code></p>
</li>
<li><p>查看当前所在目录</p>
<p>  <code>$ pwd</code></p>
</li>
<li><p>初始化空目录使之成为可以被Git管理的仓库（注意是要在这个目录下）</p>
<p>  <code>$ git init</code></p>
</li>
<li><p>把编写的文件添加到暂存区</p>
<p>  <code>$ git add one.txt</code></p>
<p>  <code>$ git add two.txt</code></p>
</li>
<li><p>把添加到暂存区的文件全部提交到仓库</p>
<p>  <code>$ git commit -m &quot;tips&quot;</code></p>
</li>
<li><p>查看提交过的版本</p>
<p>  <code>$ git log</code></p>
</li>
<li><p>查看格式化后的版本</p>
<p>  <code>$ git log --pretty=oneline</code></p>
</li>
<li><p>工作区的内容回退一个版本(hard表示HEAD指向目标版本，且工作区和暂存区的内容都要回退到目标版本。)</p>
<p>  <code>$ git reset --hard HEAD^</code></p>
</li>
<li><p>回退两个版本</p>
<p>  <code>$ git reset --hard HEAD^</code></p>
</li>
<li><p>回退到第n个版本</p>
<p>  <code>$ git reset --hard HEAD~n</code></p>
</li>
<li><p>查看文件内容</p>
<p>  <code>$ cat one.txt</code></p>
</li>
<li><p>查看所有变更记录的版本号</p>
<p>  <code>$ git reglog</code></p>
</li>
<li><p>查看状态</p>
<p>  <code>$ git status</code></p>
</li>
<li><p>查看工作区和暂存区差异</p>
<p>  <code>$ git diff</code></p>
</li>
<li><p>查看暂存区和仓库差异</p>
<p>  <code>$ git diff --cached</code></p>
</li>
<li><p>查看工作区和仓库差异</p>
<p>  <code>$ git diff HEAD</code></p>
</li>
<li><p>删除工作区文件</p>
<p>  <code>$ rm one.txt</code></p>
</li>
<li><p>删除暂存区文件夹</p>
<p>  <code>git rm -r testPro</code></p>
</li>
<li><p>删除暂存区文件</p>
<p>  <code>$ git rm one.txt</code></p>
</li>
<li><p>撤销工作区的修改</p>
<p>  <code>$ git checkout file</code></p>
</li>
<li><p>如果有多个分支的话撤销工作区的修改（表示撤销当前工作分支的工作区的修改）</p>
<p>  <code>$ git checkout HEAD file</code></p>
</li>
<li><p>撤销暂存区的修改</p>
<p>  <code>$ git reset HEAD file</code></p>
</li>
<li><p>查看暂存区内容</p>
<p>  <code>$ git ls-files --stage</code></p>
</li>
<li><p>清空(删除)暂存区</p>
<p>  <code>$ rm .git/index</code></p>
</li>
</ul>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2020/01/11/IDEA%E5%9F%BA%E7%A1%80%E8%AE%BE%E7%BD%AE%E5%8F%8A%E6%93%8D%E4%BD%9C/">IDEA基础设置及操作</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2020-01-11</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">2022-05-21</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h3 id="快捷键操作：">
          <a href="#快捷键操作：" class="heading-link"><i class="fas fa-link"></i></a><a href="#快捷键操作：" class="headerlink" title="快捷键操作："></a>快捷键操作：</h3>
      <p><span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="http://blog.zhaojishun.cn/articles/2020/01/27/1580092173752.html" title="IDEA高频快捷键">http://blog.zhaojishun.cn/articles/2020/01/27/1580092173752.html</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<ol>
<li><p>弹出代码修改提示:<code>alt+enter</code></p>
</li>
<li><p>代码补全:<code>ctrl+space</code>(如果没用可能是快捷键冲突)</p>
</li>
<li><p>输出快捷键:<code>sout</code></p>
</li>
<li><p>get&#x2F;set生成:<code>alt+insert</code></p>
</li>
<li><p>Alt+回车 导入包,自动修正</p>
</li>
<li><p>Ctrl+N  查找类</p>
</li>
<li><p>Ctrl+Shift+N 查找文件</p>
</li>
<li><p>Ctrl+Alt+L  格式化代码</p>
</li>
<li><p>Ctrl+Alt+O 优化导入的类和包</p>
</li>
<li><p>Alt+Insert 生成代码(如get,set方法,构造函数等)</p>
</li>
<li><p>Ctrl+E或者Alt+Shift+C  最近更改的代码</p>
</li>
<li><p>Ctrl+R 替换文本</p>
</li>
<li><p>Ctrl+F 查找文本</p>
</li>
<li><p>Ctrl+Shift+Space 自动补全代码</p>
</li>
<li><p>Ctrl+空格 代码提示</p>
</li>
<li><p>Ctrl+Alt+Space 类名或接口名提示</p>
</li>
<li><p>Ctrl+P 方法参数提示</p>
</li>
<li><p>Ctrl+Shift+Alt+N 查找类中的方法或变量</p>
</li>
<li><p>Alt+Shift+C 对比最近修改的代码</p>
</li>
<li><p>Shift+F6  重构-重命名</p>
</li>
<li><p>Ctrl+Shift+先上键</p>
</li>
<li><p>Ctrl+X 删除行</p>
</li>
<li><p>Ctrl+D 复制行</p>
</li>
<li><p>Ctrl+&#x2F; 或 Ctrl+Shift+&#x2F;  注释（&#x2F;&#x2F; 或者&#x2F;<em>…</em>&#x2F; ）</p>
</li>
<li><p>Ctrl+J  自动代码</p>
</li>
<li><p>Ctrl+E 最近打开的文件</p>
</li>
<li><p>Ctrl+H 显示类结构图</p>
</li>
<li><p>Ctrl+Q 显示注释文档</p>
</li>
<li><p>Alt+F1 查找代码所在位置</p>
</li>
<li><p>Alt+1 快速打开或隐藏工程面板</p>
</li>
<li><p>Ctrl+Alt+ left&#x2F;right 返回至上次浏览的位置</p>
</li>
<li><p>Alt+ left&#x2F;right 切换代码视图</p>
</li>
<li><p>Alt+ Up&#x2F;Down 在方法间快速移动定位</p>
</li>
<li><p>Ctrl+Shift+Up&#x2F;Down 代码向上&#x2F;下移动。</p>
</li>
<li><p>F2 或Shift+F2 高亮错误或警告快速定位</p>
</li>
<li><p>代码标签输入完成后，按Tab，生成代码。</p>
</li>
<li><p>选中文本，按Ctrl+Shift+F7 ，高亮显示所有该文本，按Esc高亮消失。</p>
</li>
<li><p>Ctrl+W 选中代码，连续按会有其他效果</p>
</li>
<li><p>选中文本，按Alt+F3 ，逐个往下查找相同文本，并高亮显示。</p>
</li>
<li><p>Ctrl+Up&#x2F;Down 光标跳转到第一行或最后一行下</p>
</li>
<li><p>Ctrl+B 快速打开光标处的类或方法</p>
</li>
<li><p>ctrl+z 撤销</p>
</li>
<li><p>ctrl+shift+z 反撤销</p>
</li>
</ol>
<p>最常用快捷键</p>
<ol>
<li><p>Ctrl＋E，可以显示最近编辑的文件列表</p>
</li>
<li><p>Shift＋Click可以关闭文件</p>
</li>
<li><p>Ctrl＋[或]可以跳到大括号的开头结尾</p>
</li>
<li><p>Ctrl＋Shift＋Backspace可以跳转到上次编辑的地方</p>
</li>
<li><p>Ctrl＋F12，可以显示当前文件的结构</p>
</li>
<li><p>Ctrl＋F7可以查询当前元素在当前文件中的引用，然后按F3可以选择</p>
</li>
<li><p>Ctrl＋N，可以快速打开类</p>
</li>
<li><p>Ctrl＋Shift＋N，可以快速打开文件</p>
</li>
<li><p>Alt＋Q可以看到当前方法的声明</p>
</li>
<li><p>Ctrl＋W可以选择单词继而语句继而行继而函数</p>
</li>
<li><p>Alt＋F1可以将正在编辑的元素在各个面板中定位</p>
</li>
<li><p>Ctrl＋P，可以显示参数信息</p>
</li>
<li><p>Ctrl＋Shift＋Insert可以选择剪贴板内容并插入</p>
</li>
<li><p>Alt＋Insert可以生成构造器&#x2F;Getter&#x2F;Setter等</p>
</li>
<li><p>Ctrl＋Alt＋V 可以引入变量。例如把括号内的SQL赋成一个变量</p>
</li>
<li><p>Ctrl＋Alt＋T可以把代码包在一块内，例如try&#x2F;catch</p>
</li>
<li><p>Alt＋Up and Alt＋Down可在方法间快速移动</p>
</li>
<li><p>在一些地方按Alt＋Enter可以得到一些Intention Action，例如将”&#x3D;&#x3D;”改为”equals()”</p>
</li>
<li><p>Ctrl＋Shift＋Alt＋N可以快速打开符号</p>
</li>
<li><p>Ctrl＋Shift＋Space在很多时候都能够给出Smart提示</p>
</li>
<li><p>Alt＋F3可以快速寻找</p>
</li>
<li><p>Ctrl＋&#x2F;和Ctrl＋Shift＋&#x2F;可以注释代码</p>
</li>
<li><p>Ctrl＋Alt＋B可以跳转到抽象方法的实现</p>
</li>
<li><p>Ctrl＋O可以选择父类的方法进行重写</p>
</li>
<li><p>Ctrl＋Q可以看JavaDoc</p>
</li>
<li><p>Ctrl＋Alt＋Space是类名自动完成</p>
</li>
<li><p>快速打开类&#x2F;文件&#x2F;符号时，可以使用通配符，也可以使用缩写</p>
</li>
<li><p>Live Templates! Ctrl＋J</p>
</li>
<li><p>Ctrl＋Shift＋F7可以高亮当前元素在当前文件中的使用</p>
</li>
<li><p>Ctrl＋Alt＋Up &#x2F;Ctrl＋Alt＋Down可以快速跳转搜索结果</p>
</li>
<li><p>Ctrl＋Shift＋J可以整合两行</p>
</li>
<li><p>Alt＋F8是计算变量值</p>
</li>
</ol>
<p><span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://www.cnblogs.com/jx17/p/6244491.html">https://www.cnblogs.com/jx17/p/6244491.html</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>

        <h3 id="基础设置">
          <a href="#基础设置" class="heading-link"><i class="fas fa-link"></i></a><a href="#基础设置" class="headerlink" title="基础设置"></a>基础设置</h3>
      <ol>
<li>代码提示不区分大小写:File-&gt;settings-&gt;Editor-&gt;General-&gt;Code Completion下:</li>
</ol>
<p><img src="/2020/01/11/IDEA%E5%9F%BA%E7%A1%80%E8%AE%BE%E7%BD%AE%E5%8F%8A%E6%93%8D%E4%BD%9C/code%E6%8F%90%E7%A4%BA.png" alt="codeCase"></p>
<ol start="2">
<li>清理缓存并重启IDEA:File–&gt;invalidate caches&#x2F;restart</li>
</ol>

        <h3 id="日常问题">
          <a href="#日常问题" class="heading-link"><i class="fas fa-link"></i></a><a href="#日常问题" class="headerlink" title="日常问题"></a>日常问题</h3>
      <ol>
<li>当代码没有自动补全可查看File-&gt;Power Save mode自动省电是否开启</li>
</ol>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2020/01/08/%E4%BD%BF%E7%94%A8hexo%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E7%BD%91%E7%AB%99/">使用hexo搭建个人博客网站</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2020-01-08</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">2022-05-21</span></span></div></header><div class="post-body"><div class="post-excerpt"><p>地址:<a href="https://planeswalker1205.github.io/">https://planeswalker1205.github.io/</a></p>

        <h4 id="环境-Windows-10-64bit">
          <a href="#环境-Windows-10-64bit" class="heading-link"><i class="fas fa-link"></i></a><a href="#环境-Windows-10-64bit" class="headerlink" title="环境:Windows 10 64bit"></a>环境:Windows 10 64bit</h4>
      
        <h4 id="工具-node-js-Git">
          <a href="#工具-node-js-Git" class="heading-link"><i class="fas fa-link"></i></a><a href="#工具-node-js-Git" class="headerlink" title="工具:node.js     Git"></a>工具:node.js     Git</h4>
      
        <h4 id="操作">
          <a href="#操作" class="heading-link"><i class="fas fa-link"></i></a><a href="#操作" class="headerlink" title="操作:"></a>操作:</h4>
      <p><strong>1.安装Node.js</strong></p>
<p>打开官网:<span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://nodejs.org/">https://nodejs.org</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p><strong>2.安装Git</strong></p>
<p>打开官网:<span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://git-scm.com/donloads">https://git-scm.com/donloads</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p><strong>3.管理员权限打开命令行</strong></p>
<p><strong>4.</strong><code>node -v</code><strong>查看node版本</strong></p>
<p><code>npm -v</code><strong>npm包管理器版本</strong></p>
<p><strong>5.利用npm安装cnpm:</strong></p>
<p><code>npm install -g cnpm --registry=https://registry.npm.taobao.org</code></p>
<p><strong>6.查看cnpm版本</strong><code>cnpm</code></p>
<p><strong>7.安装hexo:</strong><code>cnpm install -g hexo-cli</code></p>
<p>验证:<code>hexo -v</code></p>
<p><strong>8.创建一个文件夹</strong></p>
<p>创建blog文件夹，关于个人博客的操作都是在此文件夹中进行。</p>
<p>命令行到该文件夹下:<code>hexo init</code>，linux系统可使用命令<code>sudo hexo init</code></p>
<p><strong>9.完成</strong></p>
<p>可访问本地<code>localhost:4000</code>访问个人博客页面。如果要部署可使用GitHub，deploy到远程库中</p>
<ol>
<li><p>在GitHub上创建仓库，注意仓库名称是要<code>用户名.github.io</code></p>
</li>
<li><p>config.yml中添加相关属性。</p>
</li>
</ol>
<p>repo:创建的GitHub仓库地址。</p>
<ol start="3">
<li>命令:<code>hexo d(eploy)</code></li>
</ol>
<p>至于为什么仓库名称要是用户名:</p>
<p><img src="/2020/01/08/%E4%BD%BF%E7%94%A8hexo%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E7%BD%91%E7%AB%99/360%E6%88%AA%E5%9B%BE20200122230657234.jpg" alt="名称"></p>
<p><u>注:</u></p>
<p><u>在写博客文章的时候要记得在头部冒号后加上空格 ，再填写内容.</u></p>
<p><strong>遇到的问题及解决方案:</strong></p>
<p>1.引入图片:</p>
<ul>
<li><p>找到<code>Hexo</code>下的<code>_config.yml</code>文件里的post_asset_folder，修改诶<code>true</code></p>
</li>
<li><p>在博客目录下打开<code>Git Bash Here</code>，执行一个下载上传图片插件的命令:<code>npm install hexo-asset-image --save</code>,也可以<code>cnpm install hexo-asset-image --save</code></p>
</li>
<li><p>再次新建博客.md文件时，就会自动产生一个与博客同名的文件夹，这时候只需要把图片放入这个文件夹，在博客中引用图片的时候使用此文件夹的路径就可以了。</p>
</li>
<li><p>但有时候可能出现引用图片不成功的问题，那么这时候需要修改<code>/node_modules/hexo-asset-image/</code>下的indedx.js文件，打开并将其修改:</p>
</li>
</ul>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"><span class="keyword">var</span> cheerio = <span class="built_in">require</span>(<span class="string">&#x27;cheerio&#x27;</span>);</span><br><span class="line">   <span class="comment">// http://stackoverflow.com/questions/14480345/how-to-get-the-nth-occurrence-       in-a-string</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getPosition</span>(<span class="params">str, m, i</span>) &#123;</span><br><span class="line">   <span class="keyword">return</span> str.<span class="title function_">split</span>(m, i).<span class="title function_">join</span>(m).<span class="property">length</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> version = <span class="title class_">String</span>(hexo.<span class="property">version</span>).<span class="title function_">split</span>(<span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">hexo.<span class="property">extend</span>.<span class="property">filter</span>.<span class="title function_">register</span>(<span class="string">&#x27;after_post_render&#x27;</span>, <span class="keyword">function</span>(<span class="params">data</span>)&#123;</span><br><span class="line">   <span class="keyword">var</span> config = hexo.<span class="property">config</span>;</span><br><span class="line">   <span class="keyword">if</span>(config.<span class="property">post_asset_folder</span>)&#123;</span><br><span class="line">   	<span class="keyword">var</span> link = data.<span class="property">permalink</span>;</span><br><span class="line"><span class="keyword">if</span>(version.<span class="property">length</span> &gt; <span class="number">0</span> &amp;&amp; <span class="title class_">Number</span>(version[<span class="number">0</span>]) == <span class="number">3</span>)</span><br><span class="line">   <span class="keyword">var</span> beginPos = <span class="title function_">getPosition</span>(link, <span class="string">&#x27;/&#x27;</span>, <span class="number">1</span>) + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="keyword">var</span> beginPos = <span class="title function_">getPosition</span>(link, <span class="string">&#x27;/&#x27;</span>, <span class="number">3</span>) + <span class="number">1</span>;</span><br><span class="line"><span class="comment">// In hexo 3.1.1, the permalink of &quot;about&quot; page is like &quot;.../about/index.html&quot;.</span></span><br><span class="line"><span class="keyword">var</span> endPos = link.<span class="title function_">lastIndexOf</span>(<span class="string">&#x27;/&#x27;</span>) + <span class="number">1</span>;</span><br><span class="line">   link = link.<span class="title function_">substring</span>(beginPos, endPos);</span><br><span class="line"></span><br><span class="line">   <span class="keyword">var</span> toprocess = [<span class="string">&#x27;excerpt&#x27;</span>, <span class="string">&#x27;more&#x27;</span>, <span class="string">&#x27;content&#x27;</span>];</span><br><span class="line">   <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; toprocess.<span class="property">length</span>; i++)&#123;</span><br><span class="line">     <span class="keyword">var</span> key = toprocess[i];</span><br><span class="line">     <span class="keyword">var</span> $ = cheerio.<span class="title function_">load</span>(data[key], &#123;</span><br><span class="line">       <span class="attr">ignoreWhitespace</span>: <span class="literal">false</span>,</span><br><span class="line">       <span class="attr">xmlMode</span>: <span class="literal">false</span>,</span><br><span class="line">       <span class="attr">lowerCaseTags</span>: <span class="literal">false</span>,</span><br><span class="line">       <span class="attr">decodeEntities</span>: <span class="literal">false</span></span><br><span class="line">     &#125;);</span><br><span class="line">     $(<span class="string">&#x27;img&#x27;</span>).<span class="title function_">each</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="keyword">if</span> ($(<span class="variable language_">this</span>).<span class="title function_">attr</span>(<span class="string">&#x27;src&#x27;</span>))&#123;</span><br><span class="line">		<span class="comment">// For windows style path, we replace &#x27;\&#x27; to &#x27;/&#x27;.</span></span><br><span class="line">		<span class="keyword">var</span> src = $(<span class="variable language_">this</span>).<span class="title function_">attr</span>(<span class="string">&#x27;src&#x27;</span>).<span class="title function_">replace</span>(<span class="string">&#x27;\\&#x27;</span>, <span class="string">&#x27;/&#x27;</span>);</span><br><span class="line">		<span class="keyword">if</span>(!<span class="regexp">/http[s]*.*|\/\/.*/</span>.<span class="title function_">test</span>(src) &amp;&amp;</span><br><span class="line">		   !<span class="regexp">/^\s*\//</span>.<span class="title function_">test</span>(src)) &#123;</span><br><span class="line">		  <span class="comment">// For &quot;about&quot; page, the first part of &quot;src&quot; can&#x27;t be removed.</span></span><br><span class="line">		  <span class="comment">// In addition, to support multi-level local directory.</span></span><br><span class="line">		  <span class="keyword">var</span> linkArray = link.<span class="title function_">split</span>(<span class="string">&#x27;/&#x27;</span>).<span class="title function_">filter</span>(<span class="keyword">function</span>(<span class="params">elem</span>)&#123;</span><br><span class="line">			<span class="keyword">return</span> elem != <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">		  &#125;);</span><br><span class="line">		  <span class="keyword">var</span> srcArray = src.<span class="title function_">split</span>(<span class="string">&#x27;/&#x27;</span>).<span class="title function_">filter</span>(<span class="keyword">function</span>(<span class="params">elem</span>)&#123;</span><br><span class="line">			<span class="keyword">return</span> elem != <span class="string">&#x27;&#x27;</span> &amp;&amp; elem != <span class="string">&#x27;.&#x27;</span>;</span><br><span class="line">		  &#125;);</span><br><span class="line">		  <span class="keyword">if</span>(srcArray.<span class="property">length</span> &gt; <span class="number">1</span>)</span><br><span class="line">			srcArray.<span class="title function_">shift</span>();</span><br><span class="line">		  src = srcArray.<span class="title function_">join</span>(<span class="string">&#x27;/&#x27;</span>);</span><br><span class="line">		  $(<span class="variable language_">this</span>).<span class="title function_">attr</span>(<span class="string">&#x27;src&#x27;</span>, config.<span class="property">root</span> + link + src);</span><br><span class="line">		  <span class="variable language_">console</span>.<span class="property">info</span>&amp;&amp;<span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;update link as:--&gt;&quot;</span>+config.<span class="property">root</span> + link + src);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="variable language_">console</span>.<span class="property">info</span>&amp;&amp;<span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;no src attr, skipped...&quot;</span>);</span><br><span class="line">		<span class="variable language_">console</span>.<span class="property">info</span>&amp;&amp;<span class="variable language_">console</span>.<span class="title function_">info</span>($(<span class="variable language_">this</span>));</span><br><span class="line">	&#125;</span><br><span class="line">     &#125;);</span><br><span class="line">     data[key] = $.<span class="title function_">html</span>();</span><br><span class="line">   &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></div></figure>

<p>参考地址:<span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://blog.csdn.net/xjm850552586/article/details/84101345">https://blog.csdn.net/xjm850552586/article/details/84101345</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p><strong>hexo已更新，现在需要安装hexo-asset-image-for-hexo5生效</strong></p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-asset-image-<span class="keyword">for</span>-hexo5 --save</span><br></pre></td></tr></table></div></figure>


        <h3 id="MarkdownPad设置及操作">
          <a href="#MarkdownPad设置及操作" class="heading-link"><i class="fas fa-link"></i></a><a href="#MarkdownPad设置及操作" class="headerlink" title="#MarkdownPad设置及操作"></a>#MarkdownPad设置及操作</h3>
      <ol>
<li>代码块:</li>
</ol>
<ul>
<li><p>可使用 <code>&lt;pre\&gt; &lt;/pre\&gt;</code>标签实现代码块,不过这里要在Tools-&gt;options-&gt;Markdown-&gt;Markdown Processor–&gt;设置为Markdown</p>
</li>
<li><p>使用格式为`&#96;&#96; 内容  `&#96;&#96;，但如果想实现代码之间的换行同样要设置:Tools-&gt;options-&gt;Markdown-&gt;Markdown Processor–&gt;设置为CommonMark</p>
</li>
</ul>
</div></div></article></section><nav class="paginator"><div class="paginator-inner"><a class="extend prev" rel="prev" href="/page/4/"><i class="fas fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span></div></nav></div></div><div class="sidebar-wrap" id="sidebar-wrap"><aside class="sidebar" id="sidebar"><section class="sidebar-toc hide"></section><!-- ov = overview--><section class="sidebar-ov"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="/images/icons/stun-logo.svg" alt="avatar"></div><p class="sidebar-ov-author__text">hello world</p></div><div class="sidebar-ov-state"><a class="sidebar-ov-state-item sidebar-ov-state-item--posts" href="/archives/"><div class="sidebar-ov-state-item__count">46</div><div class="sidebar-ov-state-item__name">Archives</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--categories" href="/categories/"><div class="sidebar-ov-state-item__count">0</div><div class="sidebar-ov-state-item__name">Categories</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--tags" href="/tags/"><div class="sidebar-ov-state-item__count">68</div><div class="sidebar-ov-state-item__name">Tags</div></a></div><div class="sidebar-ov-cc"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" target="_blank" rel="noopener" data-popover="Creative Commons" data-popover-pos="up"><img src="/images/cc-by-nc-sa.svg"></a></div></section></aside></div><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>Copyright © 2022</span><span class="footer__icon"><i class="fas fa-heart"></i></span><span>ashen</span></div><div><span>Powered by <a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a></span><span> v6.1.0</span><span class="footer__devider">|</span><span>Theme - <a href="https://github.com/liuyib/hexo-theme-stun/" title="Stun" target="_blank" rel="noopener">Stun</a></span><span> v2.6.2</span></div></div></footer><div class="loading-bar" id="loading-bar"><div class="loading-bar__progress"></div></div><div class="back2top" id="back2top"><span class="back2top__icon"><i class="fas fa-rocket"></i></span></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><script src="/js/utils.js?v=2.6.2"></script><script src="/js/stun-boot.js?v=2.6.2"></script><script src="/js/scroll.js?v=2.6.2"></script><script src="/js/header.js?v=2.6.2"></script><script src="/js/sidebar.js?v=2.6.2"></script></body></html>